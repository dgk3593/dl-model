const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/f_Bh62PO_s-UnrealBloomPass.js","assets/f_BhnEo6Ds-three.js","assets/f_CAw9onpM-SMAAPass.js","assets/f_BL33EWRT-RenderPixelatedPass.js","assets/f_DBJBGmhg-SobelOperatorShader.js","assets/f_C-Zxy5V4-HalftonePass.js","assets/f_B4WrYfZz-DotScreenPass.js","assets/f_BG1EgyeC-BokehPass.js","assets/f_DLksWAt5-AfterimagePass.js","assets/f_B1vgPWtx-index.js","assets/f_C9zo2tqQ-TabBar.js","assets/f_B3t-b2E--Gallery.js","assets/f_khRS1k2X-createSimplePaletteValueFilter.js","assets/f_m-cDhqtM-Popover.js","assets/f_CNBHtBxO-createSvgIcon.js","assets/f_fqacmyzG-DialogTitle.js","assets/f_Rroxh4vs-Box.js","assets/f_BCSlbnRB-ColorPicker.js","assets/f_3Cn7aJSV-ColorButton.js","assets/f_B69Gtn_4-Button.js","assets/f_DOkd0J7a-ColorPicker.css","assets/f_DDaXPsBr-file2dataURL.js","assets/f_CC_FZrpF-index.css","assets/f_C9kc3U3P-index.js","assets/f_S6tLscU6-lists.js","assets/f_LSw5bq7b-Close.js","assets/f_BmgjgQkf-lists.css","assets/f_ovVP-_-b-filterConfig.js","assets/f_BZg-Nmsb-GlowToggle.js","assets/f_i_v629Ua-GlowToggle.css","assets/f_YUy5lOXF-filterConfig.css","assets/f_B1op8615-styles.js","assets/f_DcE1GK0K-styles.css","assets/f_DTlAd7Dn-styles.css","assets/f_DN4BzWPz-index.js","assets/f_CKgUgUAW-index.js","assets/f_1DIhSXa4-Stretcher.js","assets/f_CykHxqOs-Stretcher.css","assets/f_DvfMxS0Z-ModelIcon.js","assets/f_C-rz_-rA-aniFunction.js","assets/f_BE7_elCA-Selector.js","assets/f_tY7sRDVY-Selector.css","assets/f_Cqwv2mvw-useKey.js","assets/f_D62j_oXK-useToggleState.js","assets/f_BTm-RmFB-Check.js","assets/f_DzS1WTFL-index.css","assets/f_CWMqWcLh-index.js","assets/f_CM9Pt-QL-index.css","assets/f_BFqT42-W-ColorSelect.js","assets/f_3zBysd7_-index.js","assets/f_D0YLTvlW-FacePartSelector.js","assets/f_fbb1jLbg-MeshMouthSelect.js","assets/f_a3xgdy8u-MeshMouthSelect.css","assets/f_zXhT5QLt-index.css","assets/f_BvUYvCkf-index.js","assets/f_DAg0cFZL-index.js","assets/f_DoDkGLzk-BoneManager.js","assets/f_CkuIaZOU-Accordion.js","assets/f_vBdlptXV-Accordion.css","assets/f_DrwRAChL-SkipPrevious.js","assets/f_CIqfjCCo-BoneManager.css","assets/f_DN0w2pSx-index.css","assets/f_BbccsLxF-index.js","assets/f_B0XIIxkL-index.css","assets/f_BO_bSUkP-index.js","assets/f_owdQ4QxP-index.css","assets/f_BFeFBPCO-index.js","assets/f_NQTMArhG-index.css","assets/f_C6t83psC-index.js","assets/f_BuJwm3yO-index.css"])))=>i.map(i=>d[i]);
var fo=Object.defineProperty;var po=(t,e,n)=>e in t?fo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ee=(t,e,n)=>po(t,typeof e!="symbol"?e+"":e,n);import{J as mo,K as _o,q as U,b as L,O as go,X as Fe,Y as Oe,Q as ae,Z as as,V as j,a as Tt,_ as yo,$ as an,a0 as vo,a1 as wo,a2 as Ve,F as cs,E as ls,T as bo,a3 as Vt,a4 as Eo,C as $,g as J,a5 as So,u as O,a6 as us,a7 as hs,t as yt,a8 as Ht,a9 as mr,i as _r,aa as cn,ab as Po,ac as gr,ad as xo,h as yr,ae as To,af as Ao,ag as Mo,ah as vr,ai as dt,aj as ge,ak as Co,al as Do,am as Lo,an as wr,ao as ko,ap as ce,aq as fs,ar as Oo,as as Ro,k as Io,U as Mn,at as Ge,S as Ye,au as ps,av as Fo,aw as ds,ax as Bo,ay as jo,N as No,az as br,aA as $o,aB as Uo,aC as zo,aD as Vo,aE as Ho,aF as Wo,aG as Go,aH as Xo,aI as Ko,aJ as Yo,B as qo,aK as Zo,A as Qo,s as Jo,W as Er,H as ea,e as ta,aL as Sr,L as ms,r as na,aM as sa,aN as ra,j as ia}from"./f_BhnEo6Ds-three.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var et,E,Pr,we,_s,xr,ln,Cn,un,hn,Tr,qe={},Ar=[],oa=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,At=Array.isArray;function ue(t,e){for(var n in e)t[n]=e[n];return t}function Mr(t){var e=t.parentNode;e&&e.removeChild(t)}function le(t,e,n){var s,r,i,o={};for(i in e)i=="key"?s=e[i]:i=="ref"?r=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?et.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)o[i]===void 0&&(o[i]=t.defaultProps[i]);return Xe(t,o,s,r,null)}function Xe(t,e,n,s,r){var i={type:t,props:e,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++Pr,__i:-1,__u:0};return r==null&&E.vnode!=null&&E.vnode(i),i}function Cr(){return{current:null}}function oe(t){return t.children}function ie(t,e){this.props=t,this.context=e}function Ee(t,e){if(e==null)return t.__?Ee(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Ee(t):null}function Dr(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Dr(t)}}function fn(t){(!t.__d&&(t.__d=!0)&&we.push(t)&&!vt.__r++||_s!==E.debounceRendering)&&((_s=E.debounceRendering)||xr)(vt)}function vt(){var t,e,n,s,r,i,o,a;for(we.sort(ln);t=we.shift();)t.__d&&(e=we.length,s=void 0,i=(r=(n=t).__v).__e,o=[],a=[],n.__P&&((s=ue({},r)).__v=r.__v+1,E.vnode&&E.vnode(s),Dn(n.__P,s,r,n.__n,n.__P.namespaceURI,32&r.__u?[i]:null,o,i??Ee(r),!!(32&r.__u),a),s.__v=r.__v,s.__.__k[s.__i]=s,Or(o,s,a),s.__e!=i&&Dr(s)),we.length>e&&we.sort(ln));vt.__r=0}function Lr(t,e,n,s,r,i,o,a,c,u,h){var l,f,p,d,_,g=s&&s.__k||Ar,y=e.length;for(n.__d=c,aa(n,e,g),c=n.__d,l=0;l<y;l++)(p=n.__k[l])!=null&&typeof p!="boolean"&&typeof p!="function"&&(f=p.__i===-1?qe:g[p.__i]||qe,p.__i=l,Dn(t,p,f,r,i,o,a,c,u,h),d=p.__e,p.ref&&f.ref!=p.ref&&(f.ref&&Ln(f.ref,null,p),h.push(p.ref,p.__c||d,p)),_==null&&d!=null&&(_=d),65536&p.__u||f.__k===p.__k?c=kr(p,c,t):typeof p.type=="function"&&p.__d!==void 0?c=p.__d:d&&(c=d.nextSibling),p.__d=void 0,p.__u&=-196609);n.__d=c,n.__e=_}function aa(t,e,n){var s,r,i,o,a,c=e.length,u=n.length,h=u,l=0;for(t.__k=[],s=0;s<c;s++)o=s+l,(r=t.__k[s]=(r=e[s])==null||typeof r=="boolean"||typeof r=="function"?null:typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?Xe(null,r,null,null,null):At(r)?Xe(oe,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?Xe(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)!=null?(r.__=t,r.__b=t.__b+1,a=ca(r,n,o,h),r.__i=a,i=null,a!==-1&&(h--,(i=n[a])&&(i.__u|=131072)),i==null||i.__v===null?(a==-1&&l--,typeof r.type!="function"&&(r.__u|=65536)):a!==o&&(a==o-1?l--:a==o+1?l++:a>o?h>c-o?l+=a-o:l--:a<o&&(a==o-l?l-=a-o:l++),a!==s+l&&(r.__u|=65536))):(i=n[o])&&i.key==null&&i.__e&&!(131072&i.__u)&&(i.__e==t.__d&&(t.__d=Ee(i)),pn(i,i,!1),n[o]=null,h--);if(h)for(s=0;s<u;s++)(i=n[s])!=null&&!(131072&i.__u)&&(i.__e==t.__d&&(t.__d=Ee(i)),pn(i,i))}function kr(t,e,n){var s,r;if(typeof t.type=="function"){for(s=t.__k,r=0;s&&r<s.length;r++)s[r]&&(s[r].__=t,e=kr(s[r],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=Ee(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function pe(t,e){return e=e||[],t==null||typeof t=="boolean"||(At(t)?t.some(function(n){pe(n,e)}):e.push(t)),e}function ca(t,e,n,s){var r=t.key,i=t.type,o=n-1,a=n+1,c=e[n];if(c===null||c&&r==c.key&&i===c.type&&!(131072&c.__u))return n;if(s>(c!=null&&!(131072&c.__u)?1:0))for(;o>=0||a<e.length;){if(o>=0){if((c=e[o])&&!(131072&c.__u)&&r==c.key&&i===c.type)return o;o--}if(a<e.length){if((c=e[a])&&!(131072&c.__u)&&r==c.key&&i===c.type)return a;a++}}return-1}function gs(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||oa.test(e)?n:n+"px"}function ct(t,e,n,s,r){var i;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(e in s)n&&e in n||gs(t.style,e,"");if(n)for(e in n)s&&n[e]===s[e]||gs(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?s?n.u=s.u:(n.u=Cn,t.addEventListener(e,i?hn:un,i)):t.removeEventListener(e,i?hn:un,i);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ys(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Cn++;else if(e.t<n.u)return;return n(E.event?E.event(e):e)}}}function Dn(t,e,n,s,r,i,o,a,c,u){var h,l,f,p,d,_,g,y,v,m,w,P,S,F,N,V,x=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(c=!!(32&n.__u),i=[a=e.__e=n.__e]),(h=E.__b)&&h(e);e:if(typeof x=="function")try{if(y=e.props,v="prototype"in x&&x.prototype.render,m=(h=x.contextType)&&s[h.__c],w=h?m?m.props.value:h.__:s,n.__c?g=(l=e.__c=n.__c).__=l.__E:(v?e.__c=l=new x(y,w):(e.__c=l=new ie(y,w),l.constructor=x,l.render=ua),m&&m.sub(l),l.props=y,l.state||(l.state={}),l.context=w,l.__n=s,f=l.__d=!0,l.__h=[],l._sb=[]),v&&l.__s==null&&(l.__s=l.state),v&&x.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=ue({},l.__s)),ue(l.__s,x.getDerivedStateFromProps(y,l.__s))),p=l.props,d=l.state,l.__v=e,f)v&&x.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),v&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(v&&x.getDerivedStateFromProps==null&&y!==p&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(y,w),!l.__e&&(l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(y,l.__s,w)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(l.props=y,l.state=l.__s,l.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(k){k&&(k.__=e)}),P=0;P<l._sb.length;P++)l.__h.push(l._sb[P]);l._sb=[],l.__h.length&&o.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(y,l.__s,w),v&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(p,d,_)})}if(l.context=w,l.props=y,l.__P=t,l.__e=!1,S=E.__r,F=0,v){for(l.state=l.__s,l.__d=!1,S&&S(e),h=l.render(l.props,l.state,l.context),N=0;N<l._sb.length;N++)l.__h.push(l._sb[N]);l._sb=[]}else do l.__d=!1,S&&S(e),h=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++F<25);l.state=l.__s,l.getChildContext!=null&&(s=ue(ue({},s),l.getChildContext())),v&&!f&&l.getSnapshotBeforeUpdate!=null&&(_=l.getSnapshotBeforeUpdate(p,d)),Lr(t,At(V=h!=null&&h.type===oe&&h.key==null?h.props.children:h)?V:[V],e,n,s,r,i,o,a,c,u),l.base=e.__e,e.__u&=-161,l.__h.length&&o.push(l),g&&(l.__E=l.__=null)}catch(k){if(e.__v=null,c||i!=null){for(e.__u|=c?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;i[i.indexOf(a)]=null,e.__e=a}else e.__e=n.__e,e.__k=n.__k;E.__e(k,e,n)}else i==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=la(n.__e,e,n,s,r,i,o,c,u);(h=E.diffed)&&h(e)}function Or(t,e,n){e.__d=void 0;for(var s=0;s<n.length;s++)Ln(n[s],n[++s],n[++s]);E.__c&&E.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(i){i.call(r)})}catch(i){E.__e(i,r.__v)}})}function la(t,e,n,s,r,i,o,a,c){var u,h,l,f,p,d,_,g=n.props,y=e.props,v=e.type;if(v==="svg"?r="http://www.w3.org/2000/svg":v==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((p=i[u])&&"setAttribute"in p==!!v&&(v?p.localName===v:p.nodeType===3)){t=p,i[u]=null;break}}if(t==null){if(v===null)return document.createTextNode(y);t=document.createElementNS(r,v,y.is&&y),i=null,a=!1}if(v===null)g===y||a&&t.data===y||(t.data=y);else{if(i=i&&et.call(t.childNodes),g=n.props||qe,!a&&i!=null)for(g={},u=0;u<t.attributes.length;u++)g[(p=t.attributes[u]).name]=p.value;for(u in g)if(p=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")l=p;else if(u!=="key"&&!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;ct(t,u,null,p,r)}}for(u in y)p=y[u],u=="children"?f=p:u=="dangerouslySetInnerHTML"?h=p:u=="value"?d=p:u=="checked"?_=p:u==="key"||a&&typeof p!="function"||g[u]===p||ct(t,u,p,g[u],r);if(h)a||l&&(h.__html===l.__html||h.__html===t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(l&&(t.innerHTML=""),Lr(t,At(f)?f:[f],e,n,s,v==="foreignObject"?"http://www.w3.org/1999/xhtml":r,i,o,i?i[0]:n.__k&&Ee(n,0),a,c),i!=null)for(u=i.length;u--;)i[u]!=null&&Mr(i[u]);a||(u="value",d!==void 0&&(d!==t[u]||v==="progress"&&!d||v==="option"&&d!==g[u])&&ct(t,u,d,g[u],r),u="checked",_!==void 0&&_!==t[u]&&ct(t,u,_,g[u],r))}return t}function Ln(t,e,n){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&e==null||(t.__u=t(e))}else t.current=e}catch(r){E.__e(r,n)}}function pn(t,e,n){var s,r;if(E.unmount&&E.unmount(t),(s=t.ref)&&(s.current&&s.current!==t.__e||Ln(s,null,e)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(i){E.__e(i,e)}s.base=s.__P=null}if(s=t.__k)for(r=0;r<s.length;r++)s[r]&&pn(s[r],e,n||typeof t.type!="function");n||t.__e==null||Mr(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function ua(t,e,n){return this.constructor(t,n)}function Be(t,e,n){var s,r,i,o;E.__&&E.__(t,e),r=(s=typeof n=="function")?null:n&&n.__k||e.__k,i=[],o=[],Dn(e,t=(!s&&n||e).__k=le(oe,null,[t]),r||qe,qe,e.namespaceURI,!s&&n?[n]:r?null:e.firstChild?et.call(e.childNodes):null,i,!s&&n?n:r?r.__e:e.firstChild,s,o),Or(i,t,o)}function Rr(t,e){Be(t,e,Rr)}function ha(t,e,n){var s,r,i,o,a=ue({},t.props);for(i in t.type&&t.type.defaultProps&&(o=t.type.defaultProps),e)i=="key"?s=e[i]:i=="ref"?r=e[i]:a[i]=e[i]===void 0&&o!==void 0?o[i]:e[i];return arguments.length>2&&(a.children=arguments.length>3?et.call(arguments,2):n),Xe(t.type,a,s||t.key,r||t.ref,null)}function Ir(t,e){var n={__c:e="__cC"+Tr++,__:t,Consumer:function(s,r){return s.children(r)},Provider:function(s){var r,i;return this.getChildContext||(r=[],(i={})[e]=this,this.getChildContext=function(){return i},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&r.some(function(a){a.__e=!0,fn(a)})},this.sub=function(o){r.push(o);var a=o.componentWillUnmount;o.componentWillUnmount=function(){r&&r.splice(r.indexOf(o),1),a&&a.call(o)}}),s.children}};return n.Provider.__=n.Consumer.contextType=n}et=Ar.slice,E={__e:function(t,e,n,s){for(var r,i,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&i.getDerivedStateFromError!=null&&(r.setState(i.getDerivedStateFromError(t)),o=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,s||{}),o=r.__d),o)return r.__E=r}catch(a){t=a}throw t}},Pr=0,ie.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ue({},this.state),typeof t=="function"&&(t=t(ue({},n),this.props)),t&&ue(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),fn(this))},ie.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),fn(this))},ie.prototype.render=oe,we=[],xr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ln=function(t,e){return t.__v.__b-e.__v.__b},vt.__r=0,Cn=0,un=ys(!1),hn=ys(!0),Tr=0;var fa=0;function ne(t,e,n,s,r,i){e||(e={});var o,a,c=e;if("ref"in c)for(a in c={},e)a=="ref"?o=e[a]:c[a]=e[a];var u={type:t,props:c,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--fa,__i:-1,__u:0,__source:r,__self:i};if(typeof t=="function"&&(o=t.defaultProps))for(a in o)c[a]===void 0&&(c[a]=o[a]);return E.vnode&&E.vnode(u),u}const pa="modulepreload",da=function(t){return"/dl-model/"+t},vs={},D=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.allSettled(n.map(a=>{if(a=da(a),a in vs)return;vs[a]=!0;const c=a.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":pa,c||(h.as="script"),h.crossOrigin="",h.href=a,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((l,f)=>{h.addEventListener("load",l),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(i=>{for(const o of i||[]){if(o.status!=="rejected")continue;const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o.reason,window.dispatchEvent(a),!a.defaultPrevented)throw o.reason}return e()})};var de,A,Wt,ws,je=0,Fr=[],C=E,bs=C.__b,Es=C.__r,Ss=C.diffed,Ps=C.__c,xs=C.unmount,Ts=C.__;function Te(t,e){C.__h&&C.__h(A,t,je||e),je=0;var n=A.__H||(A.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function tt(t){return je=1,Mt(Br,t)}function Mt(t,e,n){var s=Te(de++,2);if(s.t=t,!s.__c&&(s.__=[n?n(e):Br(void 0,e),function(a){var c=s.__N?s.__N[0]:s.__[0],u=s.t(c,a);c!==u&&(s.__N=[u,s.__[1]],s.__c.setState({}))}],s.__c=A,!A.u)){var r=function(a,c,u){if(!s.__c.__H)return!0;var h=s.__c.__H.__.filter(function(f){return!!f.__c});if(h.every(function(f){return!f.__N}))return!i||i.call(this,a,c,u);var l=!1;return h.forEach(function(f){if(f.__N){var p=f.__[0];f.__=f.__N,f.__N=void 0,p!==f.__[0]&&(l=!0)}}),!(!l&&s.__c.props===a)&&(!i||i.call(this,a,c,u))};A.u=!0;var i=A.shouldComponentUpdate,o=A.componentWillUpdate;A.componentWillUpdate=function(a,c,u){if(this.__e){var h=i;i=void 0,r(a,c,u),i=h}o&&o.call(this,a,c,u)},A.shouldComponentUpdate=r}return s.__N||s.__}function Se(t,e){var n=Te(de++,3);!C.__s&&Bn(n.__H,e)&&(n.__=t,n.i=e,A.__H.__h.push(n))}function He(t,e){var n=Te(de++,4);!C.__s&&Bn(n.__H,e)&&(n.__=t,n.i=e,A.__h.push(n))}function Ne(t){return je=5,nt(function(){return{current:t}},[])}function kn(t,e,n){je=6,He(function(){return typeof t=="function"?(t(e()),function(){return t(null)}):t?(t.current=e(),function(){return t.current=null}):void 0},n==null?n:n.concat(t))}function nt(t,e){var n=Te(de++,7);return Bn(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function On(t,e){return je=8,nt(function(){return t},e)}function Rn(t){var e=A.context[t.__c],n=Te(de++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(A)),e.props.value):t.__}function In(t,e){C.useDebugValue&&C.useDebugValue(e?e(t):t)}function ma(t){var e=Te(de++,10),n=tt();return e.__=t,A.componentDidCatch||(A.componentDidCatch=function(s,r){e.__&&e.__(s,r),n[1](s)}),[n[0],function(){n[1](void 0)}]}function Fn(){var t=Te(de++,11);if(!t.__){for(var e=A.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function _a(){for(var t;t=Fr.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(mt),t.__H.__h.forEach(dn),t.__H.__h=[]}catch(e){t.__H.__h=[],C.__e(e,t.__v)}}C.__b=function(t){A=null,bs&&bs(t)},C.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Ts&&Ts(t,e)},C.__r=function(t){Es&&Es(t),de=0;var e=(A=t.__c).__H;e&&(Wt===A?(e.__h=[],A.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(mt),e.__h.forEach(dn),e.__h=[],de=0)),Wt=A},C.diffed=function(t){Ss&&Ss(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Fr.push(e)!==1&&ws===C.requestAnimationFrame||((ws=C.requestAnimationFrame)||ga)(_a)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),Wt=A=null},C.__c=function(t,e){e.some(function(n){try{n.__h.forEach(mt),n.__h=n.__h.filter(function(s){return!s.__||dn(s)})}catch(s){e.some(function(r){r.__h&&(r.__h=[])}),e=[],C.__e(s,n.__v)}}),Ps&&Ps(t,e)},C.unmount=function(t){xs&&xs(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{mt(s)}catch(r){e=r}}),n.__H=void 0,e&&C.__e(e,n.__v))};var As=typeof requestAnimationFrame=="function";function ga(t){var e,n=function(){clearTimeout(s),As&&cancelAnimationFrame(e),setTimeout(t)},s=setTimeout(n,100);As&&(e=requestAnimationFrame(n))}function mt(t){var e=A,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),A=e}function dn(t){var e=A;t.__c=t.__(),A=e}function Bn(t,e){return!t||t.length!==e.length||e.some(function(n,s){return n!==t[s]})}function Br(t,e){return typeof e=="function"?e(t):e}function jr(t,e){for(var n in e)t[n]=e[n];return t}function mn(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var s in e)if(s!=="__source"&&t[s]!==e[s])return!0;return!1}function wt(t,e){this.props=t,this.context=e}function Nr(t,e){function n(r){var i=this.props.ref,o=i==r.ref;return!o&&i&&(i.call?i(null):i.current=null),e?!e(this.props,r)||!o:mn(this.props,r)}function s(r){return this.shouldComponentUpdate=n,le(t,r)}return s.displayName="Memo("+(t.displayName||t.name)+")",s.prototype.isReactComponent=!0,s.__f=!0,s}(wt.prototype=new ie).isPureReactComponent=!0,wt.prototype.shouldComponentUpdate=function(t,e){return mn(this.props,t)||mn(this.state,e)};var Ms=E.__b;E.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Ms&&Ms(t)};var ya=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function $r(t){function e(n){var s=jr({},n);return delete s.ref,t(s,n.ref||null)}return e.$$typeof=ya,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var Cs=function(t,e){return t==null?null:pe(pe(t).map(e))},Ur={map:Cs,forEach:Cs,count:function(t){return t?pe(t).length:0},only:function(t){var e=pe(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:pe},va=E.__e;E.__e=function(t,e,n,s){if(t.then){for(var r,i=e;i=i.__;)if((r=i.__c)&&r.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e)}va(t,e,n,s)};var Ds=E.unmount;function zr(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),t.__c.__H=null),(t=jr({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(s){return zr(s,e,n)})),t}function Vr(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(s){return Vr(s,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function be(){this.__u=0,this.t=null,this.__b=null}function Hr(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function G(t){var e,n,s;function r(i){if(e||(e=t()).then(function(o){n=o.default||o},function(o){s=o}),s)throw s;if(!n)throw e;return le(n,i)}return r.displayName="Lazy",r.__f=!0,r}function Re(){this.u=null,this.o=null}E.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Ds&&Ds(t)},(be.prototype=new ie).__c=function(t,e){var n=e.__c,s=this;s.t==null&&(s.t=[]),s.t.push(n);var r=Hr(s.__v),i=!1,o=function(){i||(i=!0,n.__R=null,r?r(a):a())};n.__R=o;var a=function(){if(!--s.__u){if(s.state.__a){var c=s.state.__a;s.__v.__k[0]=Vr(c,c.__c.__P,c.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.t.pop();)u.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),t.then(o,o)},be.prototype.componentWillUnmount=function(){this.t=[]},be.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=zr(this.__b,n,s.__O=s.__P)}this.__b=null}var r=e.__a&&le(oe,null,t.fallback);return r&&(r.__u&=-33),[le(oe,null,e.__a?null:t.children),r]};var Ls=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function wa(t){return this.getChildContext=function(){return t.context},t.children}function ba(t){var e=this,n=t.i;e.componentWillUnmount=function(){Be(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],contains:function(){return!0},appendChild:function(s){this.childNodes.push(s),e.i.appendChild(s)},insertBefore:function(s,r){this.childNodes.push(s),e.i.appendChild(s)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.i.removeChild(s)}}),Be(le(wa,{context:e.context},t.__v),e.l)}function Wr(t,e){var n=le(ba,{__v:t,i:e});return n.containerInfo=e,n}(Re.prototype=new ie).__a=function(t){var e=this,n=Hr(e.__v),s=e.o.get(t);return s[0]++,function(r){var i=function(){e.props.revealOrder?(s.push(r),Ls(e,t,s)):r()};n?n(i):i()}},Re.prototype.render=function(t){this.u=null,this.o=new Map;var e=pe(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},Re.prototype.componentDidUpdate=Re.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){Ls(t,n,e)})};var Gr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Ea=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Sa=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Pa=/[A-Z0-9]/g,xa=typeof document<"u",Ta=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function Xr(t,e,n){return e.__k==null&&(e.textContent=""),Be(t,e),typeof n=="function"&&n(),t?t.__c:null}function Kr(t,e,n){return Rr(t,e),typeof n=="function"&&n(),t?t.__c:null}ie.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(ie.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var ks=E.event;function Aa(){}function Ma(){return this.cancelBubble}function Ca(){return this.defaultPrevented}E.event=function(t){return ks&&(t=ks(t)),t.persist=Aa,t.isPropagationStopped=Ma,t.isDefaultPrevented=Ca,t.nativeEvent=t};var jn,Da={enumerable:!1,configurable:!0,get:function(){return this.class}},Os=E.vnode;E.vnode=function(t){typeof t.type=="string"&&function(e){var n=e.props,s=e.type,r={},i=s.indexOf("-")===-1;for(var o in n){var a=n[o];if(!(o==="value"&&"defaultValue"in n&&a==null||xa&&o==="children"&&s==="noscript"||o==="class"||o==="className")){var c=o.toLowerCase();o==="defaultValue"&&"value"in n&&n.value==null?o="value":o==="download"&&a===!0?a="":c==="translate"&&a==="no"?a=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?o="ondblclick":c!=="onchange"||s!=="input"&&s!=="textarea"||Ta(n.type)?c==="onfocus"?o="onfocusin":c==="onblur"?o="onfocusout":Sa.test(o)&&(o=c):c=o="oninput":i&&Ea.test(o)?o=o.replace(Pa,"-$&").toLowerCase():a===null&&(a=void 0),c==="oninput"&&r[o=c]&&(o="oninputCapture"),r[o]=a}}s=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=pe(n.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),s=="select"&&r.defaultValue!=null&&(r.value=pe(n.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",Da)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),e.props=r}(t),t.$$typeof=Gr,Os&&Os(t)};var Rs=E.__r;E.__r=function(t){Rs&&Rs(t),jn=t.__c};var Is=E.diffed;E.diffed=function(t){Is&&Is(t);var e=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value),jn=null};var Yr={ReactCurrentDispatcher:{current:{readContext:function(t){return jn.__n[t.__c].props.value},useCallback:On,useContext:Rn,useDebugValue:In,useDeferredValue:$n,useEffect:Se,useId:Fn,useImperativeHandle:kn,useInsertionEffect:zn,useLayoutEffect:He,useMemo:nt,useReducer:Mt,useRef:Ne,useState:tt,useSyncExternalStore:Vn,useTransition:Un}}},La="17.0.2";function qr(t){return le.bind(null,t)}function st(t){return!!t&&t.$$typeof===Gr}function Zr(t){return st(t)&&t.type===oe}function Qr(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function Jr(t){return st(t)?ha.apply(null,arguments):t}function ei(t){return!!t.__k&&(Be(null,t),!0)}function ti(t){return t&&(t.base||t.nodeType===1&&t)||null}var ni=function(t,e){return t(e)},si=function(t,e){return t(e)},ri=oe;function Nn(t){t()}function $n(t){return t}function Un(){return[!1,Nn]}var zn=He,ii=st;function Vn(t,e){var n=e(),s=tt({h:{__:n,v:e}}),r=s[0].h,i=s[1];return He(function(){r.__=n,r.v=e,Gt(r)&&i({h:r})},[t,n,e]),Se(function(){return Gt(r)&&i({h:r}),t(function(){Gt(r)&&i({h:r})})},[t]),n}function Gt(t){var e,n,s=t.v,r=t.__;try{var i=s();return!((e=r)===(n=i)&&(e!==0||1/e==1/n)||e!=e&&n!=n)}catch{return!0}}var oi={useState:tt,useId:Fn,useReducer:Mt,useEffect:Se,useLayoutEffect:He,useInsertionEffect:zn,useTransition:Un,useDeferredValue:$n,useSyncExternalStore:Vn,startTransition:Nn,useRef:Ne,useImperativeHandle:kn,useMemo:nt,useCallback:On,useContext:Rn,useDebugValue:In,version:"17.0.2",Children:Ur,render:Xr,hydrate:Kr,unmountComponentAtNode:ei,createPortal:Wr,createElement:le,createContext:Ir,createFactory:qr,cloneElement:Jr,createRef:Cr,Fragment:oe,isValidElement:st,isElement:ii,isFragment:Zr,isMemo:Qr,findDOMNode:ti,Component:ie,PureComponent:wt,memo:Nr,forwardRef:$r,flushSync:si,unstable_batchedUpdates:ni,StrictMode:ri,Suspense:be,SuspenseList:Re,lazy:G,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Yr};const ka=Object.freeze(Object.defineProperty({__proto__:null,Children:Ur,Component:ie,Fragment:oe,PureComponent:wt,StrictMode:ri,Suspense:be,SuspenseList:Re,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Yr,cloneElement:Jr,createContext:Ir,createElement:le,createFactory:qr,createPortal:Wr,createRef:Cr,default:oi,findDOMNode:ti,flushSync:si,forwardRef:$r,hydrate:Kr,isElement:ii,isFragment:Zr,isMemo:Qr,isValidElement:st,lazy:G,memo:Nr,render:Xr,startTransition:Nn,unmountComponentAtNode:ei,unstable_batchedUpdates:ni,useCallback:On,useContext:Rn,useDebugValue:In,useDeferredValue:$n,useEffect:Se,useErrorBoundary:ma,useId:Fn,useImperativeHandle:kn,useInsertionEffect:zn,useLayoutEffect:He,useMemo:nt,useReducer:Mt,useRef:Ne,useState:tt,useSyncExternalStore:Vn,useTransition:Un,version:La},Symbol.toStringTag,{value:"Module"})),Oa=()=>{const t=Ne(!0);return Se(()=>{t.current=!1},[]),t.current},Ra={BASE_URL:"/dl-model/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Fs=t=>{let e;const n=new Set,s=(h,l)=>{const f=typeof h=="function"?h(e):h;if(!Object.is(f,e)){const p=e;e=l??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(d=>d(e,p))}},r=()=>e,c={setState:s,getState:r,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(Ra?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=t(s,r,c);return c},Ia=t=>t?Fs(t):Fs;var Le=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ai(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Fa(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var ci={exports:{}},li={};const ui=Fa(ka);var hi={exports:{}},fi={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $e=ui;function Ba(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ja=typeof Object.is=="function"?Object.is:Ba,Na=$e.useState,$a=$e.useEffect,Ua=$e.useLayoutEffect,za=$e.useDebugValue;function Va(t,e){var n=e(),s=Na({inst:{value:n,getSnapshot:e}}),r=s[0].inst,i=s[1];return Ua(function(){r.value=n,r.getSnapshot=e,Xt(r)&&i({inst:r})},[t,n,e]),$a(function(){return Xt(r)&&i({inst:r}),t(function(){Xt(r)&&i({inst:r})})},[t]),za(n),n}function Xt(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ja(t,n)}catch{return!0}}function Ha(t,e){return e()}var Wa=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ha:Va;fi.useSyncExternalStore=$e.useSyncExternalStore!==void 0?$e.useSyncExternalStore:Wa;hi.exports=fi;var Ga=hi.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ct=ui,Xa=Ga;function Ka(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ya=typeof Object.is=="function"?Object.is:Ka,qa=Xa.useSyncExternalStore,Za=Ct.useRef,Qa=Ct.useEffect,Ja=Ct.useMemo,ec=Ct.useDebugValue;li.useSyncExternalStoreWithSelector=function(t,e,n,s,r){var i=Za(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=Ja(function(){function c(p){if(!u){if(u=!0,h=p,p=s(p),r!==void 0&&o.hasValue){var d=o.value;if(r(d,p))return l=d}return l=p}if(d=l,Ya(h,p))return d;var _=s(p);return r!==void 0&&r(d,_)?d:(h=p,l=_)}var u=!1,h,l,f=n===void 0?null:n;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,n,s,r]);var a=qa(t,i[0],i[1]);return Qa(function(){o.hasValue=!0,o.value=a},[a]),ec(a),a};ci.exports=li;var tc=ci.exports;const nc=ai(tc),pi={BASE_URL:"/dl-model/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:sc}=oi,{useSyncExternalStoreWithSelector:rc}=nc;let Bs=!1;const ic=t=>t;function oc(t,e=ic,n){(pi?"production":void 0)!=="production"&&n&&!Bs&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Bs=!0);const s=rc(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return sc(s),s}const js=t=>{(pi?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Ia(t):t,n=(s,r)=>oc(e,s,r);return Object.assign(n,e),n},Hn=t=>t?js(t):js;var di=Symbol.for("immer-nothing"),Ns=Symbol.for("immer-draftable"),Y=Symbol.for("immer-state");function re(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ue=Object.getPrototypeOf;function ze(t){return!!t&&!!t[Y]}function Pe(t){var e;return t?mi(t)||Array.isArray(t)||!!t[Ns]||!!((e=t.constructor)!=null&&e[Ns])||Lt(t)||kt(t):!1}var ac=Object.prototype.constructor.toString();function mi(t){if(!t||typeof t!="object")return!1;const e=Ue(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===ac}function bt(t,e){Dt(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,s)=>e(s,n,t))}function Dt(t){const e=t[Y];return e?e.type_:Array.isArray(t)?1:Lt(t)?2:kt(t)?3:0}function _n(t,e){return Dt(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function _i(t,e,n){const s=Dt(t);s===2?t.set(e,n):s===3?t.add(n):t[e]=n}function cc(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Lt(t){return t instanceof Map}function kt(t){return t instanceof Set}function ye(t){return t.copy_||t.base_}function gn(t,e){if(Lt(t))return new Map(t);if(kt(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=mi(t);if(e===!0||e==="class_only"&&!n){const s=Object.getOwnPropertyDescriptors(t);delete s[Y];let r=Reflect.ownKeys(s);for(let i=0;i<r.length;i++){const o=r[i],a=s[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(s[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Ue(t),s)}else{const s=Ue(t);if(s!==null&&n)return{...t};const r=Object.create(s);return Object.assign(r,t)}}function Wn(t,e=!1){return Ot(t)||ze(t)||!Pe(t)||(Dt(t)>1&&(t.set=t.add=t.clear=t.delete=lc),Object.freeze(t),e&&Object.entries(t).forEach(([n,s])=>Wn(s,!0))),t}function lc(){re(2)}function Ot(t){return Object.isFrozen(t)}var uc={};function xe(t){const e=uc[t];return e||re(0,t),e}var Ze;function gi(){return Ze}function hc(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $s(t,e){e&&(xe("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function yn(t){vn(t),t.drafts_.forEach(fc),t.drafts_=null}function vn(t){t===Ze&&(Ze=t.parent_)}function Us(t){return Ze=hc(Ze,t)}function fc(t){const e=t[Y];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Y].modified_&&(yn(e),re(4)),Pe(t)&&(t=Et(e,t),e.parent_||St(e,t)),e.patches_&&xe("Patches").generateReplacementPatches_(n[Y].base_,t,e.patches_,e.inversePatches_)):t=Et(e,n,[]),yn(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==di?t:void 0}function Et(t,e,n){if(Ot(e))return e;const s=e[Y];if(!s)return bt(e,(r,i)=>Vs(t,s,e,r,i,n)),e;if(s.scope_!==t)return e;if(!s.modified_)return St(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const r=s.copy_;let i=r,o=!1;s.type_===3&&(i=new Set(r),r.clear(),o=!0),bt(i,(a,c)=>Vs(t,s,r,a,c,n,o)),St(t,r,!1),n&&t.patches_&&xe("Patches").generatePatches_(s,n,t.patches_,t.inversePatches_)}return s.copy_}function Vs(t,e,n,s,r,i,o){if(ze(r)){const a=i&&e&&e.type_!==3&&!_n(e.assigned_,s)?i.concat(s):void 0,c=Et(t,r,a);if(_i(n,s,c),ze(c))t.canAutoFreeze_=!1;else return}else o&&n.add(r);if(Pe(r)&&!Ot(r)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Et(t,r),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,s)&&St(t,r)}}function St(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Wn(e,n)}function pc(t,e){const n=Array.isArray(t),s={type_:n?1:0,scope_:e?e.scope_:gi(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=s,i=Gn;n&&(r=[s],i=Qe);const{revoke:o,proxy:a}=Proxy.revocable(r,i);return s.draft_=a,s.revoke_=o,a}var Gn={get(t,e){if(e===Y)return t;const n=ye(t);if(!_n(n,e))return dc(t,n,e);const s=n[e];return t.finalized_||!Pe(s)?s:s===Kt(t.base_,e)?(Yt(t),t.copy_[e]=bn(s,t)):s},has(t,e){return e in ye(t)},ownKeys(t){return Reflect.ownKeys(ye(t))},set(t,e,n){const s=yi(ye(t),e);if(s!=null&&s.set)return s.set.call(t.draft_,n),!0;if(!t.modified_){const r=Kt(ye(t),e),i=r==null?void 0:r[Y];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(cc(n,r)&&(n!==void 0||_n(t.base_,e)))return!0;Yt(t),wn(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Kt(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Yt(t),wn(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=ye(t),s=Reflect.getOwnPropertyDescriptor(n,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:n[e]}},defineProperty(){re(11)},getPrototypeOf(t){return Ue(t.base_)},setPrototypeOf(){re(12)}},Qe={};bt(Gn,(t,e)=>{Qe[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Qe.deleteProperty=function(t,e){return Qe.set.call(this,t,e,void 0)};Qe.set=function(t,e,n){return Gn.set.call(this,t[0],e,n,t[0])};function Kt(t,e){const n=t[Y];return(n?ye(n):t)[e]}function dc(t,e,n){var r;const s=yi(e,n);return s?"value"in s?s.value:(r=s.get)==null?void 0:r.call(t.draft_):void 0}function yi(t,e){if(!(e in t))return;let n=Ue(t);for(;n;){const s=Object.getOwnPropertyDescriptor(n,e);if(s)return s;n=Ue(n)}}function wn(t){t.modified_||(t.modified_=!0,t.parent_&&wn(t.parent_))}function Yt(t){t.copy_||(t.copy_=gn(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var mc=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,s)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,h=>n.call(this,h,...u))}}typeof n!="function"&&re(6),s!==void 0&&typeof s!="function"&&re(7);let r;if(Pe(e)){const i=Us(this),o=bn(e,void 0);let a=!0;try{r=n(o),a=!1}finally{a?yn(i):vn(i)}return $s(i,s),zs(r,i)}else if(!e||typeof e!="object"){if(r=n(e),r===void 0&&(r=e),r===di&&(r=void 0),this.autoFreeze_&&Wn(r,!0),s){const i=[],o=[];xe("Patches").generateReplacementPatches_(e,r,i,o),s(i,o)}return r}else re(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,c=>e(c,...a));let s,r;return[this.produce(e,n,(o,a)=>{s=o,r=a}),s,r]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Pe(t)||re(8),ze(t)&&(t=_c(t));const e=Us(this),n=bn(t,void 0);return n[Y].isManual_=!0,vn(e),n}finishDraft(t,e){const n=t&&t[Y];(!n||!n.isManual_)&&re(9);const{scope_:s}=n;return $s(s,e),zs(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const r=e[n];if(r.path.length===0&&r.op==="replace"){t=r.value;break}}n>-1&&(e=e.slice(n+1));const s=xe("Patches").applyPatches_;return ze(t)?s(t,e):this.produce(t,r=>s(r,e))}};function bn(t,e){const n=Lt(t)?xe("MapSet").proxyMap_(t,e):kt(t)?xe("MapSet").proxySet_(t,e):pc(t,e);return(e?e.scope_:gi()).drafts_.push(n),n}function _c(t){return ze(t)||re(10,t),vi(t)}function vi(t){if(!Pe(t)||Ot(t))return t;const e=t[Y];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=gn(t,e.scope_.immer_.useStrictShallowCopy_)}else n=gn(t,!0);return bt(n,(s,r)=>{_i(n,s,vi(r))}),e&&(e.finalized_=!1),n}var q=new mc,gc=q.produce;q.produceWithPatches.bind(q);q.setAutoFreeze.bind(q);q.setUseStrictShallowCopy.bind(q);q.applyPatches.bind(q);q.createDraft.bind(q);q.finishDraft.bind(q);const wi=t=>({indices:[0,0],_indicesCache:{},setIndex:(e,n)=>{t(s=>{const{indices:r,_indicesCache:i}=s;r[e]=n;const o=r.slice(0,e+1).join(),a=i[o]??[],{length:c}=r;for(let l=0;e+1+l<c;l++)r[e+1+l]=a[l]??0;const u=r.slice(e),h=r.slice(0,e).join();h&&(i[h]=u)})},showFilter:!1,toggleFilter:()=>t(e=>{e.showFilter=!e.showFilter}),searchAll:!1,toggleSearchAll:()=>t(e=>{e.searchAll=!e.searchAll})}),Hs=t=>t==="true";function bi(t,e){return t&&e&&Object.keys(e).forEach(n=>{const s=e[n];typeof s=="object"?(t[n]||(t[n]={}),bi(t[n],s)):t[n]=s}),t}const yc=(t,e)=>({category:"Adv",setCategory:n=>t(s=>{s.category=n}),advAni:{category:"home",setCategory:n=>t(s=>{s.advAni.category=n}),home:{gender:"Male",setGender:n=>t(s=>{s.advAni.home.gender=n})},weapon:{type:"Sword",setType:n=>t(s=>{s.advAni.weapon.type=n}),gunMode:"Long",setGunMode:n=>t(s=>{s.advAni.weapon.gunMode=n})},genericSkill:{type:"Sword",setType:n=>t(s=>{s.advAni.genericSkill.type=n})},groupByWeapon:{setGroupWeaponType:(n,s)=>t(r=>{r.advAni.groupByWeapon[n]=s})},uniqueOther:{type:"Sword",setType:n=>t(s=>{s.advAni.uniqueOther.type=n}),selected:"",setSelected:n=>t(s=>{s.advAni.uniqueOther.selected=n})}},extraAni:{category:"Dance",setCategory:n=>t(s=>{s.extraAni.category=n})},personalAni:{source:"",setSource:n=>t(s=>{s.personalAni.source=n}),sourceName:"",setSourceName:n=>t(s=>{s.personalAni.sourceName=n})},getCurrentState:()=>{const n=e();return JSON.parse(JSON.stringify(n))},loadState:(n={})=>{t(s=>bi(s,n))}}),Ws={type:"change"},Xn={type:"start"},Ei={type:"end"},lt=new mo,Gs=new _o,vc=Math.cos(70*U.DEG2RAD),B=new L,H=2*Math.PI,T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},qt=1e-6;class wc extends go{constructor(e,n=null){super(e,n),this.state=T.NONE,this.enabled=!0,this.target=new L,this.cursor=new L,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Fe.ROTATE,MIDDLE:Fe.DOLLY,RIGHT:Fe.PAN},this.touches={ONE:Oe.ROTATE,TWO:Oe.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new L,this._lastQuaternion=new ae,this._lastTargetPosition=new L,this._quat=new ae().setFromUnitVectors(e.up,new L(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new as,this._sphericalDelta=new as,this._scale=1,this._panOffset=new L,this._rotateStart=new j,this._rotateEnd=new j,this._rotateDelta=new j,this._panStart=new j,this._panEnd=new j,this._panDelta=new j,this._dollyStart=new j,this._dollyEnd=new j,this._dollyDelta=new j,this._dollyDirection=new L,this._mouse=new j,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Ec.bind(this),this._onPointerDown=bc.bind(this),this._onPointerUp=Sc.bind(this),this._onContextMenu=Dc.bind(this),this._onMouseWheel=Tc.bind(this),this._onKeyDown=Ac.bind(this),this._onTouchStart=Mc.bind(this),this._onTouchMove=Cc.bind(this),this._onMouseDown=Pc.bind(this),this._onMouseMove=xc.bind(this),this._interceptControlDown=Lc.bind(this),this._interceptControlUp=kc.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Ws),this.update(),this.state=T.NONE}update(e=null){const n=this.object.position;B.copy(n).sub(this.target),B.applyQuaternion(this._quat),this._spherical.setFromVector3(B),this.autoRotate&&this.state===T.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(s)&&isFinite(r)&&(s<-Math.PI?s+=H:s>Math.PI&&(s-=H),r<-Math.PI?r+=H:r>Math.PI&&(r-=H),s<=r?this._spherical.theta=Math.max(s,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+r)/2?Math.max(s,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=o!=this._spherical.radius}if(B.setFromSpherical(this._spherical),B.applyQuaternion(this._quatInverse),n.copy(this.target).add(B),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=B.length();o=this._clampDistance(a*this._scale);const c=a-o;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),i=!!c}else if(this.object.isOrthographicCamera){const a=new L(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=c!==this.object.zoom;const u=new L(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),o=B.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(lt.origin.copy(this.object.position),lt.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(lt.direction))<vc?this.object.lookAt(this.target):(Gs.setFromNormalAndCoplanarPoint(this.object.up,this.target),lt.intersectPlane(Gs,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>qt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>qt||this._lastTargetPosition.distanceToSquared(this.target)>qt?(this.dispatchEvent(Ws),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?H/60*this.autoRotateSpeed*e:H/60/60*this.autoRotateSpeed}_getZoomScale(e){const n=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,n){B.setFromMatrixColumn(n,0),B.multiplyScalar(-e),this._panOffset.add(B)}_panUp(e,n){this.screenSpacePanning===!0?B.setFromMatrixColumn(n,1):(B.setFromMatrixColumn(n,0),B.crossVectors(this.object.up,B)),B.multiplyScalar(e),this._panOffset.add(B)}_pan(e,n){const s=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;B.copy(r).sub(this.target);let i=B.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/s.clientHeight,this.object.matrix),this._panUp(2*n*i/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),r=e-s.left,i=n-s.top,o=s.width,a=s.height;this._mouse.x=r/o*2-1,this._mouse.y=-(i/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(H*this._rotateDelta.x/n.clientHeight),this._rotateUp(H*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let n=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(H*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-H*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(H*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-H*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),r=.5*(e.pageY+n.y);this._rotateStart.set(s,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),r=.5*(e.pageY+n.y);this._panStart.set(s,r)}}_handleTouchStartDolly(e){const n=this._getSecondPointerPosition(e),s=e.pageX-n.x,r=e.pageY-n.y,i=Math.sqrt(s*s+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),r=.5*(e.pageX+s.x),i=.5*(e.pageY+s.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(H*this._rotateDelta.x/n.clientHeight),this._rotateUp(H*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),r=.5*(e.pageY+n.y);this._panEnd.set(s,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const n=this._getSecondPointerPosition(e),s=e.pageX-n.x,r=e.pageY-n.y,i=Math.sqrt(s*s+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+n.x)*.5,a=(e.pageY+n.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(e){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId)return!0;return!1}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new j,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(e){const n=e.deltaMode,s={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(n){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function bc(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function Ec(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function Sc(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Ei),this.state=T.NONE;break;case 1:const e=this._pointers[0],n=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:n.x,pageY:n.y});break}}function Pc(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Fe.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=T.DOLLY;break;case Fe.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=T.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=T.ROTATE}break;case Fe.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=T.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=T.PAN}break;default:this.state=T.NONE}this.state!==T.NONE&&this.dispatchEvent(Xn)}function xc(t){switch(this.state){case T.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case T.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case T.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function Tc(t){this.enabled===!1||this.enableZoom===!1||this.state!==T.NONE||(t.preventDefault(),this.dispatchEvent(Xn),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(Ei))}function Ac(t){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(t)}function Mc(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case Oe.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=T.TOUCH_ROTATE;break;case Oe.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=T.TOUCH_PAN;break;default:this.state=T.NONE}break;case 2:switch(this.touches.TWO){case Oe.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=T.TOUCH_DOLLY_PAN;break;case Oe.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=T.TOUCH_DOLLY_ROTATE;break;default:this.state=T.NONE}break;default:this.state=T.NONE}this.state!==T.NONE&&this.dispatchEvent(Xn)}function Cc(t){switch(this._trackPointer(t),this.state){case T.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case T.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case T.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case T.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=T.NONE}}function Dc(t){this.enabled!==!1&&t.preventDefault()}function Lc(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function kc(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Si="fbx",Pi="animations",Oc="img/textures/matcap",Rt="data";/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Q=Uint8Array,Ie=Uint16Array,Rc=Int32Array,xi=new Q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ti=new Q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ic=new Q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ai=function(t,e){for(var n=new Ie(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];for(var r=new Rc(n[30]),s=1;s<30;++s)for(var i=n[s];i<n[s+1];++i)r[i]=i-n[s]<<5|s;return{b:n,r}},Mi=Ai(xi,2),Ci=Mi.b,Fc=Mi.r;Ci[28]=258,Fc[258]=28;var Bc=Ai(Ti,0),jc=Bc.b,En=new Ie(32768);for(var M=0;M<32768;++M){var _e=(M&43690)>>1|(M&21845)<<1;_e=(_e&52428)>>2|(_e&13107)<<2,_e=(_e&61680)>>4|(_e&3855)<<4,En[M]=((_e&65280)>>8|(_e&255)<<8)>>1}var Ke=function(t,e,n){for(var s=t.length,r=0,i=new Ie(e);r<s;++r)t[r]&&++i[t[r]-1];var o=new Ie(e);for(r=1;r<e;++r)o[r]=o[r-1]+i[r-1]<<1;var a;if(n){a=new Ie(1<<e);var c=15-e;for(r=0;r<s;++r)if(t[r])for(var u=r<<4|t[r],h=e-t[r],l=o[t[r]-1]++<<h,f=l|(1<<h)-1;l<=f;++l)a[En[l]>>c]=u}else for(a=new Ie(s),r=0;r<s;++r)t[r]&&(a[r]=En[o[t[r]-1]++]>>15-t[r]);return a},rt=new Q(288);for(var M=0;M<144;++M)rt[M]=8;for(var M=144;M<256;++M)rt[M]=9;for(var M=256;M<280;++M)rt[M]=7;for(var M=280;M<288;++M)rt[M]=8;var Di=new Q(32);for(var M=0;M<32;++M)Di[M]=5;var Nc=Ke(rt,9,1),$c=Ke(Di,5,1),Zt=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},te=function(t,e,n){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&n},Qt=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Uc=function(t){return(t+7)/8|0},zc=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Q(t.subarray(e,n))},Vc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],se=function(t,e,n){var s=new Error(e||Vc[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,se),!n)throw s;return s},Hc=function(t,e,n,s){var r=t.length,i=0;if(!r||e.f&&!e.l)return n||new Q(0);var o=!n,a=o||e.i!=2,c=e.i;o&&(n=new Q(r*3));var u=function(rs){var is=n.length;if(rs>is){var os=new Q(Math.max(is*2,rs));os.set(n),n=os}},h=e.f||0,l=e.p||0,f=e.b||0,p=e.l,d=e.d,_=e.m,g=e.n,y=r*8;do{if(!p){h=te(t,l,1);var v=te(t,l+1,3);if(l+=3,v)if(v==1)p=Nc,d=$c,_=9,g=5;else if(v==2){var S=te(t,l,31)+257,F=te(t,l+10,15)+4,N=S+te(t,l+5,31)+1;l+=14;for(var V=new Q(N),x=new Q(19),k=0;k<F;++k)x[Ic[k]]=te(t,l+k*3,7);l+=F*3;for(var Ae=Zt(x),ao=(1<<Ae)-1,co=Ke(x,Ae,1),k=0;k<N;){var Jn=co[te(t,l,ao)];l+=Jn&15;var m=Jn>>4;if(m<16)V[k++]=m;else{var Me=0,at=0;for(m==16?(at=3+te(t,l,3),l+=2,Me=V[k-1]):m==17?(at=3+te(t,l,7),l+=3):m==18&&(at=11+te(t,l,127),l+=7);at--;)V[k++]=Me}}var es=V.subarray(0,S),me=V.subarray(S);_=Zt(es),g=Zt(me),p=Ke(es,_,1),d=Ke(me,g,1)}else se(1);else{var m=Uc(l)+4,w=t[m-4]|t[m-3]<<8,P=m+w;if(P>r){c&&se(0);break}a&&u(f+w),n.set(t.subarray(m,P),f),e.b=f+=w,e.p=l=P*8,e.f=h;continue}if(l>y){c&&se(0);break}}a&&u(f+131072);for(var lo=(1<<_)-1,uo=(1<<g)-1,$t=l;;$t=l){var Me=p[Qt(t,l)&lo],Ce=Me>>4;if(l+=Me&15,l>y){c&&se(0);break}if(Me||se(2),Ce<256)n[f++]=Ce;else if(Ce==256){$t=l,p=null;break}else{var ts=Ce-254;if(Ce>264){var k=Ce-257,We=xi[k];ts=te(t,l,(1<<We)-1)+Ci[k],l+=We}var Ut=d[Qt(t,l)&uo],zt=Ut>>4;Ut||se(3),l+=Ut&15;var me=jc[zt];if(zt>3){var We=Ti[zt];me+=Qt(t,l)&(1<<We)-1,l+=We}if(l>y){c&&se(0);break}a&&u(f+131072);var ns=f+ts;if(f<me){var ss=i-me,ho=Math.min(me,ns);for(ss+f<0&&se(3);f<ho;++f)n[f]=s[ss+f]}for(;f<ns;++f)n[f]=n[f-me]}}e.l=p,e.p=$t,e.b=f,e.f=h,p&&(h=1,e.m=_,e.d=d,e.n=g)}while(!h);return f!=n.length&&o?zc(n,0,f):n.subarray(0,f)},Wc=new Q(0),Gc=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&se(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&se(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Xc(t,e){return Hc(t.subarray(Gc(t,e),-4),{i:2},e,e)}var Kc=typeof TextDecoder<"u"&&new TextDecoder,Yc=0;try{Kc.decode(Wc,{stream:!0}),Yc=1}catch{}function Li(t,e,n){const s=n.length-t-1;if(e>=n[s])return s-1;if(e<=n[t])return t;let r=t,i=s,o=Math.floor((r+i)/2);for(;e<n[o]||e>=n[o+1];)e<n[o]?i=o:r=o,o=Math.floor((r+i)/2);return o}function qc(t,e,n,s){const r=[],i=[],o=[];r[0]=1;for(let a=1;a<=n;++a){i[a]=e-s[t+1-a],o[a]=s[t+a]-e;let c=0;for(let u=0;u<a;++u){const h=o[u+1],l=i[a-u],f=r[u]/(h+l);r[u]=c+h*f,c=l*f}r[a]=c}return r}function Zc(t,e,n,s){const r=Li(t,s,e),i=qc(r,s,t,e),o=new Tt(0,0,0,0);for(let a=0;a<=t;++a){const c=n[r-t+a],u=i[a],h=c.w*u;o.x+=c.x*h,o.y+=c.y*h,o.z+=c.z*h,o.w+=c.w*u}return o}function Qc(t,e,n,s,r){const i=[];for(let l=0;l<=n;++l)i[l]=0;const o=[];for(let l=0;l<=s;++l)o[l]=i.slice(0);const a=[];for(let l=0;l<=n;++l)a[l]=i.slice(0);a[0][0]=1;const c=i.slice(0),u=i.slice(0);for(let l=1;l<=n;++l){c[l]=e-r[t+1-l],u[l]=r[t+l]-e;let f=0;for(let p=0;p<l;++p){const d=u[p+1],_=c[l-p];a[l][p]=d+_;const g=a[p][l-1]/a[l][p];a[p][l]=f+d*g,f=_*g}a[l][l]=f}for(let l=0;l<=n;++l)o[0][l]=a[l][n];for(let l=0;l<=n;++l){let f=0,p=1;const d=[];for(let _=0;_<=n;++_)d[_]=i.slice(0);d[0][0]=1;for(let _=1;_<=s;++_){let g=0;const y=l-_,v=n-_;l>=_&&(d[p][0]=d[f][0]/a[v+1][y],g=d[p][0]*a[y][v]);const m=y>=-1?1:-y,w=l-1<=v?_-1:n-l;for(let S=m;S<=w;++S)d[p][S]=(d[f][S]-d[f][S-1])/a[v+1][y+S],g+=d[p][S]*a[y+S][v];l<=v&&(d[p][_]=-d[f][_-1]/a[v+1][l],g+=d[p][_]*a[l][v]),o[_][l]=g;const P=f;f=p,p=P}}let h=n;for(let l=1;l<=s;++l){for(let f=0;f<=n;++f)o[l][f]*=h;h*=n-l}return o}function Jc(t,e,n,s,r){const i=r<t?r:t,o=[],a=Li(t,s,e),c=Qc(a,s,t,i,e),u=[];for(let h=0;h<n.length;++h){const l=n[h].clone(),f=l.w;l.x*=f,l.y*=f,l.z*=f,u[h]=l}for(let h=0;h<=i;++h){const l=u[a-t].clone().multiplyScalar(c[h][0]);for(let f=1;f<=t;++f)l.add(u[a-t+f].clone().multiplyScalar(c[h][f]));o[h]=l}for(let h=i+1;h<=r+1;++h)o[h]=new Tt(0,0,0);return o}function el(t,e){let n=1;for(let r=2;r<=t;++r)n*=r;let s=1;for(let r=2;r<=e;++r)s*=r;for(let r=2;r<=t-e;++r)s*=r;return n/s}function tl(t){const e=t.length,n=[],s=[];for(let i=0;i<e;++i){const o=t[i];n[i]=new L(o.x,o.y,o.z),s[i]=o.w}const r=[];for(let i=0;i<e;++i){const o=n[i].clone();for(let a=1;a<=i;++a)o.sub(r[i-a].clone().multiplyScalar(el(i,a)*s[a]));r[i]=o.divideScalar(s[0])}return r}function nl(t,e,n,s,r){const i=Jc(t,e,n,s,r);return tl(i)}class sl extends yo{constructor(e,n,s,r,i){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(let o=0;o<s.length;++o){const a=s[o];this.controlPoints[o]=new Tt(a.x,a.y,a.z,a.w)}}getPoint(e,n=new L){const s=n,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=Zc(this.degree,this.knots,this.controlPoints,r);return i.w!==1&&i.divideScalar(i.w),s.set(i.x,i.y,i.z)}getTangent(e,n=new L){const s=n,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=nl(this.degree,this.knots,this.controlPoints,r,1);return s.copy(i[1]).normalize(),s}}let b,R,z;class rl extends an{constructor(e){super(e)}load(e,n,s,r){const i=this,o=i.path===""?vo.extractUrlBase(e):i.path,a=new wo(this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(c){try{n(i.parse(c,o))}catch(u){r?r(u):console.error(u),i.manager.itemError(e)}},s,r)}parse(e,n){if(ul(e))b=new ll().parse(e);else{const r=Ii(e);if(!hl(r))throw new Error("THREE.FBXLoader: Unknown format.");if(Ks(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Ks(r));b=new cl().parse(r)}const s=new Ve(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new il(s,this.manager).parse(b)}}class il{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){R=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),s=this.parseMaterials(n),r=this.parseDeformers(),i=new ol().parse(r);return this.parseScene(r,i,s),z}parseConnections(){const e=new Map;return"Connections"in b&&b.Connections.connections.forEach(function(s){const r=s[0],i=s[1],o=s[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:i,relationship:o};e.get(r).parents.push(a),e.has(i)||e.set(i,{parents:[],children:[]});const c={ID:r,relationship:o};e.get(i).children.push(c)}),e}parseImages(){const e={},n={};if("Video"in b.Objects){const s=b.Objects.Video;for(const r in s){const i=s[r],o=parseInt(r);if(e[o]=i.RelativeFilename||i.Filename,"Content"in i){const a=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,c=typeof i.Content=="string"&&i.Content!=="";if(a||c){const u=this.parseImage(s[r]);n[i.RelativeFilename||i.Filename]=u}}}}for(const s in e){const r=e[s];n[r]!==void 0?e[s]=n[r]:e[s]=e[s].split("\\").pop()}return e}parseImage(e){const n=e.Content,s=e.RelativeFilename||e.Filename,r=s.slice(s.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",s),i="image/tga";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof n=="string")return"data:"+i+";base64,"+n;{const o=new Uint8Array(n);return window.URL.createObjectURL(new Blob([o],{type:i}))}}parseTextures(e){const n=new Map;if("Texture"in b.Objects){const s=b.Objects.Texture;for(const r in s){const i=this.parseTexture(s[r],e);n.set(parseInt(r),i)}}return n}parseTexture(e,n){const s=this.loadTexture(e,n);s.ID=e.id,s.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,o=r!==void 0?r.value:0,a=i!==void 0?i.value:0;if(s.wrapS=o===0?cs:ls,s.wrapT=a===0?cs:ls,"Scaling"in e){const c=e.Scaling.value;s.repeat.x=c[0],s.repeat.y=c[1]}if("Translation"in e){const c=e.Translation.value;s.offset.x=c[0],s.offset.y=c[1]}return s}loadTexture(e,n){const s=new Set(["tga","tif","tiff","exr","dds","hdr","ktx2"]),r=e.FileName.split(".").pop().toLowerCase(),i=s.has(r)?this.manager.getHandler(`.${r}`):this.textureLoader;if(!i)return console.warn(`FBXLoader: ${r.toUpperCase()} loader not found, creating placeholder texture for`,e.RelativeFilename),new bo;const o=i.path;o||i.setPath(this.textureLoader.path);const a=R.get(e.id).children;let c;a!==void 0&&a.length>0&&n[a[0].ID]!==void 0&&(c=n[a[0].ID],(c.indexOf("blob:")===0||c.indexOf("data:")===0)&&i.setPath(void 0));const u=i.load(c);return i.setPath(o),u}parseMaterials(e){const n=new Map;if("Material"in b.Objects){const s=b.Objects.Material;for(const r in s){const i=this.parseMaterial(s[r],e);i!==null&&n.set(parseInt(r),i)}}return n}parseMaterial(e,n){const s=e.id,r=e.attrName;let i=e.ShadingModel;if(typeof i=="object"&&(i=i.value),!R.has(s))return null;const o=this.parseParameters(e,n,s);let a;switch(i.toLowerCase()){case"phong":a=new Vt;break;case"lambert":a=new Eo;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),a=new Vt;break}return a.setValues(o),a.name=r,a}parseParameters(e,n,s){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=new $().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=new $().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=new $().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=new $().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=new $().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=new $().fromArray(e.SpecularColor.value).convertSRGBToLinear());const i=this;return R.get(s).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=i.getTexture(n,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(n,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(n,o.ID),r.map!==void 0&&(r.map.colorSpace=J);break;case"DisplacementColor":r.displacementMap=i.getTexture(n,o.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(n,o.ID),r.emissiveMap!==void 0&&(r.emissiveMap.colorSpace=J);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(n,o.ID);break;case"ReflectionColor":r.envMap=i.getTexture(n,o.ID),r.envMap!==void 0&&(r.envMap.mapping=So,r.envMap.colorSpace=J);break;case"SpecularColor":r.specularMap=i.getTexture(n,o.ID),r.specularMap!==void 0&&(r.specularMap.colorSpace=J);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(n,o.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),r}getTexture(e,n){return"LayeredTexture"in b.Objects&&n in b.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=R.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in b.Objects){const s=b.Objects.Deformer;for(const r in s){const i=s[r],o=R.get(parseInt(r));if(i.attrType==="Skin"){const a=this.parseSkeleton(o,s);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if(i.attrType==="BlendShape"){const a={id:r};a.rawTargets=this.parseMorphTargets(o,s),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[r]=a}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const s=[];return e.children.forEach(function(r){const i=n[r.ID];if(i.attrType!=="Cluster")return;const o={ID:r.ID,indices:[],weights:[],transformLink:new O().fromArray(i.TransformLink.a)};"Indexes"in i&&(o.indices=i.Indexes.a,o.weights=i.Weights.a),s.push(o)}),{rawBones:s,bones:[]}}parseMorphTargets(e,n){const s=[];for(let r=0;r<e.children.length;r++){const i=e.children[r],o=n[i.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;a.geoID=R.get(parseInt(i.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,s.push(a)}return s}parseScene(e,n,s){z=new us;const r=this.parseModels(e.skeletons,n,s),i=b.Objects.Model,o=this;r.forEach(function(c){const u=i[c.ID];o.setLookAtProperties(c,u),R.get(c.ID).parents.forEach(function(l){const f=r.get(l.ID);f!==void 0&&f.add(c)}),c.parent===null&&z.add(c)}),this.bindSkeleton(e.skeletons,n,r),this.addGlobalSceneSettings(),z.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const u=Oi(c.userData.transformData);c.applyMatrix4(u),c.updateWorldMatrix()}});const a=new al().parse();z.children.length===1&&z.children[0].isGroup&&(z.children[0].animations=a,z=z.children[0]),z.animations=a}parseModels(e,n,s){const r=new Map,i=b.Objects.Model;for(const o in i){const a=parseInt(o),c=i[o],u=R.get(a);let h=this.buildSkeleton(u,e,a,c.attrName);if(!h){switch(c.attrType){case"Camera":h=this.createCamera(u);break;case"Light":h=this.createLight(u);break;case"Mesh":h=this.createMesh(u,n,s);break;case"NurbsCurve":h=this.createCurve(u,n);break;case"LimbNode":case"Root":h=new hs;break;case"Null":default:h=new us;break}h.name=c.attrName?yt.sanitizeNodeName(c.attrName):"",h.userData.originalName=c.attrName,h.ID=a}this.getTransformData(h,c),r.set(a,h)}return r}buildSkeleton(e,n,s,r){let i=null;return e.parents.forEach(function(o){for(const a in n){const c=n[a];c.rawBones.forEach(function(u,h){if(u.ID===o.ID){const l=i;i=new hs,i.matrixWorld.copy(u.transformLink),i.name=r?yt.sanitizeNodeName(r):"",i.userData.originalName=r,i.ID=s,c.bones[h]=i,l!==null&&i.add(l)}})}}),i}createCamera(e){let n,s;if(e.children.forEach(function(r){const i=b.Objects.NodeAttribute[r.ID];i!==void 0&&(s=i)}),s===void 0)n=new Ht;else{let r=0;s.CameraProjectionType!==void 0&&s.CameraProjectionType.value===1&&(r=1);let i=1;s.NearPlane!==void 0&&(i=s.NearPlane.value/1e3);let o=1e3;s.FarPlane!==void 0&&(o=s.FarPlane.value/1e3);let a=window.innerWidth,c=window.innerHeight;s.AspectWidth!==void 0&&s.AspectHeight!==void 0&&(a=s.AspectWidth.value,c=s.AspectHeight.value);const u=a/c;let h=45;s.FieldOfView!==void 0&&(h=s.FieldOfView.value);const l=s.FocalLength?s.FocalLength.value:null;switch(r){case 0:n=new _r(h,u,i,o),l!==null&&n.setFocalLength(l);break;case 1:n=new mr(-a/2,a/2,c/2,-c/2,i,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),n=new Ht;break}}return n}createLight(e){let n,s;if(e.children.forEach(function(r){const i=b.Objects.NodeAttribute[r.ID];i!==void 0&&(s=i)}),s===void 0)n=new Ht;else{let r;s.LightType===void 0?r=0:r=s.LightType.value;let i=16777215;s.Color!==void 0&&(i=new $().fromArray(s.Color.value).convertSRGBToLinear());let o=s.Intensity===void 0?1:s.Intensity.value/100;s.CastLightOnObject!==void 0&&s.CastLightOnObject.value===0&&(o=0);let a=0;s.FarAttenuationEnd!==void 0&&(s.EnableFarAttenuation!==void 0&&s.EnableFarAttenuation.value===0?a=0:a=s.FarAttenuationEnd.value);const c=1;switch(r){case 0:n=new cn(i,o,a,c);break;case 1:n=new gr(i,o);break;case 2:let u=Math.PI/3;s.InnerAngle!==void 0&&(u=U.degToRad(s.InnerAngle.value));let h=0;s.OuterAngle!==void 0&&(h=U.degToRad(s.OuterAngle.value),h=Math.max(h,1)),n=new Po(i,o,a,u,h,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+s.LightType.value+", defaulting to a PointLight."),n=new cn(i,o);break}s.CastShadows!==void 0&&s.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,s){let r,i=null,o=null;const a=[];return e.children.forEach(function(c){n.has(c.ID)&&(i=n.get(c.ID)),s.has(c.ID)&&a.push(s.get(c.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new Vt({name:an.DEFAULT_MATERIAL_NAME,color:13421772}),a.push(o)),"color"in i.attributes&&a.forEach(function(c){c.vertexColors=!0}),i.FBX_Deformer?(r=new xo(i,o),r.normalizeSkinWeights()):r=new yr(i,o),r}createCurve(e,n){const s=e.children.reduce(function(i,o){return n.has(o.ID)&&(i=n.get(o.ID)),i},null),r=new To({name:an.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Ao(s,r)}getTransformData(e,n){const s={};"InheritType"in n&&(s.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?s.eulerOrder=Ri(n.RotationOrder.value):s.eulerOrder="ZYX","Lcl_Translation"in n&&(s.translation=n.Lcl_Translation.value),"PreRotation"in n&&(s.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(s.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(s.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(s.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(s.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(s.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(s.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(s.rotationPivot=n.RotationPivot.value),e.userData.transformData=s}setLookAtProperties(e,n){"LookAtProperty"in n&&R.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const i=b.Objects.Model[r.ID];if("Lcl_Translation"in i){const o=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),z.add(e.target)):e.lookAt(new L().fromArray(o))}}})}bindSkeleton(e,n,s){const r=this.parsePoseNodes();for(const i in e){const o=e[i];R.get(parseInt(o.ID)).parents.forEach(function(c){if(n.has(c.ID)){const u=c.ID;R.get(u).parents.forEach(function(l){s.has(l.ID)&&s.get(l.ID).bind(new Mo(o.bones),r[l.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in b.Objects){const n=b.Objects.Pose;for(const s in n)if(n[s].attrType==="BindPose"&&n[s].NbPoseNodes>0){const r=n[s].PoseNode;Array.isArray(r)?r.forEach(function(i){e[i.Node]=new O().fromArray(i.Matrix.a)}):e[r.Node]=new O().fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in b){if("AmbientColor"in b.GlobalSettings){const e=b.GlobalSettings.AmbientColor.value,n=e[0],s=e[1],r=e[2];if(n!==0||s!==0||r!==0){const i=new $(n,s,r).convertSRGBToLinear();z.add(new vr(i,1))}}"UnitScaleFactor"in b.GlobalSettings&&(z.userData.unitScaleFactor=b.GlobalSettings.UnitScaleFactor.value)}}}class ol{constructor(){this.negativeMaterialIndices=!1}parse(e){const n=new Map;if("Geometry"in b.Objects){const s=b.Objects.Geometry;for(const r in s){const i=R.get(parseInt(r)),o=this.parseGeometry(i,s[r],e);n.set(parseInt(r),o)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),n}parseGeometry(e,n,s){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,s);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,s){const r=s.skeletons,i=[],o=e.parents.map(function(l){return b.Objects.Model[l.ID]});if(o.length===0)return;const a=e.children.reduce(function(l,f){return r[f.ID]!==void 0&&(l=r[f.ID]),l},null);e.children.forEach(function(l){s.morphTargets[l.ID]!==void 0&&i.push(s.morphTargets[l.ID])});const c=o[0],u={};"RotationOrder"in c&&(u.eulerOrder=Ri(c.RotationOrder.value)),"InheritType"in c&&(u.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(u.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(u.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(u.scale=c.GeometricScaling.value);const h=Oi(u);return this.genGeometry(n,a,i,h)}genGeometry(e,n,s,r){const i=new dt;e.attrName&&(i.name=e.attrName);const o=this.parseGeoNode(e,n),a=this.genBuffers(o),c=new ge(a.vertex,3);if(c.applyMatrix4(r),i.setAttribute("position",c),a.colors.length>0&&i.setAttribute("color",new ge(a.colors,3)),n&&(i.setAttribute("skinIndex",new Co(a.weightsIndices,4)),i.setAttribute("skinWeight",new ge(a.vertexWeights,4)),i.FBX_Deformer=n),a.normal.length>0){const u=new Do().getNormalMatrix(r),h=new ge(a.normal,3);h.applyNormalMatrix(u),i.setAttribute("normal",h)}if(a.uvs.forEach(function(u,h){const l=h===0?"uv":`uv${h}`;i.setAttribute(l,new ge(a.uvs[h],2))}),o.material&&o.material.mappingType!=="AllSame"){let u=a.materialIndex[0],h=0;if(a.materialIndex.forEach(function(l,f){l!==u&&(i.addGroup(h,f-h,u),u=l,h=f)}),i.groups.length>0){const l=i.groups[i.groups.length-1],f=l.start+l.count;f!==a.materialIndex.length&&i.addGroup(f,a.materialIndex.length-f,u)}i.groups.length===0&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,e,s,r),i}parseGeoNode(e,n){const s={};if(s.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],s.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(s.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(s.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(s.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){s.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&s.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return s.weightTable={},n!==null&&(s.skeleton=n,n.rawBones.forEach(function(r,i){r.indices.forEach(function(o,a){s.weightTable[o]===void 0&&(s.weightTable[o]=[]),s.weightTable[o].push({id:i,weight:r.weights[a]})})})),s}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let s=0,r=0,i=!1,o=[],a=[],c=[],u=[],h=[],l=[];const f=this;return e.vertexIndices.forEach(function(p,d){let _,g=!1;p<0&&(p=p^-1,g=!0);let y=[],v=[];if(o.push(p*3,p*3+1,p*3+2),e.color){const m=ut(d,s,p,e.color);c.push(m[0],m[1],m[2])}if(e.skeleton){if(e.weightTable[p]!==void 0&&e.weightTable[p].forEach(function(m){v.push(m.weight),y.push(m.id)}),v.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const m=[0,0,0,0],w=[0,0,0,0];v.forEach(function(P,S){let F=P,N=y[S];w.forEach(function(V,x,k){if(F>V){k[x]=F,F=V;const Ae=m[x];m[x]=N,N=Ae}})}),y=m,v=w}for(;v.length<4;)v.push(0),y.push(0);for(let m=0;m<4;++m)h.push(v[m]),l.push(y[m])}if(e.normal){const m=ut(d,s,p,e.normal);a.push(m[0],m[1],m[2])}e.material&&e.material.mappingType!=="AllSame"&&(_=ut(d,s,p,e.material)[0],_<0&&(f.negativeMaterialIndices=!0,_=0)),e.uv&&e.uv.forEach(function(m,w){const P=ut(d,s,p,m);u[w]===void 0&&(u[w]=[]),u[w].push(P[0]),u[w].push(P[1])}),r++,g&&(f.genFace(n,e,o,_,a,c,u,h,l,r),s++,r=0,o=[],a=[],c=[],u=[],h=[],l=[])}),n}getNormalNewell(e){const n=new L(0,0,0);for(let s=0;s<e.length;s++){const r=e[s],i=e[(s+1)%e.length];n.x+=(r.y-i.y)*(r.z+i.z),n.y+=(r.z-i.z)*(r.x+i.x),n.z+=(r.x-i.x)*(r.y+i.y)}return n.normalize(),n}getNormalTangentAndBitangent(e){const n=this.getNormalNewell(e),r=(Math.abs(n.z)>.5?new L(0,1,0):new L(0,0,1)).cross(n).normalize(),i=n.clone().cross(r).normalize();return{normal:n,tangent:r,bitangent:i}}flattenVertex(e,n,s){return new j(e.dot(n),e.dot(s))}genFace(e,n,s,r,i,o,a,c,u,h){let l;if(h>3){const f=[],p=n.baseVertexPositions||n.vertexPositions;for(let y=0;y<s.length;y+=3)f.push(new L(p[s[y]],p[s[y+1]],p[s[y+2]]));const{tangent:d,bitangent:_}=this.getNormalTangentAndBitangent(f),g=[];for(const y of f)g.push(this.flattenVertex(y,d,_));l=Lo.triangulateShape(g,[])}else l=[[0,1,2]];for(const[f,p,d]of l)e.vertex.push(n.vertexPositions[s[f*3]]),e.vertex.push(n.vertexPositions[s[f*3+1]]),e.vertex.push(n.vertexPositions[s[f*3+2]]),e.vertex.push(n.vertexPositions[s[p*3]]),e.vertex.push(n.vertexPositions[s[p*3+1]]),e.vertex.push(n.vertexPositions[s[p*3+2]]),e.vertex.push(n.vertexPositions[s[d*3]]),e.vertex.push(n.vertexPositions[s[d*3+1]]),e.vertex.push(n.vertexPositions[s[d*3+2]]),n.skeleton&&(e.vertexWeights.push(c[f*4]),e.vertexWeights.push(c[f*4+1]),e.vertexWeights.push(c[f*4+2]),e.vertexWeights.push(c[f*4+3]),e.vertexWeights.push(c[p*4]),e.vertexWeights.push(c[p*4+1]),e.vertexWeights.push(c[p*4+2]),e.vertexWeights.push(c[p*4+3]),e.vertexWeights.push(c[d*4]),e.vertexWeights.push(c[d*4+1]),e.vertexWeights.push(c[d*4+2]),e.vertexWeights.push(c[d*4+3]),e.weightsIndices.push(u[f*4]),e.weightsIndices.push(u[f*4+1]),e.weightsIndices.push(u[f*4+2]),e.weightsIndices.push(u[f*4+3]),e.weightsIndices.push(u[p*4]),e.weightsIndices.push(u[p*4+1]),e.weightsIndices.push(u[p*4+2]),e.weightsIndices.push(u[p*4+3]),e.weightsIndices.push(u[d*4]),e.weightsIndices.push(u[d*4+1]),e.weightsIndices.push(u[d*4+2]),e.weightsIndices.push(u[d*4+3])),n.color&&(e.colors.push(o[f*3]),e.colors.push(o[f*3+1]),e.colors.push(o[f*3+2]),e.colors.push(o[p*3]),e.colors.push(o[p*3+1]),e.colors.push(o[p*3+2]),e.colors.push(o[d*3]),e.colors.push(o[d*3+1]),e.colors.push(o[d*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),n.normal&&(e.normal.push(i[f*3]),e.normal.push(i[f*3+1]),e.normal.push(i[f*3+2]),e.normal.push(i[p*3]),e.normal.push(i[p*3+1]),e.normal.push(i[p*3+2]),e.normal.push(i[d*3]),e.normal.push(i[d*3+1]),e.normal.push(i[d*3+2])),n.uv&&n.uv.forEach(function(_,g){e.uvs[g]===void 0&&(e.uvs[g]=[]),e.uvs[g].push(a[g][f*2]),e.uvs[g].push(a[g][f*2+1]),e.uvs[g].push(a[g][p*2]),e.uvs[g].push(a[g][p*2+1]),e.uvs[g].push(a[g][d*2]),e.uvs[g].push(a[g][d*2+1])})}addMorphTargets(e,n,s,r){if(s.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const i=this;s.forEach(function(o){o.rawTargets.forEach(function(a){const c=b.Objects.Geometry[a.geoID];c!==void 0&&i.genMorphGeometry(e,n,c,r,a.name)})})}genMorphGeometry(e,n,s,r,i){const o=n.Vertices!==void 0?n.Vertices.a:[],a=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],c=s.Vertices!==void 0?s.Vertices.a:[],u=s.Indexes!==void 0?s.Indexes.a:[],h=e.attributes.position.count*3,l=new Float32Array(h);for(let _=0;_<u.length;_++){const g=u[_]*3;l[g]=c[_*3],l[g+1]=c[_*3+1],l[g+2]=c[_*3+2]}const f={vertexIndices:a,vertexPositions:l,baseVertexPositions:o},p=this.genBuffers(f),d=new ge(p.vertex,3);d.name=i||s.attrName,d.applyMatrix4(r),e.morphAttributes.position.push(d)}parseNormals(e){const n=e.MappingInformationType,s=e.ReferenceInformationType,r=e.Normals.a;let i=[];return s==="IndexToDirect"&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:n,referenceType:s}}parseUVs(e){const n=e.MappingInformationType,s=e.ReferenceInformationType,r=e.UV.a;let i=[];return s==="IndexToDirect"&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:n,referenceType:s}}parseVertexColors(e){const n=e.MappingInformationType,s=e.ReferenceInformationType,r=e.Colors.a;let i=[];s==="IndexToDirect"&&(i=e.ColorIndex.a);for(let o=0,a=new $;o<r.length;o+=4)a.fromArray(r,o).convertSRGBToLinear().toArray(r,o);return{dataSize:4,buffer:r,indices:i,mappingType:n,referenceType:s}}parseMaterialIndices(e){const n=e.MappingInformationType,s=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:s};const r=e.Materials.a,i=[];for(let o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:n,referenceType:s}}parseNurbsGeometry(e){const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new dt;const s=n-1,r=e.KnotVector.a,i=[],o=e.Points.a;for(let l=0,f=o.length;l<f;l+=4)i.push(new Tt().fromArray(o,l));let a,c;if(e.Form==="Closed")i.push(i[0]);else if(e.Form==="Periodic"){a=s,c=r.length-1-a;for(let l=0;l<s;++l)i.push(i[l])}const h=new sl(s,r,i,a,c).getPoints(i.length*12);return new dt().setFromPoints(h)}}class al{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const s in n){const r=n[s],i=this.addClip(r);e.push(i)}return e}parseClips(){if(b.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=b.Objects.AnimationCurveNode,n=new Map;for(const s in e){const r=e[s];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const i={id:r.id,attr:r.attrName,curves:{}};n.set(i.id,i)}}return n}parseAnimationCurves(e){const n=b.Objects.AnimationCurve;for(const s in n){const r={id:n[s].id,times:n[s].KeyTime.a.map(fl),values:n[s].KeyValueFloat.a},i=R.get(r.id);if(i!==void 0){const o=i.parents[0].ID,a=i.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const n=b.Objects.AnimationLayer,s=new Map;for(const r in n){const i=[],o=R.get(parseInt(r));o!==void 0&&(o.children.forEach(function(c,u){if(e.has(c.ID)){const h=e.get(c.ID);if(h.curves.x!==void 0||h.curves.y!==void 0||h.curves.z!==void 0){if(i[u]===void 0){const l=R.get(c.ID).parents.filter(function(f){return f.relationship!==void 0})[0].ID;if(l!==void 0){const f=b.Objects.Model[l.toString()];if(f===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",c);return}const p={modelName:f.attrName?yt.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};z.traverse(function(d){d.ID===f.id&&(p.transform=d.matrix,d.userData.transformData&&(p.eulerOrder=d.userData.transformData.eulerOrder))}),p.transform||(p.transform=new O),"PreRotation"in f&&(p.preRotation=f.PreRotation.value),"PostRotation"in f&&(p.postRotation=f.PostRotation.value),i[u]=p}}i[u]&&(i[u][h.attr]=h)}else if(h.curves.morph!==void 0){if(i[u]===void 0){const l=R.get(c.ID).parents.filter(function(y){return y.relationship!==void 0})[0].ID,f=R.get(l).parents[0].ID,p=R.get(f).parents[0].ID,d=R.get(p).parents[0].ID,_=b.Objects.Model[d],g={modelName:_.attrName?yt.sanitizeNodeName(_.attrName):"",morphName:b.Objects.Deformer[l].attrName};i[u]=g}i[u][h.attr]=h}}}),s.set(parseInt(r),i))}return s}parseAnimStacks(e){const n=b.Objects.AnimationStack,s={};for(const r in n){const i=R.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(i[0].ID);s[r]={name:n[r].attrName,layer:o}}return s}addClip(e){let n=[];const s=this;return e.layer.forEach(function(r){n=n.concat(s.generateTracks(r))}),new wr(e.name,-1,n)}generateTracks(e){const n=[];let s=new L,r=new L;if(e.transform&&e.transform.decompose(s,new ae,r),s=s.toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.T.curves,s,"position");i!==void 0&&n.push(i)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const i=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);i!==void 0&&n.push(i)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");i!==void 0&&n.push(i)}if(e.DeformPercent!==void 0){const i=this.generateMorphTrack(e);i!==void 0&&n.push(i)}return n}generateVectorTrack(e,n,s,r){const i=this.getTimesForAllAxes(n),o=this.getKeyframeTrackValues(i,n,s);return new ko(e+"."+r,i,o)}generateRotationTrack(e,n,s,r,i){let o,a;if(n.x!==void 0&&n.y!==void 0&&n.z!==void 0){const l=this.interpolateRotations(n.x,n.y,n.z,i);o=l[0],a=l[1]}s!==void 0&&(s=s.map(U.degToRad),s.push(i),s=new ce().fromArray(s),s=new ae().setFromEuler(s)),r!==void 0&&(r=r.map(U.degToRad),r.push(i),r=new ce().fromArray(r),r=new ae().setFromEuler(r).invert());const c=new ae,u=new ce,h=[];if(!a||!o)return new fs(e+".quaternion",[0],[0]);for(let l=0;l<a.length;l+=3)u.set(a[l],a[l+1],a[l+2],i),c.setFromEuler(u),s!==void 0&&c.premultiply(s),r!==void 0&&c.multiply(r),l>2&&new ae().fromArray(h,(l-3)/3*4).dot(c)<0&&c.set(-c.x,-c.y,-c.z,-c.w),c.toArray(h,l/3*4);return new fs(e+".quaternion",o,h)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,s=n.values.map(function(i){return i/100}),r=z.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Oo(e.modelName+".morphTargetInfluences["+r+"]",n.times,s)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(s,r){return s-r}),n.length>1){let s=1,r=n[0];for(let i=1;i<n.length;i++){const o=n[i];o!==r&&(n[s]=o,r=o,s++)}n=n.slice(0,s)}return n}getKeyframeTrackValues(e,n,s){const r=s,i=[];let o=-1,a=-1,c=-1;return e.forEach(function(u){if(n.x&&(o=n.x.times.indexOf(u)),n.y&&(a=n.y.times.indexOf(u)),n.z&&(c=n.z.times.indexOf(u)),o!==-1){const h=n.x.values[o];i.push(h),r[0]=h}else i.push(r[0]);if(a!==-1){const h=n.y.values[a];i.push(h),r[1]=h}else i.push(r[1]);if(c!==-1){const h=n.z.values[c];i.push(h),r[2]=h}else i.push(r[2])}),i}interpolateRotations(e,n,s,r){const i=[],o=[];i.push(e.times[0]),o.push(U.degToRad(e.values[0])),o.push(U.degToRad(n.values[0])),o.push(U.degToRad(s.values[0]));for(let a=1;a<e.values.length;a++){const c=[e.values[a-1],n.values[a-1],s.values[a-1]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const u=c.map(U.degToRad),h=[e.values[a],n.values[a],s.values[a]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const l=h.map(U.degToRad),f=[h[0]-c[0],h[1]-c[1],h[2]-c[2]],p=[Math.abs(f[0]),Math.abs(f[1]),Math.abs(f[2])];if(p[0]>=180||p[1]>=180||p[2]>=180){const _=Math.max(...p)/180,g=new ce(...u,r),y=new ce(...l,r),v=new ae().setFromEuler(g),m=new ae().setFromEuler(y);v.dot(m)&&m.set(-m.x,-m.y,-m.z,-m.w);const w=e.times[a-1],P=e.times[a]-w,S=new ae,F=new ce;for(let N=0;N<1;N+=1/_)S.copy(v.clone().slerp(m.clone(),N)),i.push(w+N*P),F.setFromQuaternion(S,r),o.push(F.x),o.push(F.y),o.push(F.z)}else i.push(e.times[a]),o.push(U.degToRad(e.values[a])),o.push(U.degToRad(n.values[a])),o.push(U.degToRad(s.values[a]))}return[i,o]}}class cl{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new ki,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,s=e.split(/[\r\n]+/);return s.forEach(function(r,i){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const c=r.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),u=r.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),h=r.match("^\\t{"+(n.currentIndent-1)+"}}");c?n.parseNodeBegin(r,c):u?n.parseNodeProperty(r,u,s[++i]):h?n.popStack():r.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,n){const s=n[1].trim().replace(/^"/,"").replace(/"$/,""),r=n[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:s},o=this.parseNodeAttr(r),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(s,i):s in a?(s==="PoseNode"?a.PoseNode.push(i):a[s].id!==void 0&&(a[s]={},a[s][a[s].id]=a[s]),o.id!==""&&(a[s][o.id]=i)):typeof o.id=="number"?(a[s]={},a[s][o.id]=i):s!=="Properties70"&&(s==="PoseNode"?a[s]=[i]:a[s]=i),typeof o.id=="number"&&(i.id=o.id),o.name!==""&&(i.attrName=o.name),o.type!==""&&(i.attrType=o.type),this.pushStack(i)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let s="",r="";return e.length>1&&(s=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:n,name:s,type:r}}parseNodeProperty(e,n,s){let r=n[1].replace(/^"/,"").replace(/"$/,"").trim(),i=n[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&i===","&&(i=s.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,r,i);return}if(r==="C"){const c=i.split(",").slice(1),u=parseInt(c[0]),h=parseInt(c[1]);let l=i.split(",").slice(3);l=l.map(function(f){return f.trim().replace(/^"/,"")}),r="connections",i=[u,h],dl(i,l),o[r]===void 0&&(o[r]=[])}r==="Node"&&(o.id=i),r in o&&Array.isArray(o[r])?o[r].push(i):r!=="a"?o[r]=i:o.a=i,this.setCurrentProp(o,r),r==="a"&&i.slice(-1)!==","&&(o.a=en(i))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=en(n.a))}parseNodeSpecialProperty(e,n,s){const r=s.split('",').map(function(h){return h.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],o=r[1],a=r[2],c=r[3];let u=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=en(u);break}this.getPrevNode()[i]={type:o,type2:a,flag:c,value:u},this.setCurrentProp(this.getPrevNode(),i)}}class ll{parse(e){const n=new Xs(e);n.skip(23);const s=n.getUint32();if(s<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+s);const r=new ki;for(;!this.endOfContent(n);){const i=this.parseNode(n,s);i!==null&&r.add(i.name,i)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const s={},r=n>=7500?e.getUint64():e.getUint32(),i=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(r===0)return null;const c=[];for(let f=0;f<i;f++)c.push(this.parseProperty(e));const u=c.length>0?c[0]:"",h=c.length>1?c[1]:"",l=c.length>2?c[2]:"";for(s.singleProperty=i===1&&e.getOffset()===r;r>e.getOffset();){const f=this.parseNode(e,n);f!==null&&this.parseSubNode(a,s,f)}return s.propertyList=c,typeof u=="number"&&(s.id=u),h!==""&&(s.attrName=h),l!==""&&(s.attrType=l),a!==""&&(s.name=a),s}parseSubNode(e,n,s){if(s.singleProperty===!0){const r=s.propertyList[0];Array.isArray(r)?(n[s.name]=s,s.a=r):n[s.name]=r}else if(e==="Connections"&&s.name==="C"){const r=[];s.propertyList.forEach(function(i,o){o!==0&&r.push(i)}),n.connections===void 0&&(n.connections=[]),n.connections.push(r)}else if(s.name==="Properties70")Object.keys(s).forEach(function(i){n[i]=s[i]});else if(e==="Properties70"&&s.name==="P"){let r=s.propertyList[0],i=s.propertyList[1];const o=s.propertyList[2],a=s.propertyList[3];let c;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),i==="Color"||i==="ColorRGB"||i==="Vector"||i==="Vector3D"||i.indexOf("Lcl_")===0?c=[s.propertyList[4],s.propertyList[5],s.propertyList[6]]:c=s.propertyList[4],n[r]={type:i,type2:o,flag:a,value:c}}else n[s.name]===void 0?typeof s.id=="number"?(n[s.name]={},n[s.name][s.id]=s):n[s.name]=s:s.name==="PoseNode"?(Array.isArray(n[s.name])||(n[s.name]=[n[s.name]]),n[s.name].push(s)):n[s.name][s.id]===void 0&&(n[s.name][s.id]=s)}parseProperty(e){const n=e.getString(1);let s;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return s=e.getUint32(),e.getArrayBuffer(s);case"S":return s=e.getUint32(),e.getString(s);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),i=e.getUint32(),o=e.getUint32();if(i===0)switch(n){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=Xc(new Uint8Array(e.getArrayBuffer(o))),c=new Xs(a.buffer);switch(n){case"b":case"c":return c.getBooleanArray(r);case"d":return c.getFloat64Array(r);case"f":return c.getFloat32Array(r);case"i":return c.getInt32Array(r);case"l":return c.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class Xs{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let s=0;s<e;s++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let s=0;s<e;s++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let s=0;s<e;s++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let s=0;s<e;s++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let s=0;s<e;s++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){const n=this.offset;let s=new Uint8Array(this.dv.buffer,n,e);this.skip(e);const r=s.indexOf(0);return r>=0&&(s=new Uint8Array(this.dv.buffer,n,r)),this._textDecoder.decode(s)}}class ki{add(e,n){this[e]=n}}function ul(t){const e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===Ii(t,0,e.length)}function hl(t){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function s(r){const i=t[r-1];return t=t.slice(n+r),n++,i}for(let r=0;r<e.length;++r)if(s(1)===e[r])return!1;return!0}function Ks(t){const e=/FBXVersion: (\d+)/,n=t.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function fl(t){return t/46186158e3}const pl=[];function ut(t,e,n,s){let r;switch(s.mappingType){case"ByPolygonVertex":r=t;break;case"ByPolygon":r=e;break;case"ByVertice":r=n;break;case"AllSame":r=s.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+s.mappingType)}s.referenceType==="IndexToDirect"&&(r=s.indices[r]);const i=r*s.dataSize,o=i+s.dataSize;return ml(pl,s.buffer,i,o)}const Jt=new ce,De=new L;function Oi(t){const e=new O,n=new O,s=new O,r=new O,i=new O,o=new O,a=new O,c=new O,u=new O,h=new O,l=new O,f=new O,p=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(De.fromArray(t.translation)),t.preRotation){const x=t.preRotation.map(U.degToRad);x.push(t.eulerOrder||ce.DEFAULT_ORDER),n.makeRotationFromEuler(Jt.fromArray(x))}if(t.rotation){const x=t.rotation.map(U.degToRad);x.push(t.eulerOrder||ce.DEFAULT_ORDER),s.makeRotationFromEuler(Jt.fromArray(x))}if(t.postRotation){const x=t.postRotation.map(U.degToRad);x.push(t.eulerOrder||ce.DEFAULT_ORDER),r.makeRotationFromEuler(Jt.fromArray(x)),r.invert()}t.scale&&i.scale(De.fromArray(t.scale)),t.scalingOffset&&a.setPosition(De.fromArray(t.scalingOffset)),t.scalingPivot&&o.setPosition(De.fromArray(t.scalingPivot)),t.rotationOffset&&c.setPosition(De.fromArray(t.rotationOffset)),t.rotationPivot&&u.setPosition(De.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(l.copy(t.parentMatrix),h.copy(t.parentMatrixWorld));const d=n.clone().multiply(s).multiply(r),_=new O;_.extractRotation(h);const g=new O;g.copyPosition(h);const y=g.clone().invert().multiply(h),v=_.clone().invert().multiply(y),m=i,w=new O;if(p===0)w.copy(_).multiply(d).multiply(v).multiply(m);else if(p===1)w.copy(_).multiply(v).multiply(d).multiply(m);else{const k=new O().scale(new L().setFromMatrixScale(l)).clone().invert(),Ae=v.clone().multiply(k);w.copy(_).multiply(d).multiply(Ae).multiply(m)}const P=u.clone().invert(),S=o.clone().invert();let F=e.clone().multiply(c).multiply(u).multiply(n).multiply(s).multiply(r).multiply(P).multiply(a).multiply(o).multiply(i).multiply(S);const N=new O().copyPosition(F),V=h.clone().multiply(N);return f.copyPosition(V),F=f.clone().multiply(w),F.premultiply(h.invert()),F}function Ri(t){t=t||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return t===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function en(t){return t.split(",").map(function(n){return parseFloat(n)})}function Ii(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=t.byteLength),new TextDecoder().decode(new Uint8Array(t,e,n))}function dl(t,e){for(let n=0,s=t.length,r=e.length;n<r;n++,s++)t[s]=e[n]}function ml(t,e,n,s){for(let r=n,i=0;r<s;r++,i++)t[i]=e[r];return t}const Fi=t=>t&&new Promise(e=>{new rl().load(t,e)}),Bi=t=>t&&new Promise(e=>{new Ve().load(t,e)}),_l=["px.png","nx.png","py.png","ny.png","pz.png","nz.png"],gl=t=>t&&new Promise(e=>{new Ro().setPath(`${t}/`).load(_l,e)}),yl=["c100007_01","c100007_05","c100007_09","c100034_01","c100035_01","c100036_01","c100037_01","c100041_01"],vl="https://dgk3593.github.io/dl-model",ji=async t=>t.startsWith("http")?fetch(t):fetch(`${vl}/${t}`),wl=async t=>await(await ji(t)).json(),It=async t=>(await wl(t)).data,bl=(...t)=>e=>t.reduce((n,s)=>s(n),e),El=t=>[...new Set(t)],he=t=>t==="false"?!1:!!t,Ni=(t,e,n)=>{if(!e.length)return;const s=e.pop(),r=e.reduce((i,o)=>i==null?void 0:i[o],t);r&&(r[s]=n)};function Kn(t){return!!/[0-9A-Fa-f]{6}/.test(t)}function _t(t){return Kn(t)&&!t.startsWith("#")?new $(`#${t}`):new $(t)}async function Sl(t=100){return await new Promise(e=>setTimeout(e,t))}function $i(t,e="="){const[n,...s]=t.split(e),r=s.join(e);return[n,r]}const Pl=t=>t.startsWith("w302"),Ys=([t,...e])=>`${t.toUpperCase()}${e.join("")}`;function xl(t){return t==="smith"?"dragon":t.endsWith("h")?"story":yl.includes(t)?"spAdventurer":{c:"adventurer",b:"boss",d:"dragon",e:"enemy",h:"high boss",o:"object",r:"raid boss",w:"weapon"}[t[0]]??"other"}function Tl(t=Xl){const e=new Io(t);return e.outputColorSpace=J,e}function Al(t={}){const{fov:e,aspect:n,near:s,far:r}={...Yl,...t};return new _r(e,n,s,r)}async function Ml(t){if(t.startsWith("img:")){const e=t.replace("img:",""),n=await Bi(e);return n.colorSpace=J,n.center.set(.5,0),n}if(t.startsWith("sky:")){const e=t.replace("sky:",""),n=await gl(e);return n.colorSpace=J,n}if(t==="transparent")return null;if(Kn(t)){const e=t.startsWith("#")?t:`#${t}`;return new $(e)}}function Cl(t){var e,n,s,r;(n=(e=t.map)==null?void 0:e.dispose)==null||n.call(e),(r=(s=t.userData.backupMap)==null?void 0:s.dispose)==null||r.call(s),t.dispose()}const Ui=t=>{const e=new Ve().load(t);return e.colorSpace=J,e};function Dl(t){const e=[],n=[];return t.traverse(s=>{s.isMesh&&e.push(s),s.isBone&&n.push(s)}),[e,n]}function Ll(t){var n,s;if(!t)return;[t.material].flat().forEach(r=>{var i,o,a,c,u,h;(o=(i=r.map)==null?void 0:i.dispose)==null||o.call(i),(u=(c=(a=r.userData)==null?void 0:a.backupMap)==null?void 0:c.dispose)==null||u.call(c),(h=r.dispose)==null||h.call(r)}),(s=(n=t.geometry)==null?void 0:n.dispose)==null||s.call(n)}const kl=()=>{const t=new Date,e=t.toDateString().replaceAll(" ","_"),n=t.toLocaleTimeString().replaceAll(":","-").replaceAll(" ","");return`${e}_${n}`},zi=t=>t?t.split("/").reduce((n,s)=>{const[r,i]=s.split("=");return r&&i&&(n[r]=i),n},{}):{},Ol=`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,Rl=`
#ifdef USE_MATCAP

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
	vec4 matcapColor = texture2D( matcap, uv );

	#ifdef MATCAP_BLENDING_MULTIPLY

		outgoingLight *= matcapColor.rgb;

	#elif defined( MATCAP_BLENDING_ADD )

		outgoingLight += matcapColor.rgb;

	#endif

#endif
`,ht={name:"MMDToonShader",defines:{TOON:!0,MATCAP:!0,MATCAP_BLENDING_ADD:!0},uniforms:Mn.merge([Ge.toon.uniforms,Ge.phong.uniforms,Ge.matcap.uniforms]),vertexShader:Ge.phong.vertexShader.replace("#include <envmap_pars_vertex>","").replace("#include <envmap_vertex>",""),fragmentShader:Ge.phong.fragmentShader.replace("#include <common>",`
					#ifdef USE_MATCAP
						uniform sampler2D matcap;
					#endif

					#include <common>
				`).replace("#include <envmap_common_pars_fragment>",`
					#include <gradientmap_pars_fragment>
				`).replace("#include <envmap_pars_fragment>","").replace("#include <lights_phong_pars_fragment>",Ol).replace("#include <envmap_fragment>",`
					${Rl}
				`)};class Vi extends Ye{constructor(e){super(),this._matcapCombine=ps,this.emissiveIntensity=1,this.normalMapType=Fo,this.combine=ds,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.lights=!0,this.vertexShader=ht.vertexShader,this.fragmentShader=ht.fragmentShader,this.defines=Object.assign({},ht.defines),Object.defineProperty(this,"matcapCombine",{get:function(){return this._matcapCombine},set:function(s){switch(this._matcapCombine=s,s){case ds:this.defines.MATCAP_BLENDING_MULTIPLY=!0,delete this.defines.MATCAP_BLENDING_ADD;break;default:case ps:this.defines.MATCAP_BLENDING_ADD=!0,delete this.defines.MATCAP_BLENDING_MULTIPLY;break}}}),this.uniforms=Mn.clone(ht.uniforms);const n=["specular","shininess","opacity","diffuse","map","matcap","gradientMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacemantBias","displacemantMap","displacemantScale","specularMap","alphaMap","envMap","reflectivity","refractionRatio"];for(const s of n)Object.defineProperty(this,s,{get:function(){return this.uniforms[s].value},set:function(r){this.uniforms[s].value=r}});Object.defineProperty(this,"color",Object.getOwnPropertyDescriptor(this,"diffuse")),this.setValues(e)}copy(e){return super.copy(e),this.matcapCombine=e.matcapCombine,this.emissiveIntensity=e.emissiveIntensity,this.normalMapType=e.normalMapType,this.combine=e.combine,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Vi.prototype.isMMDToonMaterial=!0;const Il=["color","emissive","specular"],Fl=["wireframe","metalness","opacity","roughness","shininess","transparent","emissiveIntensity","transmission","thickness","ior"],Hi=["type","flatShading","showTexture","gradientMap","matcap"],Bl=[...Il,...Fl,...Hi],jl=["transparent","opacity","wireframe","showTexture","color"],Nl={Basic:[],Toon:["emissive","emissiveIntensity","gradientMap"],Lambert:["emissive","emissiveIntensity"],Phong:["emissive","emissiveIntensity","specular","shininess","flatShading"],Standard:["emissive","emissiveIntensity","metalness","roughness","flatShading"],Physical:["emissive","emissiveIntensity","metalness","roughness","flatShading","transmission","thickness","ior"],Matcap:["flatShading","matcap"],MMDToon:["emissive","emissiveIntensity","specular","shininess","matcap","gradientMap","flatShading"]},X=t=>`${t}`,tn=t=>Kn(t)?`${t.startsWith("#")?"":"#"}${t}`:t,$l=t=>Array.isArray(t)?t.join(","):t,Yn={wireframe:{name:"Wireframe",type:"boolean",default:!1,valueMap:he,toString:X},showTexture:{name:"Texture",type:"boolean",default:!0,valueMap:he,toString:X},transparent:{name:"Transparent",type:"boolean",default:!1,valueMap:he,toString:X},flatShading:{name:"Flat Shading",type:"boolean",default:!1,valueMap:he,toString:X},color:{name:"Color",type:"color",default:"#ffffff",valueMap:_t,toString:tn},emissive:{name:"Emissive",type:"color",default:"#000000",valueMap:_t,toString:tn},opacity:{name:"Opacity",type:"percentage",default:1,min:0,max:1,valueMap:parseFloat,toString:X},emissiveIntensity:{name:"Emissive Intensity",type:"percentage",default:1,min:0,max:1,valueMap:parseFloat,toString:X},specular:{name:"Specular",type:"color",default:"#111111",valueMap:_t,toString:tn},metalness:{name:"Metalness",type:"percentage",default:0,min:0,max:1,valueMap:parseFloat,toString:X},roughness:{name:"Roughness",type:"percentage",default:1,min:0,max:1,valueMap:parseFloat,toString:X},shininess:{name:"Shininess",type:"number",default:30,min:1,max:100,valueMap:parseFloat,toString:X},gradientMap:{name:"Gradient Map",type:"select",default:"none",valueMap:Wi,toString:$l},matcap:{name:"Matcap",type:"select",default:"matcap_fresnel.jpg",valueMap:Gi,toString:X},transmission:{name:"Transmission",type:"number",default:1,min:0,max:1,valueMap:parseFloat,toString:X},thickness:{name:"Thickness",type:"number",default:.01,min:0,max:10,valueMap:parseFloat,toString:X},ior:{name:"Index-of-refraction",type:"number",default:1.5,min:1,max:2.333,valueMap:parseFloat,toString:X}},Ul=Object.fromEntries(Object.entries(Yn).map(([t,{default:e}])=>[t,e])),ve={...Ul,type:"Basic"},zl=Object.fromEntries(Object.entries(Yn).map(([t,{valueMap:e}])=>[t,e])),Vl=Object.fromEntries(Object.entries(Yn).map(([t,{toString:e}])=>[t,e])),nn=t=>[...jl,...Nl[t]],Hl=(t,e={})=>{if(t==="MMDToon")return new Vi(e);const n=`Mesh${t}Material`;return new br[n](e)},qs=(t,{matType:e="Basic",texturePath:n="",force:s=!1}={})=>{t.forEach(r=>{const i=[r.material].flat(),o=Array.isArray(r.material);if(!s&&!n){const a=`isMesh${e}Material`;if(!i.some(u=>!u[a]))return}i.forEach((a,c)=>{var l,f,p,d;const u=n?new Ve().load(n):i[c].map;n&&(u.colorSpace=J);const h=Hl(e);if(h.name=a.name,h.map=u,h.userData.backupMap=a.userData.backupMap,n&&((f=(l=a.map)==null?void 0:l.dispose)==null||f.call(l),(d=(p=a.userData.backupMap)==null?void 0:p.dispose)==null||d.call(p)),a.dispose(),o){r.material[c]=h;return}r.material=h})})},Wl=t=>Array.isArray(t)?t:t.split(",").map(e=>parseInt(e));function Wi(t){const e=Wl(t),n=e.length;if(n<2)return null;const s=Uint8Array.from(e),r=new Bo(s,n,1,jo);return r.minFilter=r.magFilter=No,r.generateMipmaps=!1,r}const Gl=t=>t.includes("/")||t.includes(":")?t:`${Oc}/${t}`;function Gi(t){const e=Gl(t);return e?Ui(e):null}const Xl={alpha:!0,antialias:!0},Kl="#cccccc",Yl={type:"Perspective",fov:45,aspect:1,far:300,near:.01},ql="c100001_01",ke={enabled:!0,size:5,color:"#000000",opacity:1},Zl={noBackground:!0,fileName:"screenshot",frameRate:30},Ql={frameRate:30,fileName:"ani",appendDate:!0},Zs=1,Sn=30,Jl={directional:{color:"#ffffff",intensity:.8,position:[1,0,2]},ambient:{color:"#444444",intensity:1},point:{color:"#ffffff",intensity:1}},sn={"No Mapping":$o,Linear:Uo,Reinhard:zo,Cineon:Vo,"ACES Filmic":Ho},it={addEventListener(t,e){if(!e)return;this._listeners??(this._listeners={});const n=this._listeners;return t=t.toLowerCase(),n[t]??(n[t]=[]),n[t].includes(e)||n[t].push(e),e},hasEventListener(t,e){var n,s;return t=t.toLowerCase(),!!((s=(n=this._listeners)==null?void 0:n[t])!=null&&s.includes(e))},removeEventListener(t,e){var r;t=t.toLowerCase();const n=(r=this._listeners)==null?void 0:r[t];if(!n)return;const s=n.indexOf(e);s!==-1&&n.splice(s,1)},dispatchEvent(t){var r,i;const e=(r=t.type)==null?void 0:r.toLowerCase(),n=(i=this._listeners)==null?void 0:i[e];if(!n)return;t.target=this,[...n].forEach(o=>o.call(this,t))},addCountedEventListener(t,e,n=1){const s=this;function r(i){e.call(s,i),n--,n===0&&s.removeEventListener(t,r)}this.addEventListener(t,r)}},eu={face1:[2,1],face2:[0,0],face3:[1,0],face4:[2,0],face5:[3,0],face6:[0,-1],face7:[1,-1],face8:[2,-1],face9:[3,-1]},Xi={},tu=async()=>{const t=await It(`${Rt}/face-offset.json`);Object.assign(Xi,t)},Qs=t=>Xi[t]||[0,0],Pn={},nu=async()=>{const t=await It(`${Rt}/camera-position.json`);Object.assign(Pn,t)},su=t=>Pn[t]??Pn[t[0]],xn={},ru=async()=>{const t=await It(`${Rt}/control-position.json`);Object.assign(xn,t)},iu=t=>xn[t]??xn[t[0]],Js=t=>eu[`face${t}`],ou=(t,e)=>{const n={x:0,y:0};if(t!==e){const[s,r]=Js(e),[i,o]=Js(t);n.x=i-s,n.y=o-r}return[n.x,n.y]},au=(t,e)=>{const n={x:0,y:0};if(t!==e){const[s,r]=Qs(e),[i,o]=Qs(t);n.x=i-s,n.y=o-r}return[n.x,n.y]},Ft=t=>new Proxy(Object.assign(t,it),{get(e,n){return e[n]},set(e,n,s){return e[n]=s,e.dispatchEvent({type:"change",propName:n,value:s}),!0}}),Ki=/mEye_[0-9]/m,Yi=/mMouth_[0-9]/m,cu=/[0-9]{2}/,qi=["eye","mouth"];function lu(t){const{type:e,meshes:n}=t;return e==="adventurer"?uu(t):n.some(({name:r})=>r.match(/mEye|mMouth/))?hu(t):t}function uu(t){const{meshes:e,id:n}=t,s=u=>`${Si}/${u}/${u}.png`,r=e.find(({name:u})=>u==="mBodyAll"),i={eyeIdx:2,eyeBaseIdx:2,mouthIdx:2,mouthBaseIdx:2,eyeTexture:n,mouthTexture:n},o={type:"uv",reset:function(){this.eyeIdx=this.eyeBaseIdx,this.mouthIdx=this.mouthBaseIdx}},a=u=>([h,l])=>{var v;if(!r)return;const f=`mt${Ys(u)}CH`,p=(v=r.geometry.groups)==null?void 0:v.find(m=>{var w;return((w=r.material[m.materialIndex])==null?void 0:w.name)===f});if(!p)return;const{start:d,count:_}=p,g=d+_,y=r.geometry.attributes.uv;for(let m=d;m<g;m++){const w=y.getX(m)+.25*h,P=y.getY(m)+.25*l;y.setXY(m,w,P)}y.needsUpdate=!0},c=u=>h=>{var d,_;if(!r)return;const l=`mt${Ys(u)}CH`,f=(_=(d=r.material).find)==null?void 0:_.call(d,({name:g})=>g===l);if(!f)return;const p=s(h);f.map.dispose(),f.map=Ui(p),f.needsUpdate=!0};return qi.forEach(u=>{Object.defineProperties(o,{[`${u}Idx`]:{get(){return i[`${u}Idx`]},set(h){const l=parseInt(h),f=this[`${u}Idx`];i[`${u}Idx`]=l;const p=ou(l,f);a(u)(p)}},[`${u}BaseIdx`]:{get(){return i[`${u}BaseIdx`]},set(h){i[`${u}BaseIdx`]=h,this[`${u}Idx`]=h}},[`${u}Texture`]:{get(){return i[`${u}Texture`]},set(h){const l=this[`${u}Texture`];i[`${u}Texture`]=h,c(u)(h);const f=au(h,l);a(u)(f)}}})}),t.face=Ft(o),t}function hu(t){const{meshes:e}=t,[n,s]=fu(e);[...n,...s].forEach(c=>c.frustumCulled=!1);const r={eye:n,mouth:s},i={eyeIdx:"",eyeBaseIdx:"",mouthIdx:"",mouthBaseIdx:""},o={eyeList:n,mouthList:s,type:"meshes",reset:function(){this.eyeIdx=this.eyeBaseIdx,this.mouthIdx=this.mouthBaseIdx}},a=c=>u=>{r[c].forEach(h=>{const{name:l}=h,f=cu.exec(l)[0];h.visible=parseInt(f)===u})};return qi.forEach(c=>Object.defineProperties(o,{[`${c}Idx`]:{get(){return i[`${c}Idx`]},set(u){const h=parseInt(u);a(c)(h),i[`${c}Idx`]=`${h}`}},[`${c}BaseIdx`]:{get(){return i[`${c}BaseIdx`]},set(u){i[`${c}BaseIdx`]=u,this[`${c}Idx`]=u}}})),o.eyeBaseIdx=Zs,o.mouthBaseIdx=Zs,t.face=Ft(o),t}function fu(t){const e=t.filter(({name:s})=>s.match(Ki)),n=t.filter(({name:s})=>s.match(Yi));return[e,n]}function pu(t){const{model:e,uniqueId:n}=t,[s,r]=Dl(e);return Object.defineProperty(r,"list",{value:El(r.map(({name:i})=>i))}),Object.defineProperty(s,"visible",{get(){return this.filter(({visible:i})=>i)}}),r.forEach(i=>{i.name=`${n}|${i.name}`}),Object.defineProperties(t,{meshes:{get(){return s}},bones:{get(){return r}}})}const Zi={},du=async()=>{const t=await It(`${Rt}/model-parts.json`);Object.assign(Zi,t)},mu=t=>Zi[t],_u=/mParts([A-Za-z]+)/,er=/mParts[A-Za-z]+_([A-Za-z]*)/;function gu(t){const{meshes:e,id:n}=t,s=mu(n),r=[],i=[];if(e.forEach(u=>{var l;let{name:h}=u;if(h!=null&&h.match){if((h.includes("Effect")||h.includes("Extension"))&&(u.visible=!1),(l=s==null?void 0:s.custom)!=null&&l[h]&&(h=u.name=s.custom[h]),h.match(/mParts/)){r.push(u);return}!h.match(Ki)&&!h.match(Yi)&&i.push(u)}}),!r.length&&i.length<2)return t;const o=Object.defineProperties({},{list:{get(){return Object.keys(this)},enumerable:!1},reset:{value:function(){this.list.forEach(u=>this[u].reset())},enumerable:!1},others:{get(){return i},enumerable:!1}});if(t.parts=o,!r.length)return t;const a=new Set(r.map(({name:u})=>{var h;return(h=_u.exec(u))==null?void 0:h[1]}).sort((u,h)=>u>h?1:-1)),c=u=>r.filter(({name:h})=>h.includes(`mParts${u}`)).sort((h,l)=>h.name>l.name?1:-1);return a.forEach(u=>{var g;const h=s==null?void 0:s[u],l=((g=h==null?void 0:h.name)==null?void 0:g.replaceAll(" ","_"))??u,f=h==null?void 0:h.options,p=c(u);p.forEach(y=>y.frustumCulled=!1);const d=p.map(({name:y})=>{var m;const v=((m=er.exec(y))==null?void 0:m[1])??"default";return(f==null?void 0:f[v])??v}),_=(h==null?void 0:h.default)??d[0];o[l]={_meshes:p,list:d,default:_??d[0]},Object.defineProperties(o[l],{current:{get(){var P;const y=p.filter(({visible:S})=>S).length;if(y===0)return"None";if(y!==1)return"custom";const m=(P=p.find(({visible:S})=>S).name.match(er))==null?void 0:P[1];return(f==null?void 0:f[m??"default"])??m??"default"},set(y){if(y.toLowerCase()==="none"){this._meshes.forEach((m,w)=>{m.visible=!1});return}if(!this.list.includes(y))return;const v=this.list.indexOf(y);this._meshes.forEach((m,w)=>{m.visible=w===v})}},index:{get(){return this.current==="custom"?NaN:this.list.indexOf(this.current)},set(y){this._meshes.forEach((v,m)=>{v.visible=m===Number(y)})}},reset:{value:function(){this.current=this.default}}})}),o.reset(),t.parts=o,t}const yu=t=>e=>{const n=e.meshes,s={...ve,...t},{type:r}=s;qs(n,{force:!0,matType:r});let i={type:r,showTexture:!0},o=nn(r);const a={get code(){const{type:c,propList:u}=this,h=[];return c!==ve.type&&h.push(`type=${c}`),u.forEach(f=>{const p=Vl[f],d=p(this[f]),_=p(ve[f]);d!==_&&h.push(`${f}=${d}`)}),h.join("/").replaceAll("#","")},set code(c){const u=Object.keys(ve),h={...ve,...zi(c)};u.forEach(l=>{this[l]=h[l]})},toString(){const{code:c}=this;return c?`mat=(${c})`:""},get list(){return n.flatMap(({material:c})=>c)},get propList(){return o},set type(c){if(this.type===c)return;o=nn(c),qs(n,{matType:c}),i.type=c;const u={...i};i={showTexture:u.showTexture},o.forEach(h=>this[h]=u[h]),i=u},set flatShading(c){const u=he(c);u!==this.flatShading&&(i.flatShading=u,this.propList.includes("flatShading")&&this.list.forEach(h=>{h.flatShading=u,h.needsUpdate=!0}))},set gradientMap(c){var l,f;if(c===this.gradientMap||(i.gradientMap=c,!this.propList.includes("gradientMap")))return;const u=(l=this.list[0])==null?void 0:l.gradientMap;(f=u==null?void 0:u.dispose)==null||f.call(u);const h=c==="none"?null:Wi(c);this.list.forEach(p=>{p.gradientMap=h,p.needsUpdate=!0})},set showTexture(c){const u=he(c);if(this.showTexture===u)return;i.showTexture=u;const h=u?l=>{l.map=l.userData.backupMap,l.userData.backupMap=null,l.needsUpdate=!0}:l=>{l.userData.backupMap=l.map,l.map=null,l.needsUpdate=!0};this.list.forEach(h)},set matcap(c){var l,f;if(i.matcap===c||(i.matcap=c,!this.propList.includes("matcap")))return;const u=(l=this.list[0])==null?void 0:l.matcap;(f=u==null?void 0:u.dispose)==null||f.call(u);const h=Gi(c);this.list.forEach(p=>{p.matcap=h,p.needsUpdate=!0})}};return Bl.forEach(c=>Object.defineProperty(a,c,{get(){return i[c]},...!Hi.includes(c)&&{set(u){u!==this[c]&&(i[c]=u,this.propList.includes(c)&&this.list.forEach(h=>h[c]=zl[c](u)))}}})),nn(r).forEach(c=>a[c]=s[c]),i={...ve,...i},e.material=Ft(a),e},vu=`uniform float opacity;\r
uniform vec3 color;\r
\r
void main() {\r
	gl_FragColor = vec4( color, opacity );\r
}\r
`,wu=`uniform float size;\r
\r
#include <skinning_pars_vertex>\r
\r
void main() {\r
	#include <skinbase_vertex>\r
	\r
    vec3 transformed = position + normal * 0.0005 * size;\r
        \r
	#include <skinning_vertex>\r
	#include <project_vertex>\r
}`,bu=t=>new Ye({side:Wo,transparent:!0,depthFunc:Go,vertexShader:wu,fragmentShader:vu,uniforms:t});function Eu(t,e){const{material:n}=t,s=Array.isArray(t.material);[n].flat().forEach(Cl),t.material=s?new Array(t.material.length).fill(e):e}function Su(t,e){const n=bu(e),s=[],r=["Eff","Extension"];return t.forEach(i=>{const{name:o}=i;if(r.some(c=>o.includes(c)))return;const a=i.clone();a.name=`outline-${i.name}`,Eu(a,n),i.isSkinnedMesh&&a.bind(i.skeleton,i.bindMatrix),i.add(a),s.push(a)}),s}const Pu={size:parseFloat,opacity:parseFloat,color:_t},xu=t=>e=>{const n={...ke,...t},s=e.meshes,r={size:{value:n.size},opacity:{value:n.opacity},color:{value:new $(n.color)}},i=Su(s,r),o={...n,enabled:!0},a={get propList(){return["enabled","color","size","opacity"]},get enabled(){return o.enabled},set enabled(c){const u=he(c);i.forEach(h=>h.visible=u),o.enabled=u},get code(){if(!this.enabled)return"none";const c=[];return Object.keys(ke).forEach(u=>{const h=this[u];h!==ke[u]&&c.push(`${u}=${h}`)}),c.join("/").replaceAll("#","")},set code(c){if(c==="none"){this.enabled=!1;return}const u=Object.keys(ke),h={...ke,...zi(c)};u.forEach(l=>{this[l]=h[l]})},toString(){const{code:c}=this;return c?`ol=(${c})`:""}};return["size","opacity","color"].forEach(c=>Object.defineProperty(a,c,{get(){return o[c]},set(u){u!==this[c]&&(o[c]=u,r[c].value=Pu[c](u))}})),a.enabled=n.enabled,e.outline=Ft(a),e},Tu=["push","pop","shift","unshift","splice","reverse","sort"];class fe extends Array{constructor(...e){super(...e),Object.assign(this,it),Tu.forEach(n=>{Object.defineProperty(this,n,{value:(...s)=>{Array.prototype[n].call(this,...s),this.dispatchEvent({type:"change",method:n,args:s})},enumerable:!1})})}remove(e){const n=this.indexOf(e);n!==-1&&this.splice(n,1)}}const tr={chainName:"",chainCode:"",chainLength:0,aniIdx:0,clipDuration:0,clipTimeScale:1,action:null,aniAction:[],aniActionPointer:0};function Qi(t){return t.split(">").map(Au)}function Au(t){const[e,...n]=t.split("&"),s=Mu(n);return{aniName:e,...s}}function Mu(t){const e={},n=[],s={r:{name:"reps",map:parseInt},ts:{name:"timeScale",map:parseFloat},dur:{name:"duration",map:Cu}};return t.forEach(r=>{const[i,o]=$i(r);if(i.startsWith("@")){const u=Du(o.replace(/[()]/g,""));u.time=parseFloat(i.slice(1)),n.push(u);return}if(!s[i])return;const{name:a,map:c}=s[i];e[a]=c(o)}),e.aniAction=n.filter(({time:r})=>r<=100&&r>=0).sort((r,i)=>r.time-i.time),e}function Cu(t){if(!t)return[0,100];const e=t.split("-").slice(0,2).map(parseFloat),n=e.length===2?e:[0,e[0]];return n.some(s=>s>100||s<0)||n[0]>n[1]?[0,100]:n}function Du(t){return t.split("/").reduce((n,s)=>{const[r,i]=$i(s);return{...n,...Lu(r,i)}},{})}const nr={ei:{name:"face.eyeIdx",valueMap:parseInt},mi:{name:"face.mouthIdx",valueMap:parseInt},et:{name:"face.eyeTexture"},mt:{name:"face.mouthTexture"}};function Lu(t,e){if(t in nr){const{name:r,valueMap:i}=nr[t];return{[r]:(i==null?void 0:i(e))??e}}let n=t,s=e;return t.startsWith("att")&&n.replace("att","attachment"),t.startsWith("parts")&&(n+="index",s=parseInt(e)),{[n]:s}}const ku=t=>`${Pi}/${t}.json`;function Ou(t,e){if(t.startsWith("fbx:"))return Ru(t);if(t.startsWith("ex:")){const[,s]=t.split(":"),r=e==null?void 0:e.find(({uuid:i})=>s===i);return Promise.resolve(r.clone())}const n=ku(t);return new Promise(s=>ji(n).then(r=>r.json()).then(r=>wr.parse(r)).then(s))}async function Ru(t){const e=t.replace("fbx:",""),[n,s]=e.split("+"),{animations:r}=await Fi(n);return s?r.find(({name:i})=>i===s):r[0]}function Iu(t,e=null){return Promise.all(t.map(n=>Ou(n,e)))}function Fu(t,e=[]){return t.map((n,s)=>{const r=e[s];if(!r||r[0]===0&&r[1]===100)return n;const i=n.duration*Sn,[o,a]=r.map(c=>Math.round(c*i/100));return Xo.subclip(n,n.name,o,a,Sn)})}async function Bu(t,e=null){const n=Qi(t),s=n.map(({aniName:u})=>u),r=n.map(({duration:u})=>u),i=n.map(({aniName:u,duration:h,...l})=>({...l})),o=await Iu(s,e),a=Fu(o,r);return{code:t,clips:a,mod:i,get duration(){return i.some(({timeScale:h})=>h===0)?1/0:a.map((h,l)=>h.duration/Math.abs(i[l].timeScale??1)*(i[l].reps??1)).reduce((h,l)=>h+l,0)}}}const ju=/[a-z][0-9]{6}/;function Nu(t){const{model:e,uniqueId:n,bones:s,id:r,viewer:i}=t,o=i.userData.ani,a=new Ko(e),c=(s==null?void 0:s.list)??[],u={...it,mixer:a,chain:{},current:{...tr},toString(){var f;const l=(f=this.chain.default)==null?void 0:f.code;return l?`ani=${l}`:""},async addChain(l,{name:f="default",autoplay:p=!0}={}){var _;if(!l||((_=this.chain[f])==null?void 0:_.code)===l)return;a.stopAllAction();const d=await Bu(l,o);d.clips.forEach(g=>{g.tracks=g.tracks.reduce((y,v)=>{let m=v.name.split(".")[0];return ju.test(m)&&(v.name.replace(m,r),m=r),c.includes(m)&&(v.name=`${n}|${v.name}`,y.push(v)),y},[])}),this.chain[f]=d,a.addEventListener("finished",h),p&&this.play(f)},play(l=this.current.chainName||"default"){const f=this.chain[l];f&&(this.current.chainName=l,this.current.chainCode=f.code,this.current.chainLength=f.clips.length,this.aniIdx=0)},pause(){this.current.action&&(this.current.action.paused=!0)},resume(){this.current.action&&(this.current.action.paused=!1)},stop(){a.stopAllAction()},reset(){const l=this.current.chainName;this.stop(),this.current={...tr},this.chain[l]=void 0},update(l){var g;a.update(l);const{current:f}=this,{action:p,aniAction:d,clipDuration:_}=f;if(!(!d[f.aniActionPointer]||!p))for(;(p==null?void 0:p.time)>((g=d[f.aniActionPointer])==null?void 0:g.time)*_/100;)this.applyAniAction(d[f.aniActionPointer]),this.current.aniActionPointer++},applyAniAction(l){t.dispatchEvent({type:"aniAction",id:n,aniAction:l});const{time:f,...p}=l;Object.entries(p).forEach(([d,_])=>{const g=d.split(".");Ni(t,g,_)})},nextFrame(l=1,f=Sn){if(!this.isPaused)return;const{clipTimeScale:p,clipDuration:d,action:_}=this.current,g=l*p/f;if(_.time+=g,_.time>=d){const y=_.time-d;h(),this.pause(),this.current.action.time+=y*this.current.clipTimeScale}},setTime(l){const{clipDuration:f,action:p}=this.current;!f||l>f||(p.time=l)},get isPaused(){var l;return(l=this.current.action)==null?void 0:l.paused},get aniIdx(){return this.current.aniIdx},set aniIdx(l){if(l>=this.current.chainLength)return;this.current.aniIdx=l,this.current.aniActionPointer=0;const f={type:l===0?"chainStart":"chainMove",index:l,uniqueId:n,chainName:this.current.chainName};this.dispatchEvent(f),a.stopAllAction();const p=this.chain[this.current.chainName],d=p.mod[l],{timeScale:_,reps:g,aniAction:y}=d,v=p.clips[l],m=a.clipAction(v);m.timeScale=_??1,m.setLoop(Yo,g??1),this.current.clipDuration=v.duration,this.current.action=m,this.current.aniAction=y,this.current.aniActionPointer=0,this.current.clipTimeScale=_??1,m.play()}};function h(){const{aniIdx:l,chainLength:f}=u.current,p=(l+1)%f;if(p===0){u.dispatchEvent({type:"ChainFinished",chainName:u.current.chainName});const{face:d}=t;d&&(d.eyeIdx=d.eyeBaseIdx,d.mouthIdx=d.mouthBaseIdx)}u.aniIdx=p}return t.animation=u,t.addEventListener("TimeUpdated",({dt:l})=>u.update(l)),t}function $u(t){const{model:e,bones:n,uniqueId:s}=t,r={};return Object.defineProperty(r,"list",{get(){return Object.values(this).flat()}}),Object.defineProperty(r,"traverse",{value:function(h){this.list.forEach(l=>{var f,p;h(l),(p=(f=l.attachment)==null?void 0:f.traverse)==null||p.call(f,h)})}}),Object.assign(t,{attachment:r,parent:null,parentBone:"",attach:(h,l="root")=>{r[l]=r[l]??new fe;const f=l==="root"?e:n.find(({name:p})=>p===`${s}|${l}`);f!=null&&f.add&&(h.detach(),f.add(h.model),r[l].push(h),h.parent=t,h.parentBone=l,t.dispatchEvent({type:"AttachmentChanged"}))},remove:(h,l="")=>{var p,d,_;const f=l||Object.keys(r).find(g=>r[g].indexOf(h)!==-1);f&&((d=(p=r[f]).remove)==null||d.call(p,h),(_=h.model.parent)==null||_.remove(h.model),t.dispatchEvent({type:"AttachmentChanged"}))},detach:()=>{var f;(f=e.parent)==null||f.remove(e);const{parent:h,parentBone:l}=t;h&&(h.remove(t,l),t.parent=t.parentBone=null)},attachTo:(h,l="root")=>{var f;t.detach(),(f=h==null?void 0:h.attach)==null||f.call(h,t,l)}})}function Uu(t){const{material:e,id:n}=t,s=Pt.source.fbx,r=sr(n);Pl(n)&&async function(){const c=a(r),u=new Ve().load(c);u.colorSpace=J,u.name=r,e.list.forEach(h=>h.map=h.map??u)}();let i=r;Object.defineProperty(t,"texture",{get(){return i},set(c){if(!c){this.texture=r;return}if(c===i)return;const u=a(c),[,h]=o(c),[,l]=o(this.texture),f=e.list.filter(p=>{var d,_,g,y;return((_=(d=p.map)==null?void 0:d.name)==null?void 0:_.includes(l))||((y=(g=p.userData.backupMap)==null?void 0:g.name)==null?void 0:y.includes(l))});f.length&&(async function(){const p=await Bi(u);p.name=h,p.colorSpace=J,f.forEach(d=>{var _,g,y,v;d.map&&((g=(_=d.map).dispose)==null||g.call(_),d.map=p),d.userData.backupMap&&((v=(y=d.userData.backupMap).dispose)==null||v.call(y),d.userData.backupMap=p)})}(),i=c)}});function o(c){const[u,h]=c.split(">"),l=u||n,f=h||sr(l);return[l,f]}function a(c){const[u,h]=o(c);return`${s}/${u}/${h}.png`}return t}const sr=t=>t.match(/_[0-9]{2}/)||t.startsWith("h")?t:`>${t}_01`,zu=`uniform float uTime;\r
uniform float uSpread;\r
uniform float uThreshold;\r
uniform float uSpeed;\r
uniform float uParticleSize;\r
uniform float uAuraSize;\r
\r
attribute float aRandom;\r
\r
varying float vIsParticle;\r
varying float vRandom;\r
\r
#include <skinning_pars_vertex>\r
void main() {\r
    #include <skinbase_vertex>\r
\r
    vec3 transformed = position + normal * 0.005 * uSpread;\r
\r
    #include <skinning_vertex>\r
\r
    vec3 objectNormal = normal;\r
\r
	#include <skinnormal_vertex>\r
    \r
    vec4 viewPosition = viewMatrix * modelMatrix * vec4(transformed, 1.0);\r
    float yDisplacement = fract( uTime * uSpeed + aRandom ) * 0.1;\r
    viewPosition.y += yDisplacement;\r
    viewPosition.x += sin( uTime * aRandom * uSpeed + aRandom ) * 0.02;\r
    \r
    gl_Position = projectionMatrix * viewPosition;\r
    \r
    objectNormal.z *= objectNormal.z > 0.7 ? -1.0 : 1.0;\r
    vIsParticle = objectNormal.z - uThreshold;\r
\r
    gl_PointSize = vIsParticle > 0.0 ? uParticleSize : uAuraSize;\r
    gl_PointSize /= -viewPosition.z;\r
\r
    vRandom = aRandom;\r
}\r
`,Vu=`uniform sampler2D uTexture;\r
\r
uniform float uTime;\r
uniform float uParticleOpacity;\r
uniform float uAuraOpacity;\r
uniform vec3 uColor;\r
uniform vec3 uColor2;\r
\r
varying float vRandom;\r
varying float vIsParticle;\r
\r
void main(){\r
    vec4 textureColor = texture2D( uTexture, gl_PointCoord );\r
    textureColor.a = length( textureColor.rgb ) ;\r
    textureColor.a *= abs( 1.0 - fract( uTime + vRandom ) ) * 0.5;\r
    textureColor.rgb = mix( uColor, uColor2,  textureColor.a * 2.0 );\r
    textureColor.a *= vIsParticle > 0.0 ? uParticleOpacity * 4.0 : uAuraOpacity;\r
\r
    gl_FragColor = textureColor;\r
    gl_FragColor /= vIsParticle > 0.0 ? 2.0 : 4.0;\r
}\r
`,gt=[{name:"time",uName:"uTime",defaultValue:0,valueMap:Number},{name:"speed",uName:"uSpeed",defaultValue:1,valueMap:Number},{name:"particleOpacity",uName:"uParticleOpacity",defaultValue:.3,valueMap:Number},{name:"auraOpacity",uName:"uAuraOpacity",defaultValue:.3,valueMap:Number},{name:"particleSize",uName:"uParticleSize",defaultValue:10,valueMap:Number},{name:"auraSize",uName:"uAuraSize",defaultValue:100,valueMap:Number},{name:"spread",uName:"uSpread",defaultValue:5,valueMap:Number},{name:"threshold",uName:"uThreshold",defaultValue:.3,valueMap:Number},{name:"texture",uName:"uTexture",defaultValue:"img/textures/particle/cloud.png",valueMap:t=>new Ve().load(t)},{name:"color",uName:"uColor",defaultValue:"#ffffff",valueMap:t=>new $(t)},{name:"color2",uName:"uColor2",defaultValue:"#33ffff",valueMap:t=>new $(t)}],Hu={aura:["visible",...gt.slice(1).map(({name:t})=>t)]},Wu=(t="aura")=>(e,n={})=>{if(e!=null&&e.length&&t==="aura")return Xu(e,n)};function Gu(t){return new Ye({vertexShader:zu,fragmentShader:Vu,uniforms:t,transparent:!0,blending:Qo,depthWrite:!1,side:Jo})}function Xu(t,e){const n=gt.map(c=>{const{uName:u,defaultValue:h,valueMap:l}=c,f=(l==null?void 0:l(h))??h;return[u,{value:f}]}),s=Object.fromEntries(n),r=Gu(s),i=[];t.forEach(c=>{const{name:u}=c.geometry;if(u.startsWith("mEye")||u.startsWith("mMouth"))return;const h=c.geometry.clone(),l=h.attributes.position.count,f=new Float32Array(l).fill(0).map(()=>Math.random()-.5);h.setAttribute("aRandom",new qo(f,1)),h.deleteAttribute("color"),h.deleteAttribute("uv");const p=new Zo(h,r);p.name="aura",c.isSkinnedMesh&&(p.type="SkinnedMesh",p.isSkinnedMesh=!0,p.skeleton=c.skeleton,p.bindMatrix=c.bindMatrix,p.bindMatrixInverse=c.bindMatrixInverse,p.bindMode=c.bindMode,p.bind=c.bind,p.clone=c.clone,p.initBones=c.initBones,p.normalizeSkinWeights=c.normalizeSkinWeights,p.pose=c.pose,p.updateMatrixWorld=c.updateMatrixWorld),c.add(p),i.push(p)});const o={visible:!0},a={name:"aura",onDispose:()=>{},get list(){return i},get propList(){return Hu.aura},get visible(){return o.visible},set visible(c){const u=he(c);this.list.forEach(h=>h.visible=u),o.visible=u},dispose(){this.onDispose(),this.list.forEach(c=>{var u,h,l,f,p;(u=c.parent)==null||u.remove(c),(l=(h=c.material).dispose)==null||l.call(h),(p=(f=c.geometry).dispose)==null||p.call(f)})},set code(c){c.split("/").forEach(h=>{const[l,f]=h.split("=");gt.map(({name:p})=>p).includes(l)&&(this[l]=f)})}};return gt.forEach(c=>{const{name:u,uName:h,defaultValue:l,valueMap:f}=c;o[u]=l,Object.defineProperty(a,u,{get(){return o[u]},set(p){o[u]=p,s[h].value=(f==null?void 0:f(p))??p}})}),a.onTimeUpdate=({time:c})=>a.time=c,Object.entries(e).forEach(([c,u])=>a[c]=u),a}function Ku(t){const{meshes:e}=t,n={list:new fe,dispose(){this.list.forEach(s=>{var r;return(r=s.dispose)==null?void 0:r.call(s)})},add(s="aura",r={}){const i=Wu(s)(e,r);return i.onDispose=()=>this.list.remove(i),this.list.push(i),t.addEventListener("TimeUpdated",i.onTimeUpdate),i}};return t.particle=n,t}const Yu=t=>{var a,c;if(t.dispatchEvent({type:"dispose"}),!t)return;const{model:e,meshes:n,outline:s,particle:r,viewer:i}=t;r==null||r.list.forEach(u=>u.dispose()),(a=e.parent)!=null&&a.isScene&&(e.parent.remove(e),i.loadedModel.remove(t)),(c=t.detach)==null||c.call(t),[n.reverse(),s==null?void 0:s.all].flat().forEach(Ll)};function qu(t){const{x:e,y:n,z:s}=t;return[e,n,s].map(r=>r||"").join()}const Zu={position:",,",rotation:",,",scale:"1,1,1"},Qu={position:"pos",rotation:"rot",scale:"scl"};function Ju(t){return Object.assign(t,{...t.isDLModel&&{toString(){const{id:e,animation:n,outline:s,material:r}=this,i=Object.entries(Zu).map(([o,a])=>{const c=qu(this[o]);return c===a?"":`${Qu[o]}=${c}`});return[`id=${e}`,...i,n,s,r].filter(o=>`${o}`).join("/")}},dispose(){const{attachment:e,parent:n,parentBone:s}=this;e.list.forEach(r=>r.dispose()),n==null||n.remove(this,s),this.dispatchEvent({type:"dispose"}),Yu(this)}})}const eh="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let qn=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=eh[n[t]&63];return e};function th(t,e){const{id:n,material:s,outline:r,viewer:i}=e,o=[pu,gu,$u,xu(r),yu(s),Uu,lu,Nu,Ku,Ju],a={...it,isDLModel:!0,model:t,id:n,uniqueId:qn(),type:xl(n),viewer:i,userData:{},_time:0,update(c){var u;this._time+=c,(u=this.attachment)==null||u.list.forEach(h=>{var l;return(l=h.update)==null?void 0:l.call(h,c)}),this.dispatchEvent({type:"TimeUpdated",dt:c,time:this._time})},set scale(c){var h;if((h=c.includes)!=null&&h.call(c,",")){const[l,f,p]=c.split(",").map(d=>d?parseFloat(d):1);this.model.scale.set(l,f,p);return}const u=Number(c)||1;this.model.scale.set(u,u,u)},get scale(){const{scale:c}=this.model,{x:u,y:h,z:l}=c;return u===h&&u===l?u:[u,h,l].join(",")},set visible(c){this.model.visible=he(c)}};return["position","rotation","visible"].forEach(c=>Object.defineProperty(a,c,{get(){return this.model[c]},enumerable:!0})),t.userData.container=a,bl(...o)(a)}const nh={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Bt{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const sh=new mr(-1,1,1,-1,0,1);class rh extends dt{constructor(){super(),this.setAttribute("position",new ge([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ge([0,2,0,0,2,0],2))}}const ih=new rh;class oh{constructor(e){this._mesh=new yr(ih,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,sh)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Ji extends Bt{constructor(e,n){super(),this.textureID=n!==void 0?n:"tDiffuse",e instanceof Ye?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Mn.clone(e.uniforms),this.material=new Ye({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new oh(this.material)}render(e,n,s){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=s.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const ah=Object.freeze(Object.defineProperty({__proto__:null,ShaderPass:Ji},Symbol.toStringTag,{value:"Module"}));class rr extends Bt{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,s){const r=e.getContext(),i=e.state;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),i.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),i.buffers.stencil.setClear(a),i.buffers.stencil.setLocked(!0),e.setRenderTarget(s),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.color.setMask(!0),i.buffers.depth.setMask(!0),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(r.EQUAL,1,4294967295),i.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),i.buffers.stencil.setLocked(!0)}}class ch extends Bt{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class lh{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const s=e.getSize(new j);this._width=s.width,this._height=s.height,n=new Er(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ea}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Ji(nh),this.copyPass.material.blending=ta,this.clock=new Sr}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let s=!1;for(let r=0,i=this.passes.length;r<i;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,s),o.needsSwap){if(s){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}rr!==void 0&&(o instanceof rr?s=!0:o instanceof ch&&(s=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new j);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const s=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(s,r),this.renderTarget2.setSize(s,r);for(let i=0;i<this.passes.length;i++)this.passes[i].setSize(s,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class uh extends Bt{constructor(e,n,s=null,r=null,i=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=s,this.clearColor=r,this.clearAlpha=i,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new $}render(e,n,s){const r=e.autoClear;e.autoClear=!1;let i,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(i=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:s),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(i),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=r}}function ir({renderer:t,scene:e,camera:n}){const s=hh(),r=new lh(t,s),i=new uh(e,n);return r.addPass(i),r}const hh=()=>new Er(800,600,{minFilter:ms,magFilter:ms,format:na,colorSpace:J}),rn={bloom:ph,pixel:mh,afterimage:wh,sobel:_h,halftone:gh,dotscreen:yh,bokeh:vh,smaa:dh};async function fh(t,e){var s;t=t.toLowerCase();const n=await((s=rn[t])==null?void 0:s.call(rn,e));return n.type=t,n.name=Zn[t].name,n}function jt(t,e){Object.defineProperty(t,"propList",{value:e}),e.forEach(n=>{Object.defineProperty(t,n,{get(){return this.uniforms[n].value},set(s){this.uniforms[n].value=s}})})}async function ph({resolution:t=new j(800,600),strength:e=.3,radius:n=.5,threshold:s=.8}={}){const{UnrealBloomPass:r}=await D(async()=>{const{UnrealBloomPass:o}=await import("./f_Bh62PO_s-UnrealBloomPass.js");return{UnrealBloomPass:o}},__vite__mapDeps([0,1])),i=new r(t,e,n,s);return Object.defineProperty(i,"propList",{value:["radius","strength","threshold"],writable:!1}),i}async function dh({renderer:t}){const{SMAAPass:e}=await D(async()=>{const{SMAAPass:r}=await import("./f_CAw9onpM-SMAAPass.js");return{SMAAPass:r}},__vite__mapDeps([2,1])),n=new j;t.getSize(n);const s=new e(n.x,n.y);return Object.defineProperty(s,"propList",{value:[],writable:!1}),s}async function mh({scene:t,camera:e}){const{RenderPixelatedPass:n}=await D(async()=>{const{RenderPixelatedPass:r}=await import("./f_BL33EWRT-RenderPixelatedPass.js");return{RenderPixelatedPass:r}},__vite__mapDeps([3,1])),s=new n(5,t,e);return Object.defineProperty(s,"propList",{value:["size"],writable:!1}),Object.defineProperty(s,"size",{get(){return this.pixelSize},set(r){this.setPixelSize(r)}}),s}async function _h({renderer:t}){const{ShaderPass:e}=await D(async()=>{const{ShaderPass:i}=await Promise.resolve().then(()=>ah);return{ShaderPass:i}},void 0),{SobelOperatorShader:n}=await D(async()=>{const{SobelOperatorShader:i}=await import("./f_DBJBGmhg-SobelOperatorShader.js");return{SobelOperatorShader:i}},__vite__mapDeps([4,1])),s=new j;t.getSize(s),s.multiplyScalar(window.devicePixelRatio);const r=new e(n);return r.uniforms.resolution.value.x=s.x,r.uniforms.resolution.value.y=s.y,Object.defineProperty(r,"propList",{value:[],writable:!1}),r}async function gh({renderer:t}){const{HalftonePass:e}=await D(async()=>{const{HalftonePass:i}=await import("./f_C-Zxy5V4-HalftonePass.js");return{HalftonePass:i}},__vite__mapDeps([5,1])),n=new j;t.getSize(n);const s=new e(n.x,n.y,{radius:4});return jt(s,["greyscale","radius","scatter","shape"]),s}async function yh(){const{DotScreenPass:t}=await D(async()=>{const{DotScreenPass:s}=await import("./f_B4WrYfZz-DotScreenPass.js");return{DotScreenPass:s}},__vite__mapDeps([6,1])),e=new t;return jt(e,["scale","center"]),e}async function vh({scene:t,camera:e}){const{BokehPass:n}=await D(async()=>{const{BokehPass:i}=await import("./f_BG1EgyeC-BokehPass.js");return{BokehPass:i}},__vite__mapDeps([7,1])),s=new n(t,e,{});return jt(s,["focus","aperture","aspect"]),s}async function wh(){const{AfterimagePass:t}=await D(async()=>{const{AfterimagePass:n}=await import("./f_DLksWAt5-AfterimagePass.js");return{AfterimagePass:n}},__vite__mapDeps([8,1])),e=new t(.7);return jt(e,["damp"]),e}function bh(t){const{name:e,type:n}=t,s=Zn[n].propList??[],r={};return s.forEach(o=>{Object.defineProperty(r,o,{get(){return t[o]},set(a){t[o]=a},enumerable:!0})}),{target:t,name:e,type:n,params:r,id:qn()}}const Zn={bloom:{name:"Bloom",propList:["enabled","radius","strength","threshold"]},pixel:{name:"Pixelate",propList:["enabled","size"]},afterimage:{name:"Afterimage",propList:["enabled","damp"]},sobel:{name:"Sobel",propList:["enabled"]},halftone:{name:"Halftone",propList:["enabled","greyscale","radius","scatter","shape"]},dotscreen:{name:"Dot Screen",propList:["enabled","scale"]},bokeh:{name:"Bokeh",propList:["enabled","focus","aperture","aspect"]},smaa:{name:"SMAA",propList:["enabled"]}},kf=Object.entries(Zn).map(([t,{name:e}])=>({value:t,label:e}));var eo={exports:{}};(function(t,e){(function(n,s){t.exports=s()})(Le,function(){var n=function(){function s(p){return o.appendChild(p.dom),p}function r(p){for(var d=0;d<o.children.length;d++)o.children[d].style.display=d===p?"block":"none";i=p}var i=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(p){p.preventDefault(),r(++i%o.children.length)},!1);var a=(performance||Date).now(),c=a,u=0,h=s(new n.Panel("FPS","#0ff","#002")),l=s(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=s(new n.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:s,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){u++;var p=(performance||Date).now();if(l.update(p-a,200),p>c+1e3&&(h.update(1e3*u/(p-c),100),c=p,u=0,f)){var d=performance.memory;f.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return p},update:function(){a=this.end()},domElement:o,setMode:r}};return n.Panel=function(s,r,i){var o=1/0,a=0,c=Math.round,u=c(window.devicePixelRatio||1),h=80*u,l=48*u,f=3*u,p=2*u,d=3*u,_=15*u,g=74*u,y=30*u,v=document.createElement("canvas");v.width=h,v.height=l,v.style.cssText="width:80px;height:48px";var m=v.getContext("2d");return m.font="bold "+9*u+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=i,m.fillRect(0,0,h,l),m.fillStyle=r,m.fillText(s,f,p),m.fillRect(d,_,g,y),m.fillStyle=i,m.globalAlpha=.9,m.fillRect(d,_,g,y),{dom:v,update:function(w,P){o=Math.min(o,w),a=Math.max(a,w),m.fillStyle=i,m.globalAlpha=1,m.fillRect(0,0,h,_),m.fillStyle=r,m.fillText(c(w)+" "+s+" ("+c(o)+"-"+c(a)+")",f,p),m.drawImage(v,d+u,_,g-u,y,d,_,g-u,y),m.fillRect(d+g-u,_,u,y),m.fillStyle=i,m.globalAlpha=.9,m.fillRect(d+g-u,_,u,c((1-w/P)*y))}}},n})})(eo);var Eh=eo.exports;const Sh=ai(Eh);var to={exports:{}};(function(t,e){(function(n,s){s()})(Le,function(){function n(u,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function s(u,h,l){var f=new XMLHttpRequest;f.open("GET",u),f.responseType="blob",f.onload=function(){c(f.response,h,l)},f.onerror=function(){console.error("could not download file")},f.send()}function r(u){var h=new XMLHttpRequest;h.open("HEAD",u,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Le=="object"&&Le.global===Le?Le:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(u,h,l){var f=o.URL||o.webkitURL,p=document.createElement("a");h=h||u.name||"download",p.download=h,p.rel="noopener",typeof u=="string"?(p.href=u,p.origin===location.origin?i(p):r(p.href)?s(u,h,l):i(p,p.target="_blank")):(p.href=f.createObjectURL(u),setTimeout(function(){f.revokeObjectURL(p.href)},4e4),setTimeout(function(){i(p)},0))}:"msSaveOrOpenBlob"in navigator?function(u,h,l){if(h=h||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,l),h);else if(r(u))s(u,h,l);else{var f=document.createElement("a");f.href=u,f.target="_blank",setTimeout(function(){i(f)})}}:function(u,h,l,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof u=="string")return s(u,h,l);var p=u.type==="application/octet-stream",d=/constructor/i.test(o.HTMLElement)||o.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||p&&d||a)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var m=g.result;m=_?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=m:location=m,f=null},g.readAsDataURL(u)}else{var y=o.URL||o.webkitURL,v=y.createObjectURL(u);f?f.location=v:location.href=v,f=null,setTimeout(function(){y.revokeObjectURL(v)},4e4)}});o.saveAs=c.saveAs=c,t.exports=c})})(to);var Qn=to.exports;const Ph=["video/mp4;codecs=h264","video/webm;codecs=h264","video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm"],ft=Ph.filter(MediaRecorder.isTypeSupported);function xh(t){if(!ft.length)return;const e=[],n=ft[0],s={settings:{...Ql,mimeType:n},get supportedMimeTypes(){return ft},get mimeType(){return this.settings.mimeType},set mimeType(r){ft.includes(r)&&(this.settings.mimeType=r)},start(){if(this.recorder)return;const{fileName:r,frameRate:i,mimeType:o}=this.settings,a=t.captureStream(i||30),c=a.getTracks()[0],u=new MediaRecorder(a,{mimeType:o});u.onstart=()=>e.length=0,u.ondataavailable=({data:h})=>e.push(h),u.onstop=()=>{c.stop(),this.recorder=void 0;const h=this.settings.mimeType.includes("webm")?"webm":"mp4",l=new Blob(e,{type:`video/${h}`}),f=this.settings.appendDate?`_${kl()}`:"",p=`${r||"ani"}${f}.${h}`;Qn.saveAs(l,p)},u.start(),this.recorder=u},get state(){var r;return((r=this.recorder)==null?void 0:r.state)??"idle"}};return["pause","resume","stop"].forEach(r=>{Object.defineProperty(s,r,{value:()=>{var i;return(i=s.recorder)==null?void 0:i[r]()}})}),s}function Th(t){let e=1,n=!1,s=!1;const r=()=>{t.stats.begin(),t.controls.update();const u=n?-e:e,h=t.clock.getDelta()*u;s||t.update(h),t.render(),t.stats.end()};let i=!1;const o=()=>{i||(t.render(),i=!0,setTimeout(()=>i=!1,50))};let a="";return{start(){a!=="active"&&(t.renderer.setAnimationLoop(r),t.controls.removeEventListener("change",o),a="active")},stop(){a!=="inactive"&&(t.renderer.setAnimationLoop(null),t.controls.addEventListener("change",o),a="inactive")},pause(){s=!0},resume(){s=!1},get state(){return a},get timeScale(){return e},set timeScale(u){const h=parseFloat(u);e=isNaN(h)?1:Math.abs(h)},get reverse(){return n},set reverse(u){n=!!u},get paused(){return s},set paused(u){s=!!u}}}const Ah=async t=>{const{zip:e}=await D(async()=>{const{zip:n}=await import("./f_BtwqvtBK-browser.js");return{zip:n}},[]);return new Promise(n=>e(t,{},(s,r)=>n(new Blob([r]))))},Mh=t=>{const e=t.indexOf(",");return t.slice(e+1,1/0)},Ch=async t=>{if(t=await t,t instanceof Blob&&(t=await t.arrayBuffer()),t instanceof ArrayBuffer)return new Uint8Array(t);if(typeof t=="string"){const e=t.startsWith("data")?Mh(t):t,n=window.atob(e);return Uint8Array.from(n,s=>s.charCodeAt(0))}};async function Dh(t){const e=await Promise.all(t.map(({data:s})=>Ch(s))),n=Object.fromEntries(t.map(({name:s},r)=>[s,[e[r],{level:0,consume:!0}]]));return Ah(n)}async function Lh(t,e){const n=t.length.toString().length,s=t.map((r,i)=>{const o=i.toString().padStart(n,"0");return{name:`${e||"ss"}_${o}.png`,data:r}});return Dh(s)}function kh(t,e){const n=document.createElement("a");n.style.display="none",n.href=t,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}async function Tn(t,e="frames"){const n=await Lh(t,e);Qn.saveAs(n,`${e}.zip`)}function Oh(t){const{canvas:e,scene:n}=t;return{settings:Zl,downloadFrame(r=1){const{noBackground:i,fileName:o}=this.settings,a=i&&!t.postProcessing.enabled;let c=null;const u=()=>[n.background,c]=[c,n.background];if(t.loop.state==="inactive"||r===1){a&&u(),t.render();const p=e.toDataURL();a&&u(),kh(p,`${o}.png`),t.render();return}let h=0;const l=[];a&&t.addCountedEventListener("beforeRender",u);function f(){const p=e.toDataURL("image/png");l.push(p),++h===r&&(a&&t.addCountedEventListener("beforeRender",u),Tn(l,o))}t.addCountedEventListener("afterRender",f,r)},getFrame(){let r;const{noBackground:i}=this.settings;if(i&&!t.postProcessing.enabled){let a=null;[n.background,a]=[a,n.background],t.render(),r=e.toDataURL("image/png"),[n.background,a]=[a,n.background],t.render()}else t.render(),r=e.toDataURL("image/png");return r},getAllFrames(r){var d,_;const i=r==null?void 0:r.animation.current.chainName;if(!i||r.animation.chain[i].duration===1/0)return;console.info("main thread locked");const a=t.loop.state;t.loop.stop(),(_=(d=r.face)==null?void 0:d.reset)==null||_.call(d),r.animation.stop();const c=[],{frameRate:u,noBackground:h}=this.settings,l=1/(u||30);let f=null,p=!0;for(h&&([n.background,f]=[f,n.background]),r.animation.addCountedEventListener("chainFinished",()=>p=!1),r.animation.play();p;){t.update(l);const g=e.toDataURL();c.push(g)}return console.info("main thread unlocked"),h&&([n.background,f]=[f,n.background]),a==="active"&&t.loop.start(),c},downloadAllFrames(r=0){const i=t.model[r],o=this.getAllFrames(i),{fileName:a}=this.settings;Tn(o,a)},getAllFramesAsArrayBuffer(r){var m,w;const i=r==null?void 0:r.animation.current.chainName;if(!i||r.animation.chain[i].duration===1/0)return;console.info("main thread locked");const a=t.renderer.getContext(),c=t.loop.state;(w=(m=r.face)==null?void 0:m.reset)==null||w.call(m),t.loop.stop(),r.animation.stop();const u=[],{frameRate:h,noBackground:l}=this.settings,f=1/(h||30),{width:p,height:d}=e,g=p*d*4;let y=null,v=!0;for(l&&([n.background,y]=[y,n.background]),r.animation.addCountedEventListener("chainFinished",()=>v=!1),r.animation.play();v;){t.update(f);const P=new Uint8Array(g);a.readPixels(0,0,p,d,a.RGBA,a.UNSIGNED_BYTE,P);const S=Rh(P,{width:p,height:d});u.push(S.buffer)}return console.info("main thread unlocked"),l&&([n.background,y]=[y,n.background]),c==="active"&&t.loop.start(),u}}}function Rh(t,{width:e,height:n}){const s=n/2|0,r=e*4,i=new Uint8Array(e*4);for(let o=0;o<s;++o){const a=o*r,c=(n-o-1)*r;i.set(t.subarray(a,a+r)),t.copyWithin(a,c,c+r),t.set(i,c)}return t}const Ih=()=>Promise.all([tu(),nu(),ru(),du()]),Fh={directional:gr,ambient:vr,point:cn},Bh={directional:sa,point:ra},jh=t=>{var c,u;const e=Fh[t];if(!e)return null;const n=Jl[t],{color:s,intensity:r,...i}=n,o=new e(s,r);o.name=(u=(c=o.type)==null?void 0:c.replace)==null?void 0:u.call(c,"Light","");const a=Bh[t];return a&&(o.helper=new a(o),Object.defineProperty(o,"showHelper",{get(){return o.helper.visible},set(h){o.helper.visible=!!h,o.helper.update()}}),o.showHelper=!1),Object.defineProperty(o,"colorCode",{get(){return"#"+this.color.getHexString()},set(h){var l,f;this.color=new $(h),(f=(l=this.helper)==null?void 0:l.update)==null||f.call(l)}}),Object.entries(i).forEach(([h,l])=>{o[h].isVector3?o[h].set(...l):o[h]=l}),o};function Nh(t){const e={list:new fe,add:n=>{const s=jh(n);if(s)return t.scene.add(s),s.helper&&(t.scene.add(s.helper),s.helper.update()),e.list.push(s),s.remove=()=>{var r,i,o,a,c;e.list.remove(s),s.helper&&((r=s.parent)==null||r.remove(s.helper),(o=(i=s.helper).dispose)==null||o.call(i)),(a=s.parent)==null||a.remove(s),(c=s.dispose)==null||c.call(s)},s}};return e}const or={"<":">","(":")","[":"]","{":"}"},$h=t=>{let e="";const n=[],s=[];for(const r of t){if(n.length){e+=r;const i=n.at(-1);r===or[i]&&n.pop();continue}if(r==="/"){e&&s.push(e),e="";continue}e+=r,r in or&&n.push(r)}return e&&s.push(e),s},no=t=>$h(t).reduce((n,s)=>{const[r,...i]=s.split("="),o=i==null?void 0:i.join("=");return r&&o&&n.push([r,o]),n},[]),Uh={mat:{keys:["material","code"],valueMap:t=>t.slice(1,-1)},ol:{keys:["outline","code"],valueMap:t=>t.slice(1,-1)},ei:{keys:["face","eyeBaseIdx"]},et:{keys:["face","eyeTexture"]},mi:{keys:["face","mouthBaseIdx"]},mt:{keys:["face","mouthTexture"]},tx:{keys:["texture"]},scl:{keys:["scale"]}};async function zh(t){const e=no(t),n=Object.fromEntries(e),{id:s}=n,r=await this.loadDLModel(s);return await Vh(r,n),r}async function Vh(t,e){const{ani:n,...s}=e;Object.entries(s).forEach(([r,i])=>{const o=Uh[r];if(!o)return;const{keys:a,valueMap:c}=o,u=(c==null?void 0:c(i))??i;Ni(t,a,u)}),n&&await t.animation.addChain(n)}const xt=class xt{constructor(){ee(this,"userData",{ani:new fe});ee(this,"dataLoaded",!1);ee(this,"initData",async()=>{await Ih(),this.dataLoaded=!0,this.dispatchEvent({type:"dataLoaded"})});ee(this,"_background","");ee(this,"model",new fe);ee(this,"loadedModel",new fe);ee(this,"loadModelFromCode",zh);ee(this,"settings",{outline:ke,material:ve});ee(this,"viewport",{width:0,height:0,set(e,n){this.width=e,this.height=n}});Object.assign(this,it);const e=new ia;this.scene=e,this.background=Kl,this.clock=new Sr;const n=Al();this.camera=n;const s=Nh(this);s.add("directional"),s.add("ambient"),this.light=s;const r=Tl();this.renderer=r,this.canvas=r.domElement,this.screenshot=Oh(this),this.record=xh(this.canvas),this.controls=new wc(this.camera,this.canvas),this.postProcessing={enabled:!1,passes:new fe,composer:ir({renderer:r,scene:e,camera:n}),async addPass(i,o={}){const a=await fh(i,{...o,renderer:r,scene:e,camera:n});this.composer.addPass(a);const c=bh(a),{passes:u}=this,h=this;return c.remove=()=>{u.remove(c),h.refresh()},u.push(c),a},async refresh(){this.composer=ir({renderer:r,scene:e,camera:n});const i=this.passes.map(({type:a,params:c})=>({type:a,params:Object.entries(c)}));this.passes.length=0;const{length:o}=i;for(let a=0;a<o;a++){const{type:c,params:u}=i[a],h=await this.addPass(c);u.forEach(([l,f])=>void(h[l]=f))}},updatePasses(i){this.passes.length=0,this.passes.splice(0,0,...i),this.refresh()}},this.stats=new Sh,this.loop=Th(this),this.loop.start(),console.info("%cDragalia Lost Model Viewer","color:yellow;background-color:black;font-size:1.5rem;text-shadow: 0 0 0.5rem white")}get background(){return this._background}set background(e){var s,r;if(this._background===e)return;this._background="loading",(r=(s=this.scene.background)==null?void 0:s.dispose)==null||r.call(s);const n=this;(async function(){n.scene.background=await Ml(e),n._background=e,e.startsWith("img:")&&n.updateBgAspectRatio()})()}get toneMapping(){var n;const{toneMapping:e}=this.renderer;return((n=Object.entries(sn).find(([,s])=>s===e))==null?void 0:n[0])??"Unknown"}set toneMapping(e){const n=sn[e]?e:"No Mapping";this.renderer.toneMapping=sn[n]}get pixelRatio(){return this.renderer.getPixelRatio()}set pixelRatio(e){this.renderer.setPixelRatio(e),this.postProcessing.composer.setPixelRatio(e)}get unusedModel(){return this.loadedModel.filter(e=>!this.model.includes(e))}async loadDLModel(e=ql){this.dataLoaded||await new Promise(o=>this.addCountedEventListener("dataLoaded",o));const n=xt.getModelPath(e),s=await Fi(n);s.name=e;const r={id:e,outline:this.settings.outline,material:this.settings.material,viewer:this},i=th(s,r);return this.loadedModel.push(i),i.addEventListener("dispose",()=>this.loadedModel.remove(i)),i}add(e){var n;(n=e.detach)==null||n.call(e),this.model.push(e),this.scene.add(e.model),e.parent=this}remove(e){this.model.remove(e),this.scene.remove(e.model)}disposeAllModels(){this.loadedModel.forEach(e=>{var n;return(n=e.dispose)==null?void 0:n.call(e)}),this.model.length=0}static getModelPath(e){return`${this.source.fbx}/${e}/${e}.fbx`}async setViewport(e,n){var o;await Sl(200);const s=e??window.innerWidth,r=n??window.innerHeight;this.viewport.set(s,r),this.renderer.setSize(s,r);const i=s/r;return this.camera.aspect=i,this.camera.updateProjectionMatrix(),(o=this.postProcessing.composer)==null||o.setSize(s,r),this.background.startsWith("img:")&&this.updateBgAspectRatio(),this}updateBgAspectRatio(){if(!this.background.startsWith("img:"))return;const{width:e,height:n}=this.viewport,s=e/n,{background:r}=this.scene,{naturalWidth:i,naturalHeight:o}=r.image,a=i/o,c=s/a,u=s>a?[1,1/c]:[c,1];r.repeat.set(...u)}update(e){var n;(n=this.animation)==null||n.update(e),this.model.forEach(s=>{var r;return(r=s.update)==null?void 0:r.call(s,e)}),this.loop.state==="inactive"&&this.render(),this.dispatchEvent({type:"timeUpdate",dt:e})}stopAll(){this.model.forEach(e=>{var n,s;return(s=(n=e.animation)==null?void 0:n.stop)==null?void 0:s.call(n)})}playAll(){this.model.forEach(e=>{var n,s;return(s=(n=e.animation)==null?void 0:n.play)==null?void 0:s.call(n)})}render(){this.dispatchEvent({type:"beforeRender"}),this.postProcessing.enabled?this.postProcessing.composer.render():this.renderer.render(this.scene,this.camera),this.dispatchEvent({type:"afterRender"})}toString(){return"Dragalia Lost Model Viewer"}dispose(){var e,n,s;this.model.forEach(r=>r.dispose()),(n=(e=this.scene.background)==null?void 0:e.dispose)==null||n.call(e),(s=this.renderer.renderLists)==null||s.dispose(),this.renderer.dispose()}};ee(xt,"source",{fbx:Si,ani:Pi});let Pt=xt;var K={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},ar=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],cr=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],lr=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],W=typeof window<"u"&&typeof window.document<"u"?window.document:{},Z="fullscreenEnabled"in W&&Object.keys(K)||ar[0]in W&&ar||cr[0]in W&&cr||lr[0]in W&&lr||[],pt={requestFullscreen:function(t){return t[Z[K.requestFullscreen]]()},requestFullscreenFunction:function(t){return t[Z[K.requestFullscreen]]},get exitFullscreen(){return W[Z[K.exitFullscreen]].bind(W)},get fullscreenPseudoClass(){return":"+Z[K.fullscreen]},addEventListener:function(t,e,n){return W.addEventListener(Z[K[t]],e,n)},removeEventListener:function(t,e,n){return W.removeEventListener(Z[K[t]],e,n)},get fullscreenEnabled(){return!!W[Z[K.fullscreenEnabled]]},set fullscreenEnabled(t){},get fullscreenElement(){return W[Z[K.fullscreenElement]]},set fullscreenElement(t){},get onfullscreenchange(){return W[("on"+Z[K.fullscreenchange]).toLowerCase()]},set onfullscreenchange(t){return W[("on"+Z[K.fullscreenchange]).toLowerCase()]=t},get onfullscreenerror(){return W[("on"+Z[K.fullscreenerror]).toLowerCase()]},set onfullscreenerror(t){return W[("on"+Z[K.fullscreenerror]).toLowerCase()]=t}};const I=new Pt;I.initData();I.setViewport();I.userData.specialCapture={frameRate:30,duration:5,program:"rotate"};window.addEventListener("resize",()=>I.setViewport());I.canvas.addEventListener("dblclick",Hh);window.viewer=I;window.model=I.model;window.getFrame=I.screenshot.getFrame;window.downloadFrames=Tn;window.saveAs=Qn.saveAs;window.THREE=br;window.makeGif=async t=>{const{makeGif:e}=await D(async()=>{const{makeGif:n}=await import("./f_DOqUXJZN-index.js");return{makeGif:n}},[]);return await e(t)};function Hh(){pt.fullscreenEnabled&&(pt.fullscreenElement?pt.exitFullscreen():pt.requestFullscreen(I.canvas))}function Wh(){try{return window.self!==window.top}catch{return!0}}let ur="";const so=Wh(),Gh=so?!1:!window.location.hash.includes("showSettings=false"),Xh=so?!1:!window.location.hash.includes("showAC=false"),Kh=t=>({showSettings:Gh,toggleSettings:()=>t(e=>{e.showSettings=!e.showSettings}),loadingMsg:"",setLoadingMsg:e=>t(n=>{n.loadingMsg=e}),showTimeControl:Xh,toggleTimeControl:()=>t(e=>{e.showTimeControl=!e.showTimeControl}),showFrameRate:!1,toggleFrameRate:()=>t(e=>{e.showFrameRate=!e.showFrameRate}),sidebar:{open:!0,toggle:()=>t(e=>{e.sidebar.open=!e.sidebar.open}),settings:{tab:"Model",setTab:e=>t(n=>{n.sidebar.settings.tab=e})},modal:{mode:"",handleSelect:void 0,open:(e,n)=>{ur=I.loop.state,I.loop.stop(),t(s=>{s.sidebar.modal.mode=e,s.sidebar.modal.handleSelect=n})},close:()=>{ur==="active"&&I.loop.start(),t(e=>{e.sidebar.modal.mode="",e.sidebar.modal.handleSelect=void 0})}},manageMode:"single",setManageMode:e=>t(n=>{n.sidebar.manageMode=e})},chainMaker:{target:null,setTarget:e=>t(n=>{n.chainMaker.target=e})},dock:{mode:"",handleSelect:void 0,open:(e="",n)=>t(s=>{s.dock.mode=e,s.dock.handleSelect=n}),close:()=>t(e=>{e.dock.mode="",e.dock.handleSelect=void 0})}}),Yh=G(()=>D(()=>import("./f_B1vgPWtx-index.js"),__vite__mapDeps([9,10,11,12,13,14,15,16,17,18,19,20,21,1,22]))),qh=G(()=>D(()=>import("./f_C9kc3U3P-index.js"),__vite__mapDeps([23,24,14,12,11,13,15,16,25,26,27,28,29,30,31,32,33,34,1]))),Zh=G(()=>D(()=>import("./f_CKgUgUAW-index.js"),__vite__mapDeps([35,24,14,12,11,13,15,16,25,26,36,37,10,19,38,39,40,28,29,41,42,21,43,44,1,45,33]))),Qh=G(()=>D(()=>import("./f_CWMqWcLh-index.js"),__vite__mapDeps([46,24,14,12,11,13,15,16,25,26,27,28,29,30,34,43,38,1,47,33]))),Jh=G(()=>D(()=>import("./f_BFqT42-W-ColorSelect.js"),__vite__mapDeps([48,17,18,19,12,20,15,1]))),ef=G(()=>D(()=>import("./f_3zBysd7_-index.js"),__vite__mapDeps([49,42,50,40,28,29,41,51,16,12,15,19,52,1,53]))),tf=G(()=>D(()=>import("./f_BvUYvCkf-index.js"),__vite__mapDeps([54,43,24,14,12,11,13,15,16,25,26,50,40,28,29,41,27,30,31,32,33,1]))),nf=G(()=>D(()=>import("./f_DAg0cFZL-index.js"),__vite__mapDeps([55,42,36,37,56,38,57,43,14,12,58,27,11,13,15,16,28,29,24,25,26,30,18,19,59,49,50,40,41,51,52,1,53,54,31,32,33,46,34,47,60,61]))),hr=G(()=>D(()=>import("./f_BbccsLxF-index.js"),__vite__mapDeps([62,51,16,12,15,19,52,1,63]))),sf=G(()=>D(()=>import("./f_BO_bSUkP-index.js"),__vite__mapDeps([64,42,57,43,14,12,58,38,19,44,15,16,1,65,33]))),fr={background:Yh,model:qh,animation:Zh,weapon:Qh,color:Jh,face:ef,faceTexture:tf,attachment:nf,target:sf,eye:({onSelect:t})=>ne(hr,{part:"eye",onSelect:t}),mouth:({onSelect:t})=>ne(hr,{part:"mouth",onSelect:t})},rf=(t,e)=>({Component:void 0,props:void 0,openModal:(n,s)=>t(r=>{r.props=s,r.Component=n}),close:()=>t(n=>{n.Component=void 0}),onClose:void 0,reset:()=>t(n=>{n.Component=n.props=n.onClose=void 0}),getInput:async n=>{if(!fr[n])return null;const{close:s,reset:r}=e(),i=new Promise((o,a)=>{const c=(...u)=>o(u);t(u=>{u.onClose=()=>{a(),s()},u.props={onSelect:c,onAfterSelect:s},u.Component=fr[n]})});try{return await i}catch{return null}finally{r()}},inputModel:()=>e().getInput("model"),inputAni:()=>e().getInput("animation"),inputColor:async()=>{const n=await e().getInput("color");return n==null?void 0:n[0]},inputTarget:()=>e().getInput("target"),inputEye:()=>e().getInput("eye"),inputMouth:()=>e().getInput("mouth")}),of=t=>({activeModel:void 0,setActiveModel:e=>t({activeModel:e})}),af=t=>({open:!1,toggle:()=>t(e=>({open:!e.open})),target:null,setTarget:e=>{e&&(e.userData.chain||(e.userData.chain=new fe),t({target:e}))}}),cf=t=>(e,n,s)=>t(r=>e(gc(r)),n,s),ot=t=>Hn(cf(t)),An=ot(Kh),Of=ot(wi),Rf=ot(wi),lf=ot(yc),If=ot(rf),Ff=Hn(of),Bf=Hn(af);function uf(t){return new Worker("/dl-model/assets/fetchWorker-DnsFcaV4.js",{name:t==null?void 0:t.name})}const hf=t=>{const e=new uf;return new Promise(n=>{e.addEventListener("message",s=>{e.terminate(),n(s.data)}),e.postMessage(t)})};function ro(t){return new Worker("/dl-model/assets/dbWorker-Cxbauwi9.js",{name:t==null?void 0:t.name})}const io=(t,e)=>{const n=new ro;return new Promise(s=>{n.addEventListener("message",()=>{s(),n.terminate()}),n.postMessage({type:"put",store:e,value:t})})};function ff(t){return new Worker("/dl-model/assets/searchWorker-FW25Qm2l.js",{name:t==null?void 0:t.name})}async function pf(t,e="",n=["name"]){if(!e||!n.length)return t;const s=new ff;return new Promise(r=>{s.addEventListener("message",i=>{s.terminate(),r(i.data)}),s.postMessage({fullList:t,query:e,keys:n})})}const jf=async t=>{const e=Object.values(t).flat();await io(e,"model"),console.info("Model DB Initialized")},Nf=t=>Nt({type:"get",store:"model",value:t}),$f=t=>Nt({type:"search",store:"model",index:"name",value:t}),Uf=async t=>{const n=(await Nt({type:"getByKeyRange",store:"model",value:"c100000_00-c199999_99"})).filter(({id:s})=>!s.endsWith("h"));return pf(n,t)},df=()=>Nt({type:"getMap",store:"model",index:"name"}),Nt=t=>{const e=new ro;return new Promise(n=>{e.addEventListener("message",s=>{e.terminate(),n(s.data)}),e.postMessage(t)})},Je={},mf=async()=>{if(Object.keys(Je).length)return;const t="ani-personal",e=(await hf([t]))[t];Object.assign(Je,e)},oo=mf(),zf=t=>Je[t],_f=t=>{var e;return((e=Je[t])==null?void 0:e[0])??(t.startsWith("c")?{name:"Bob",code:"CMN_MWM_03"}:null)},Vf=async()=>{const t=await df();await oo;const e=Object.entries(Je).flatMap(([n,s])=>{const r=t.get(n);return s.map(i=>({...i,user:n,fullName:`${r} ${i.name}`}))});await io(e,"animation")},gf="cccccc",yf="c100001_01",pr=(t,e="Unknown")=>{const n=Qi(t),{length:s}=n,r=n.map((i,o)=>{const{aniName:a,reps:c=1,timeScale:u=1,duration:h=[0,100],aniAction:l}=i,f=s>1?e+` #${o+1}`:e;return{id:qn(),name:f,aniName:a,reps:c,timeScale:u,duration:h,aniAction:l}});return fe.from(r)},dr={ts:{key:"timeScale",defaultValue:1},r:{key:"reps",defaultValue:1}},vf={"face.eyeIdx":"ei","face.mouthIdx":"mi"},Hf=t=>t.map(wf).join(">"),wf=t=>{const{aniName:e}=t,n=bf(t),s=Ef(t),r=Sf(t);return`${e}${n}${s}${r}`},bf=t=>{const e=[];return Object.keys(dr).forEach(n=>{const{key:s,defaultValue:r}=dr[n];t[s]&&t[s]!==r&&e.push(`&${n}=${t[s]}`)}),e.join("")},Ef=t=>{const{duration:e=[0,100]}=t,[n,s]=e;return n!==0?`&dur=${n}-${s}`:s===100?"":`&dur=${s}`},Sf=t=>{const{aniAction:e}=t;return e.length?"&"+e.map(s=>{const{time:r,...i}=s,o=Object.entries(i).map(([a,c])=>`${vf[a]??a}=${c}`);return`@${r}=(${o.join("/")})`}).join("&"):""};function Pf(t){if(!(t!=null&&t.userData))return;const{type:e,id:n}=t,{name:s}=t.userData;t.userData.aniSelectState={category:e==="adventurer"?"Adv":"Personal",personalAni:{source:n,sourceName:s}}}function on(){const t=decodeURI(window.location.hash),e=no(t),n=Object.fromEntries(e);xf(n),Tf(t)}function xf(t){const{bg:e=gf,showAC:n="true",showSettings:s="true"}=t;I.background=e,An.setState({showTimeControl:Hs(n)}),An.setState({showSettings:Hs(s)})}async function Tf(t){I.disposeAllModels(),setTimeout(async()=>{const e=t.includes("id=")?t:t+`/id=${yf}`,n=await I.loadModelFromCode(e);I.add(n);const s=n.type==="adventurer"?"Adv":"Personal";lf.getState().setCategory(s),Pf(n);const{id:r}=n;if(!t.includes("camPos=")){const o=su(r);I.camera.position.set(...o)}const i=iu(r);if(I.controls.target.set(...i),t.includes("ani=")){const o=n.animation.current.chainCode??"";o&&(n.userData.chain=pr(o,"init"))}else{const o=_f(r);if(o){const{code:a,name:c}=o;n.animation.addChain(a),n.userData.chain=pr(a,c)}}})}const Af=G(()=>D(()=>import("./f_BFeFBPCO-index.js"),__vite__mapDeps([66,14,12,56,38,57,43,58,27,11,13,15,16,28,29,24,25,26,30,18,19,59,42,49,50,40,41,51,52,1,53,54,31,32,33,46,34,47,60,10,39,67]))),Mf=G(()=>D(()=>import("./f_C6t83psC-index.js"),__vite__mapDeps([68,43,28,29,19,12,13,59,14,25,1,69])));function Cf(){const t=Oa(),e=Ne(),n=Ne(),{loadingMsg:s,showTimeControl:r,showSettings:i,showFrameRate:o}=An();return Se(()=>(t&&oo.then(on),window.addEventListener("hashchange",on),()=>window.removeEventListener("hashchange",on))),Se(()=>{e.current.appendChild(I.canvas),I.stats.dom.style.position="",n.current.appendChild(I.stats.dom)},[]),ne(oe,{children:[i&&ne(be,{fallback:null,children:ne(Af,{})}),ne("div",{className:"mount",ref:a=>e.current=a}),ne("div",{className:"stats",style:{display:o?"unset":"none"},ref:a=>n.current=a}),s&&ne("div",{className:"loading-msg",children:s}),r&&ne(be,{fallback:null,children:ne(Mf,{})})]})}Be(ne(Cf,{}),document.getElementById("app"));export{iu as $,Ne as A,kn as B,nh as C,gc as D,Wr as E,oh as F,Ir as G,lf as H,zf as I,rl as J,ka as K,be as L,Hn as M,Ur as N,Bf as O,Bt as P,pr as Q,oi as R,ai as S,nt as T,He as U,le as V,fr as W,Pf as X,_f as Y,su as Z,D as _,Ff as a,sn as a0,Mt as a1,ni as a2,Zn as a3,kf as a4,Yl as a5,Qn as a6,Ys as a7,Lh as a8,Dh as a9,Hf as aa,qn as ab,hf as ac,jf as ad,oo as ae,Vf as af,Oa as ag,Le as ah,ui as ai,wt as aj,ie as ak,Rf as al,Uf as am,If as b,pf as c,Of as d,Nt as e,G as f,El as g,tt as h,st as i,oe as j,$r as k,An as l,Rn as m,Nf as n,Vn as o,io as p,On as q,Qs as r,$f as s,Si as t,ne as u,I as v,sr as w,Nr as x,Se as y,Jr as z};
