import{u as e,M as k,d as B,y as C,s as S,c as D,v as F,W as N,a as G,al as L}from"./index-Bxk9gsMd.js";import{L as M,u as R,S as T}from"./f_B6cF9osK-lists.js";import{f as j,B as $,F as E,a as H}from"./f_CIt6gNH2-filterConfig.js";import{G as P}from"./f_fYmMpGj2-GlowToggle.js";import{g as q}from"./f_ByWS9i95-index.js";import{u as z,G as O}from"./f_pkdH7UDS-Gallery.js";import{u as y}from"./f_BCeES2zt-useToggleState.js";/* empty css                 */import{M as Q}from"./f_CJKROQZd-ModelIcon.js";import{B as x}from"./f_oPI5wd9B-Box.js";import{D as V,a as Y}from"./f_BT01mNLK-DialogTitle.js";import{I as J}from"./f_CkRvuOJA-Close.js";import"./f_BM_tZNm2-three.js";import"./f_DA9fToc7-createSvgIcon.js";import"./f_PbtmiqRp-CircularProgress.js";import"./f_aCkP4a87-Popover.js";const h={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh","& svg":{color:"rgba(16, 16, 16, 0.8)"}},top:{display:"flex",flexWrap:"wrap",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)"},searchFilter:{marginTop:"0.2rem",display:"flex",flexDirection:"column",width:"100%",minWidth:"20rem",alignItems:"center",justifyContent:"center","& .MuiTextField-root":{justifyContent:"center"}},search:{display:"flex",width:"100%",justifyContent:"center"},title:{padding:"0.5rem 1rem",textAlign:"center",flexGrow:.1,margin:"auto"},content:{padding:"0.3rem",textAlign:"center",minHeight:"60vh"}},I=[{value:"weapon",label:"Weapon",icon:"img/appIcon/weapon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"},{value:"extra",label:"Extra"}]},{value:"chara",label:"Adventurer",icon:"img/appIcon/chara.png",options:[{value:"regular",label:"Regular"},{value:"allies",label:"Allies"},{value:"enemies",label:"Enemies"}]},{value:"dragon",label:"Dragon",icon:"img/appIcon/dragon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"}]},{value:"boss",label:"Boss",icon:"img/appIcon/boss.png",options:[{value:"archdemon",label:"Archdemon",icon:"img/appIcon/archdemon.png"},{value:"agito",label:"Agito",icon:"img/appIcon/agito.png"},{value:"raid",label:"Raid",icon:"img/appIcon/raid.png"},{value:"void",label:"Void",icon:"img/appIcon/void.png"},{value:"others",label:"Others"}]}],K=o=>{let n=I;const t=[];return o.forEach(d=>{const a=n[d],i=a?.value;i!==void 0&&(t.push(i),n=a.options)}),t.join("-")},U={Left:"⇐",Right:"⇒"},w=({side:o,onClick:n})=>e("div",{className:"WeaponButton-addBtn","data-side":o,onClick:n,children:U[o]}),X=o=>o.stopPropagation();function Z({id:o,name:n,noIcon:t,onClick:d}){const[a,i]=y(!1),[l,p]=y(!1),f=!t&&e(Q,{modelId:o,className:"WeaponButton-icon"}),u=a&&e("div",{className:"WeaponButton-grip",onClick:X,children:[e("input",{type:"checkbox",id:`grip-${o}`,checked:l,onChange:p}),e("label",{htmlFor:`grip-${o}`,children:"Reverse Grip"})]}),g=r=>{r.stopPropagation();const{side:s}=r.currentTarget.dataset;d({side:s,id:o,name:n,reverse:l})};return e("div",{className:"WeaponButton",children:[f,a?e("div",{className:"WeaponButton-add",onClick:i,children:[u,e("div",{className:"WeaponButton-addBtnGroup",children:[e(w,{side:"Left",onClick:g}),e("div",{children:"ADD"}),e(w,{side:"Right",onClick:g})]})]}):e("div",{className:"WeaponButton-name",onClick:i,children:n})]})}const _=[];function ee({target:o,content:n,searchQuery:t,searchAll:d,filter:a=_}){const i=z(r=>r[n])??[],[l,p]=B([]),[f,u]=B(!1);return C(()=>p(i),[n]),C(()=>{u(!0);async function r(){if(d)return t?await S(t):i;const s=await D(i,t);return await j(s,a)}setTimeout(async()=>{const s=await r();p(s),u(!1)})},[t,a,d]),f?e(M,{}):e(O,{list:l,component:Z,onClick:async({side:r,id:s,name:v,reverse:b})=>{const m=`jWeapon${r[0]}`;if(!o?.bones.list.includes(m))return;const c=await F.loadDLModel(s);c.userData.name=v,b&&(c.rotation.y=Math.PI),o.attachment[m]?.forEach(W=>W.dispose()),o.attach(c,m),c.outline.code=o.outline.code,c.material.code=o.material.code,N(c)}})}const oe=k(ee),A=[];function be({target:o}){const{activeModel:n}=G();o??=n;const{indices:t,setIndex:d,showFilter:a,toggleFilter:i,searchAll:l,toggleSearchAll:p}=L(),f=!!indexedDB,[u,g]=B(""),r=R(u,500),[s,v]=B(A),b=K(t),m=q(b);C(()=>v(A),[a,t]),C(()=>{g(""),l&&p()},[t]);const c=t.join();return e(x,{className:"AddWeapon",sx:h.root,children:[e(x,{sx:h.top,children:[e(V,{sx:h.title,children:"Add Weapon"}),e($,{options:I,selectedIndices:t,setIndex:d}),e(x,{sx:h.searchFilter,children:[e(x,{sx:h.search,children:[f&&e(P,{type:"text",value:"All",checked:l,onClick:p}),e(T,{query:u,onChange:g},c),m&&!l&&e(J,{onClick:i,size:"large",children:e(E,{})})]}),!l&&a&&m&&e(H,{config:m,onChange:v},c)]})]}),e(Y,{sx:h.content,children:e(oe,{target:o,searchQuery:r,filter:s,content:b,searchAll:l})})]})}export{be as default};
