import{o as n,a as f,h as v,p as h}from"./9121d302-jsxRuntime.module.js";import{L as W,W as T,u as E,S as O}from"./a9dc416e-lists.js";import{S as y}from"./cef298b2-Stretcher.js";import{a as H,b as V,T as F}from"./d712cfd6-TabBar.js";import{B as g}from"./7e61fe05-Button.js";/* empty css               */import{h as R,M as z}from"./6a23e72f-ModelIcon.js";import{G as q,u as p}from"./2f5c5a37-Gallery.js";import{s as _,g as Q}from"./e0a4883b-aniFunction.js";import{a as m,f as j}from"./850748e7-index.js";import{S as B}from"./0d1abf2a-Selector.js";import{a as K}from"./f60cacb5-index.js";import{b as Y}from"./a4be5a26-getPersonalAni.js";import{u as X}from"./70e251a7-useKey.js";import{U as J,f as Z}from"./7c69f7fd-file2dataURL.js";import{u as ee}from"./6c499396-useToggleState.js";import{C as ne}from"./d2d312c8-Check.js";import{c as U}from"./5c67166c-createSvgIcon.js";import{l as te,v as ae}from"./8524ed34-viewer.js";import{B as M}from"./272a55ce-Box.js";import{a as oe,b as ie}from"./7b2118ae-DialogTitle.js";import"./7b270a3e-Close.js";import"./8f91ce53-ButtonBase.js";import"./eaf06fd2-Popover.js";import"./aceff306-index.js";import"./042e6b4d-_commonjsHelpers.js";import"./4e8de4b5-compat.module.js";import"./6fa25dee-immer.esm.js";import"./45408441-preload-helper.js";import"./d65f183e-GlowToggle.js";import"./1c81631e-three.js";import"./e27bbfcf-CopyShader.js";import"./91ac8981-ShaderPass.js";import"./b87293a3-Pass.js";const ce=e=>e&&new Promise(t=>{new te().load(e,t)}),se=U(n("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),le=U(n("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit"),re=U(n("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");function ue({icon:e="",subIcon:t="",title:i,subtitle:c="",onClick:a,...o}){const s=e&&n("div",{className:"IconButton-icons",children:[n("img",{className:"IconButton-mainIcon",src:e,alt:i,loading:"lazy"}),t&&n("img",{className:"IconButton-subIcon",src:t,alt:t,loading:"lazy"})]}),u=n("div",{className:"IconButton-description",children:[c&&n("h5",{className:"IconButton-subtitle",children:c}),n("h3",{className:"IconButton-title",children:i})]});return n(g,{variant:"outlined",className:"IconButton",onClick:a,startIcon:s,...o,children:u})}function I({icon:e,user:t,name:i,fullName:c=i,subtitle:a="",code:o,onClick:s}){const u=R(t)?`img/icon/${t}.png`:"",l=e?`img/aniIcon/${e}.png`:u;return n(ue,{icon:l,subIcon:e&&u,title:i,subtitle:a,onClick:s,"data-code":o,"data-name":c})}function de({icon:e,user:t,code:i,fullName:c,onClick:a}){return n(I,{icon:e,user:t,name:c,code:i,onClick:a})}function me({query:e,onSelect:t}){const[i,c]=f([]),[a,o]=f(!0);return v(()=>{o(!0),setTimeout(async()=>{const s=await _(e);c(s),o(!1)})},[e]),n("div",{className:"AniSearchResult",children:[n(y,{}),a?n(W,{}):n(q,{list:i,component:de,onClick:t})]})}const pe=[{label:"Home Screen",name:"home"},{label:"In Quest",name:"quest"},{label:"Weapon Specific",name:"weapon"},{label:"Generic Skills",name:"genericSkill"},{label:"Unique Skills",name:"uniqueSkill"},{label:"Unique Combo",name:"uniqueCombo"},{label:"Unique Force Strike",name:"uniqueFS"},{label:"Unique Victory",name:"uniqueVictory"},{label:"Other Unique",name:"uniqueOther"},{label:"Misc",name:"misc"}];function L({tabs:e,value:t,onChange:i}){return n(V,{variant:"scrollable",orientation:"vertical",className:"VerticalTabs",value:t,onChange:(a,o)=>i(o),children:e.map(({label:a,name:o})=>n(H,{label:a??o,value:o},o))})}const he={minHeight:"3rem"};function k({name:e,code:t,onClick:i,fullName:c,...a}){return n(g,{className:"AniSelect-Btn",variant:"contained","data-code":t,"data-name":c??e,onClick:i,sx:he,...a,children:e})}const ge=["Male","Female"];function Ae({value:e,onClick:t}){return n(B,{type:"text",options:ge,value:e,onClick:t})}function fe({onSelect:e}){const{gender:t,setGender:i}=m(a=>a.advAni.home),c=p(a=>a["ani-home"]);return n("div",{className:"HomeAni",children:[n("h3",{className:"HomeAni-groupTitle",children:"Common Animation"}),n("div",{className:"AniSelect-simpleBtns",children:c.common.map(({name:a,code:o})=>n(k,{name:a,code:o,onClick:e,className:"AniSelect-Btn"},a))}),n("hr",{}),n("div",{className:"HomeAni-groupTitle",children:[n("h3",{children:"Gender Specific"}),n(Ae,{value:t,onClick:i})]}),n("div",{className:"AniSelect-simpleBtns",children:c[t].map(({name:a,code:o})=>n(k,{name:a,code:o,fullName:`${t} ${a}`,onClick:e,className:"AniSelect-Btn"},a))})]})}function A({list:e,onClick:t}){return n(q,{list:e,component:k,onClick:t})}function ve({onSelect:e}){const t=p(i=>i["ani-quest"]);return n(A,{list:t,onClick:e})}const $=["Long","Close","Rapid"],Se=$.map(e=>`img/appIcon/gun_${e}.png`);function ye({value:e,onClick:t}){return n(B,{type:"icon",options:$,icons:Se,labels:$,value:e,onClick:t})}const Ce=T.map(e=>`img/appIcon/weapon_${e}.png`);function C({value:e,onClick:t}){return n(B,{type:"icon",options:T,icons:Ce,value:e,onClick:t})}const be={Long:"Long Range",Close:"Close Range",Rapid:"Rapid Fire"};function Ne({onSelect:e}){const{type:t,setType:i,gunMode:c,setGunMode:a}=m(r=>r.advAni.weapon),o=p(r=>r["ani-weapon"]),s=p(r=>r["ani-gun"]),u=o[t].map(r=>({...r,fullName:`${t} ${r.name}`})),l=s[c].map(r=>({...r,fullName:`${be[c]} Manacaster ${r.name}`}));return n("div",{className:"WeaponAni",children:[n(C,{value:t,onClick:i}),n(A,{list:u,onClick:e}),t==="Manacaster"&&n(h,{children:[n(ye,{value:c,onClick:a}),n(A,{list:l,onClick:e})]})]})}function ke({onSelect:e}){const{type:t,setType:i}=m(o=>o.advAni.genericSkill),a=p(o=>o["ani-genericSkill"])[t].map(o=>({...o,fullName:`${t} ${o.name}`}));return n("div",{className:"GenericSkills",children:[n(C,{value:t,onClick:i}),n(A,{list:a,onClick:e})]})}function G({list:e,onClick:t}){return n(q,{list:e,component:I,onClick:t})}const $e=e=>({...e,fullName:`${e.name} Victory`}),qe=e=>({...e,fullName:`${e.name} ${e.subtitle||""} Combo`}),Be=e=>({...e,fullName:`${e.name} ${e.subtitle||""} Force Strike`}),Ue=e=>({...e,fullName:e.subtitle?`${e.subtitle} ${e.name}`:e.name}),xe={uniqueCombo:qe,uniqueFS:Be,uniqueVictory:$e,uniqueSkill:Ue};function S({name:e,onSelect:t}){var r;const i=`ani-${e}`,c=p(d=>d[i])??{},{setGroupWeaponType:a}=m(d=>d.advAni.groupByWeapon),o=d=>a(e,d),s=m(d=>d.advAni.groupByWeapon[e]);s??o(Object.keys(c)[0]);const u=xe[e],l=u?(r=c[s])==null?void 0:r.map(u):c[s];return n("div",{className:"AniGroup",children:[n(C,{value:s,onClick:o}),n(G,{list:l,onClick:t},s)]})}function Me({onSelect:e}){const t=p(i=>i["ani-misc"]);return n(A,{list:t,onClick:e})}function Te({expanded:e,user:t,name:i,animations:c,onClick:a,onSelect:o}){return n(h,{children:[n("div",{className:`UniqueAniGroup ${e?"selected":""}`,"data-user":t,onClick:a,children:[n(z,{modelId:t,alt:i}),n("h3",{children:i})]}),e&&n("div",{className:"UniqueAniGroup-details",children:n(A,{list:c,onClick:o})})]})}function Ie({onSelect:e}){const t=p(l=>l["ani-uniqueOther"]),{type:i,setType:c,selected:a,setSelected:o}=m(l=>l.advAni.uniqueOther),s=t[i],u=l=>{const{user:r}=l.currentTarget.dataset;o(r===a?"":r)};return n(h,{children:n("div",{className:"OtherUniqueAni",children:[n(C,{value:i,onClick:c}),n("hr",{}),n("div",{className:"OtherUniqueAni-groups",children:s.map(l=>n(Te,{expanded:a===l.user,...l,onClick:u,onSelect:e}))})]})})}const Le={home:fe,quest:ve,weapon:Ne,genericSkill:ke,uniqueSkill:e=>n(S,{...e,name:"uniqueSkill"}),uniqueVictory:e=>n(S,{...e,name:"uniqueVictory"}),uniqueFS:e=>n(S,{...e,name:"uniqueFS"}),uniqueCombo:e=>n(S,{...e,name:"uniqueCombo"}),uniqueOther:Ie,misc:Me};function Ge({onSelect:e}){const{category:t,setCategory:i}=m(a=>a.advAni),c=Le[t]??y;return n("div",{className:"AniSelect-categories",children:[n(L,{tabs:pe,value:t,onChange:i}),n("div",{className:"AniSelect-subCategory",children:n(c,{onSelect:e})})]})}function we(){const{source:e,setSource:t,sourceName:i,setSourceName:c}=m(l=>l.personalAni),{inputModel:a}=j(),o=(l,r)=>{c(r),t(l)},s=async()=>{const l=await a();l&&o(...l)};v(()=>{i||setTimeout(async()=>{const l=await K(e);l!=null&&l.id&&c(l.name)})},[e]);const u=["b","w","e"].includes(e==null?void 0:e[0])?`img/icon/${e}.png`:`img/portrait/${e}.png`;return n("div",{className:"PersonalAni-source",children:[e&&n("img",{src:u,alt:e},e),n("div",{children:[n("h3",{children:i}),n(g,{variant:"outlined",onClick:s,children:"Change Source"})]})]})}function Pe({onSelect:e}){const t=!!indexedDB,{source:i}=m(o=>o.personalAni),[c,a]=f([]);return v(()=>{a([]),setTimeout(async()=>{if(!i)return;const s=(Y(i)??(t?await Q(i):[])).map(u=>({...u,user:void 0}));a(s)})},[i]),n(G,{list:c,onClick:e})}function De({onSelect:e}){return n("div",{className:"PersonalAnimation",children:[n(we,{}),n(Pe,{onSelect:e})]})}function We({onSelect:e}){const{category:t,setCategory:i}=m(o=>o.extraAni),c=p(o=>o["ani-extra"]),a=Object.keys(c).map(o=>({name:o}));return n("div",{className:"AniSelect-categories",children:[n(L,{tabs:a,value:t,onChange:i}),n("div",{className:"AniSelect-subCategory",children:n(A,{list:c[t],onClick:e})})]})}function Ee({initText:e,onChange:t=c=>{},...i}){const[c,a]=f(e),[o,s]=ee(),u=r=>{const{value:d}=r.target;a(d),t(r)},l=r=>{r.keyCode===13&&s()};return v(()=>{a(e)},[e]),o?n(h,{children:[n(g,{title:"Save",onClick:s,children:n(ne,{})}),n("input",{value:c,onChange:u,onKeyUp:l,...i})]}):n(h,{children:[n(g,{title:"Edit",onClick:s,children:n(le,{})}),n("div",{...i,children:c})]})}function Oe({list:e,onSelect:t}){const i=a=>{const{value:o}=a.target,{uuid:s}=a.target.dataset,u=e.find(l=>l.uuid===s);u.name=o},c=a=>{const{uuid:o}=a.target.dataset,s=e.findIndex(u=>u.uuid===o);s!==-1&&e.splice(s,1)};return n("div",{className:"AnimationList",children:e==null?void 0:e.map(a=>n(h,{children:[n(Ee,{initText:a.name,onChange:i,className:"AnimationList-aniName","data-uuid":a.uuid}),n(g,{"data-code":`ex:${a.uuid}`,"data-name":a.name,onClick:t,variant:"contained",title:"Select this animation",children:"Select"}),n(g,{"data-uuid":a.uuid,onClick:c,variant:"contained",title:"Delete this animation",children:n(se,{})})]}))})}function He({onSelect:e}){const{userData:t}=ae,[i,c]=X();return v(()=>{const o=t.ani.addEventListener("change",c);return()=>t.ani.removeEventListener("change",o)}),n("div",{className:"UploadedAni",children:[n(J,{title:"Upload fbx files containing animations applied on DL models",label:"Upload Animations",multiple:!0,mimeType:".fbx",onChange:async o=>{const s=Array.from(o),u=await Promise.all(s.map(Z)),r=(await Promise.all(u.map(ce))).flatMap(d=>d.animations);t.ani.push(...r)}}),n(Oe,{list:t.ani,onSelect:e},i)]})}const N={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh",minWidth:"20rem","& svg":{color:"rgba(16, 16, 16, 0.8)"}},title:{textAlign:"center",padding:"0.5rem 2rem",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)","& h2":{padding:"0.2rem 1rem"},"& Searchbox":{minWidth:"15rem"}},content:{padding:"0.5rem 1rem",overflowX:"hidden"}};const Ve=[{name:"Adv"},{name:"Personal"},{name:"Extra"},{name:"Upload",icon:n(re,{}),label:""}],Fe={Adv:Ge,Personal:De,Extra:We,Upload:He};function $n({onSelect:e=()=>{},onAfterSelect:t}){const{category:i,setCategory:c,getCurrentState:a}=m(),o=!!indexedDB,[s,u]=f(""),l=E(s,500),r=(x,b)=>c(b),d=x=>{const{code:b,name:P}=x.currentTarget.dataset,D=a();e(b,P,D),t==null||t()},w=Fe[i]??y;return n(M,{className:"AniSelect",sx:N.root,children:[n(M,{sx:N.title,children:[n(oe,{children:"Select an Animation"}),o&&n(O,{placeholder:"Search",query:s,onChange:u})]}),s?n(me,{query:l,onSelect:d}):n(h,{children:[n(F,{value:i,onChange:r,tabs:Ve}),n(ie,{sx:N.content,children:[n(y,{}),n(w,{onSelect:d})]})]})]})}export{$n as default};
