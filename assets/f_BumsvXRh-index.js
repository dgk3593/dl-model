import{u as e,c as S,h as C,y as B,s as D,d as F,v as N,X as G,a as L,al as R}from"./index-B1_375I8.js";import{L as M,u as T,S as j}from"./f_dAFfZaDR-lists.js";import{f as $,B as E,F as H,a as P}from"./f_Dp_0GJvD-filterConfig.js";import{G as q}from"./f_BnD8-rT--GlowToggle.js";import{g as z}from"./f_BLhZ3tHy-index.js";import{u as O,G as Q}from"./f_BTzsoMPV-Gallery.js";import{u as w}from"./f_Cz4u4kHM-useToggleState.js";/* empty css                 */import{M as V}from"./f_B9QQqUZk-ModelIcon.js";import{B as x}from"./f_9AE5vgq--Box.js";import{D as X,a as Y}from"./f_NrhKWLBA-DialogTitle.js";import{I as J}from"./f_CRmZCB2R-Close.js";import"./f_PXJ5rxtd-three.js";import"./f_CFHP4PPT-createSvgIcon.js";import"./f_B5jccbM--createSimplePaletteValueFilter.js";import"./f_RG7eh_bw-Popover.js";const h={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh","& svg":{color:"rgba(16, 16, 16, 0.8)"}},top:{display:"flex",flexWrap:"wrap",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)"},searchFilter:{marginTop:"0.2rem",display:"flex",flexDirection:"column",width:"100%",minWidth:"20rem",alignItems:"center",justifyContent:"center","& .MuiTextField-root":{justifyContent:"center"}},search:{display:"flex",width:"100%",justifyContent:"center"},title:{padding:"0.5rem 1rem",textAlign:"center",flexGrow:.1,margin:"auto"},content:{padding:"0.3rem",textAlign:"center",minHeight:"60vh"}},W=[{value:"weapon",label:"Weapon",icon:"img/appIcon/weapon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"},{value:"extra",label:"Extra"}]},{value:"chara",label:"Adventurer",icon:"img/appIcon/chara.png",options:[{value:"regular",label:"Regular"},{value:"allies",label:"Allies"},{value:"enemies",label:"Enemies"}]},{value:"dragon",label:"Dragon",icon:"img/appIcon/dragon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"}]},{value:"boss",label:"Boss",icon:"img/appIcon/boss.png",options:[{value:"archdemon",label:"Archdemon",icon:"img/appIcon/archdemon.png"},{value:"agito",label:"Agito",icon:"img/appIcon/agito.png"},{value:"raid",label:"Raid",icon:"img/appIcon/raid.png"},{value:"void",label:"Void",icon:"img/appIcon/void.png"},{value:"others",label:"Others"}]}],K=o=>{let t=W;const n=[];return o.forEach(d=>{const a=t[d],i=a==null?void 0:a.value;i!==void 0&&(n.push(i),t=a.options)}),n.join("-")},U={Left:"⇐",Right:"⇒"},A=({side:o,onClick:t})=>e("div",{className:"WeaponButton-addBtn","data-side":o,onClick:t,children:U[o]}),Z=o=>o.stopPropagation();function _({id:o,name:t,noIcon:n,onClick:d}){const[a,i]=w(!1),[l,p]=w(!1),f=!n&&e(V,{modelId:o,className:"WeaponButton-icon"}),u=a&&e("div",{className:"WeaponButton-grip",onClick:Z,children:[e("input",{type:"checkbox",id:`grip-${o}`,checked:l,onChange:p}),e("label",{htmlFor:`grip-${o}`,children:"Reverse Grip"})]}),g=s=>{s.stopPropagation();const{side:r}=s.currentTarget.dataset;d({side:r,id:o,name:t,reverse:l})};return e("div",{className:"WeaponButton",children:[f,a?e("div",{className:"WeaponButton-add",onClick:i,children:[u,e("div",{className:"WeaponButton-addBtnGroup",children:[e(A,{side:"Left",onClick:g}),e("div",{children:"ADD"}),e(A,{side:"Right",onClick:g})]})]}):e("div",{className:"WeaponButton-name",onClick:i,children:t})]})}const ee=[];function oe({target:o,content:t,searchQuery:n,searchAll:d,filter:a=ee}){const i=O(s=>s[t])??[],[l,p]=C([]),[f,u]=C(!1);return B(()=>p(i),[t]),B(()=>{u(!0);async function s(){if(d)return n?await D(n):i;const r=await F(i,n);return await $(r,a)}setTimeout(async()=>{const r=await s();p(r),u(!1)})},[n,a,d]),f?e(M,{}):e(Q,{list:l,component:_,onClick:async({side:s,id:r,name:v,reverse:b})=>{var y;const m=`jWeapon${s[0]}`;if(!(o!=null&&o.bones.list.includes(m)))return;const c=await N.loadDLModel(r);c.userData.name=v,b&&(c.rotation.y=Math.PI),(y=o.attachment[m])==null||y.forEach(k=>k.dispose()),o.attach(c,m),c.outline.code=o.outline.code,c.material.code=o.material.code,G(c)}})}const ne=S(oe),I=[];function xe({target:o}){const{activeModel:t}=L();o??(o=t);const{indices:n,setIndex:d,showFilter:a,toggleFilter:i,searchAll:l,toggleSearchAll:p}=R(),f=!!indexedDB,[u,g]=C(""),s=T(u,500),[r,v]=C(I),b=K(n),m=z(b);B(()=>v(I),[a,n]),B(()=>{g(""),l&&p()},[n]);const c=n.join();return e(x,{className:"AddWeapon",sx:h.root,children:[e(x,{sx:h.top,children:[e(X,{sx:h.title,children:"Add Weapon"}),e(E,{options:W,selectedIndices:n,setIndex:d}),e(x,{sx:h.searchFilter,children:[e(x,{sx:h.search,children:[f&&e(q,{type:"text",value:"All",checked:l,onClick:p}),e(j,{query:u,onChange:g},c),m&&!l&&e(J,{onClick:i,size:"large",children:e(H,{})})]}),!l&&a&&m&&e(P,{config:m,onChange:v},c)]})]}),e(Y,{sx:h.content,children:e(ne,{target:o,searchQuery:s,filter:r,content:b,searchAll:l})})]})}export{xe as default};
